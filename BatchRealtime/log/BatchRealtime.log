[INFO ] 08:47:52 [com.work.main.BatchRealtime] - --[[ ]]]--
[INFO ] 08:47:52 [com.work.main.BatchRealtime] - 201612190000
[ERROR] 08:47:52 [com.kreon.stats.ccu.GatherCCU] - [EXCEPTION]
java.lang.NullPointerException
	at com.kreon.stats.util.PropertiesUtil.getPorpertyValue(PropertiesUtil.java:28)
	at com.kreon.stats.util.DBUtil.<clinit>(DBUtil.java:18)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:59)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[ERROR] 08:47:52 [com.kreon.stats.ccu.GatherCCU] - [EXCEPTION]
java.lang.NullPointerException
	at com.kreon.stats.util.PropertiesUtil.getPorpertyValue(PropertiesUtil.java:28)
	at com.kreon.stats.util.DBUtil.<clinit>(DBUtil.java:19)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:59)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[ERROR] 08:47:52 [com.kreon.stats.ccu.GatherCCU] - [EXCEPTION]
java.lang.NullPointerException
	at com.kreon.stats.util.PropertiesUtil.getPorpertyValue(PropertiesUtil.java:28)
	at com.kreon.stats.util.DBUtil.<clinit>(DBUtil.java:20)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:59)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[ERROR] 08:47:52 [com.kreon.stats.ccu.GatherCCU] - [EXCEPTION]
java.lang.NullPointerException
	at com.kreon.stats.util.PropertiesUtil.getPorpertyValue(PropertiesUtil.java:28)
	at com.kreon.stats.util.DBUtil.<clinit>(DBUtil.java:21)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:59)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[ERROR] 08:47:52 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:47:52 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:47:57 [com.work.main.BatchRealtime] - 201612190005
[ERROR] 08:47:57 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:47:57 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:48:02 [com.work.main.BatchRealtime] - 201612190010
[ERROR] 08:48:02 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:48:02 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:48:07 [com.work.main.BatchRealtime] - 201612190015
[ERROR] 08:48:07 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:48:07 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:48:12 [com.work.main.BatchRealtime] - 201612190020
[ERROR] 08:48:12 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:48:12 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:48:17 [com.work.main.BatchRealtime] - 201612190025
[ERROR] 08:48:17 [com.kreon.stats.util.DBUtil] - openDB FAILED...org.postgresql.Driver
[ERROR] 08:48:17 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:59:08 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 08:59:08 [com.work.main.BatchRealtime] - 201612190000
[ERROR] 08:59:09 [com.work.util.DBUtil] - openDB FAILED...FATAL: password authentication failed for user "grape"
[ERROR] 08:59:09 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:59:14 [com.work.main.BatchRealtime] - 201612190005
[ERROR] 08:59:14 [com.work.util.DBUtil] - openDB FAILED...FATAL: password authentication failed for user "grape"
[ERROR] 08:59:14 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 08:59:19 [com.work.main.BatchRealtime] - 201612190010
[ERROR] 08:59:19 [com.work.util.DBUtil] - openDB FAILED...FATAL: password authentication failed for user "grape"
[ERROR] 08:59:19 [com.work.main.BatchRealtime] - connection failed...
[INFO ] 09:00:37 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 09:00:37 [com.work.main.BatchRealtime] - 201612190000
[INFO ] 09:00:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:00:38 [com.work.main.BatchRealtime] - --[[select now();]]--
[ERROR] 09:00:38 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: Bad value for type int : 2016-12-20 09:00:45.248097+07
	at org.postgresql.jdbc2.AbstractJdbc2ResultSet.toInt(AbstractJdbc2ResultSet.java:2759)
	at org.postgresql.jdbc2.AbstractJdbc2ResultSet.getInt(AbstractJdbc2ResultSet.java:2003)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:79)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:01:10 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 09:01:10 [com.work.main.BatchRealtime] - 201612190000
[INFO ] 09:01:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:01:10 [com.work.main.BatchRealtime] - --[[select 1;]]--
[INFO ] 09:01:15 [com.work.main.BatchRealtime] - 201612190005
[INFO ] 09:01:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:01:15 [com.work.main.BatchRealtime] - --[[select 1;]]--
[INFO ] 09:01:20 [com.work.main.BatchRealtime] - 201612190010
[INFO ] 09:01:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:01:20 [com.work.main.BatchRealtime] - --[[select 1;]]--
[INFO ] 09:01:52 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 09:01:52 [com.work.main.BatchRealtime] - 201612190000
[INFO ] 09:01:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:01:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190000',true)]]--
[ERROR] 09:02:06 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:02:07 [com.work.main.BatchRealtime] - 201612190005
[INFO ] 09:02:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:02:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190005',true)]]--
[ERROR] 09:02:18 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:02:19 [com.work.main.BatchRealtime] - 201612190010
[INFO ] 09:02:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:02:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190010',true)]]--
[ERROR] 09:02:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:02:31 [com.work.main.BatchRealtime] - 201612190015
[INFO ] 09:02:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:02:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190015',true)]]--
[INFO ] 09:02:46 [com.work.main.BatchRealtime] - 201612190020
[INFO ] 09:02:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:02:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190020',true)]]--
[INFO ] 09:03:00 [com.work.main.BatchRealtime] - 201612190025
[INFO ] 09:03:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:03:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190025',true)]]--
[INFO ] 09:03:15 [com.work.main.BatchRealtime] - 201612190030
[INFO ] 09:03:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:03:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190030',true)]]--
[INFO ] 09:03:29 [com.work.main.BatchRealtime] - 201612190035
[INFO ] 09:03:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:03:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190035',true)]]--
[INFO ] 09:03:43 [com.work.main.BatchRealtime] - 201612190040
[INFO ] 09:03:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:03:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190040',true)]]--
[INFO ] 09:03:57 [com.work.main.BatchRealtime] - 201612190045
[INFO ] 09:03:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:03:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190045',true)]]--
[INFO ] 09:04:11 [com.work.main.BatchRealtime] - 201612190050
[INFO ] 09:04:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:04:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190050',true)]]--
[INFO ] 09:04:26 [com.work.main.BatchRealtime] - 201612190055
[INFO ] 09:04:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:04:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190055',true)]]--
[INFO ] 09:04:40 [com.work.main.BatchRealtime] - 201612190100
[INFO ] 09:04:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:04:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190100',true)]]--
[INFO ] 09:04:54 [com.work.main.BatchRealtime] - 201612190105
[INFO ] 09:04:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:04:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190105',true)]]--
[INFO ] 09:05:09 [com.work.main.BatchRealtime] - 201612190110
[INFO ] 09:05:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:05:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190110',true)]]--
[ERROR] 09:05:19 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:05:20 [com.work.main.BatchRealtime] - 201612190115
[INFO ] 09:05:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:05:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190115',true)]]--
[INFO ] 09:05:35 [com.work.main.BatchRealtime] - 201612190120
[INFO ] 09:05:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:05:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190120',true)]]--
[INFO ] 09:05:49 [com.work.main.BatchRealtime] - 201612190125
[INFO ] 09:05:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:05:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190125',true)]]--
[INFO ] 09:06:03 [com.work.main.BatchRealtime] - 201612190130
[INFO ] 09:06:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:06:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190130',true)]]--
[INFO ] 09:06:17 [com.work.main.BatchRealtime] - 201612190135
[INFO ] 09:06:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:06:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190135',true)]]--
[INFO ] 09:06:32 [com.work.main.BatchRealtime] - 201612190140
[INFO ] 09:06:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:06:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190140',true)]]--
[INFO ] 09:06:46 [com.work.main.BatchRealtime] - 201612190145
[INFO ] 09:06:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:06:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190145',true)]]--
[INFO ] 09:07:00 [com.work.main.BatchRealtime] - 201612190150
[INFO ] 09:07:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:07:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190150',true)]]--
[INFO ] 09:07:14 [com.work.main.BatchRealtime] - 201612190155
[INFO ] 09:07:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:07:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190155',true)]]--
[INFO ] 09:17:21 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 09:17:21 [com.work.main.BatchRealtime] - 201612190000
[INFO ] 09:17:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:17:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190000',true)]]--
[ERROR] 09:17:32 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:17:33 [com.work.main.BatchRealtime] - 201612190005
[INFO ] 09:17:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:17:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190005',true)]]--
[ERROR] 09:17:44 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:17:45 [com.work.main.BatchRealtime] - 201612190010
[INFO ] 09:17:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:17:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190010',true)]]--
[ERROR] 09:17:56 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:17:57 [com.work.main.BatchRealtime] - 201612190015
[INFO ] 09:17:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:17:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190015',true)]]--
[ERROR] 09:18:08 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 00:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:18:09 [com.work.main.BatchRealtime] - 201612190020
[INFO ] 09:18:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:18:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190020',true)]]--
[ERROR] 09:18:20 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:18:21 [com.work.main.BatchRealtime] - 201612190025
[INFO ] 09:18:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:18:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190025',true)]]--
[ERROR] 09:18:31 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 00:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:18:32 [com.work.main.BatchRealtime] - 201612190030
[INFO ] 09:18:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:18:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190030',true)]]--
[ERROR] 09:18:43 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 00:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:18:44 [com.work.main.BatchRealtime] - 201612190035
[INFO ] 09:18:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:18:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190035',true)]]--
[ERROR] 09:18:55 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:18:56 [com.work.main.BatchRealtime] - 201612190040
[INFO ] 09:18:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:18:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190040',true)]]--
[ERROR] 09:19:07 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:19:08 [com.work.main.BatchRealtime] - 201612190045
[INFO ] 09:19:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:19:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190045',true)]]--
[ERROR] 09:19:19 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:19:20 [com.work.main.BatchRealtime] - 201612190050
[INFO ] 09:19:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:19:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190050',true)]]--
[ERROR] 09:19:31 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 00:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:19:32 [com.work.main.BatchRealtime] - 201612190055
[INFO ] 09:19:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:19:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190055',true)]]--
[ERROR] 09:19:43 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:19:44 [com.work.main.BatchRealtime] - 201612190100
[INFO ] 09:19:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:19:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190100',true)]]--
[ERROR] 09:19:55 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:19:56 [com.work.main.BatchRealtime] - 201612190105
[INFO ] 09:19:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:19:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190105',true)]]--
[ERROR] 09:20:06 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 01:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:20:07 [com.work.main.BatchRealtime] - 201612190110
[INFO ] 09:20:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:20:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190110',true)]]--
[ERROR] 09:20:18 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:20:19 [com.work.main.BatchRealtime] - 201612190115
[INFO ] 09:20:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:20:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190115',true)]]--
[ERROR] 09:20:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:20:31 [com.work.main.BatchRealtime] - 201612190120
[INFO ] 09:20:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:20:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190120',true)]]--
[ERROR] 09:20:42 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:20:43 [com.work.main.BatchRealtime] - 201612190125
[INFO ] 09:20:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:20:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190125',true)]]--
[ERROR] 09:20:54 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 01:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:20:55 [com.work.main.BatchRealtime] - 201612190130
[INFO ] 09:20:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:20:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190130',true)]]--
[ERROR] 09:21:06 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:21:07 [com.work.main.BatchRealtime] - 201612190135
[INFO ] 09:21:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:21:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190135',true)]]--
[ERROR] 09:21:17 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:21:18 [com.work.main.BatchRealtime] - 201612190140
[INFO ] 09:21:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:21:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190140',true)]]--
[ERROR] 09:21:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:21:30 [com.work.main.BatchRealtime] - 201612190145
[INFO ] 09:21:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:21:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190145',true)]]--
[ERROR] 09:21:41 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:21:42 [com.work.main.BatchRealtime] - 201612190150
[INFO ] 09:21:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:21:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190150',true)]]--
[ERROR] 09:21:53 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 01:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:21:54 [com.work.main.BatchRealtime] - 201612190155
[INFO ] 09:21:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:21:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190155',true)]]--
[ERROR] 09:22:05 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 02:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:22:06 [com.work.main.BatchRealtime] - 201612190200
[INFO ] 09:22:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:22:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190200',true)]]--
[INFO ] 09:22:20 [com.work.main.BatchRealtime] - 201612190205
[INFO ] 09:22:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:22:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190205',true)]]--
[INFO ] 09:22:35 [com.work.main.BatchRealtime] - 201612190210
[INFO ] 09:22:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:22:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190210',true)]]--
[INFO ] 09:22:49 [com.work.main.BatchRealtime] - 201612190215
[INFO ] 09:22:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:22:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190215',true)]]--
[INFO ] 09:23:03 [com.work.main.BatchRealtime] - 201612190220
[INFO ] 09:23:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:23:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190220',true)]]--
[INFO ] 09:23:17 [com.work.main.BatchRealtime] - 201612190225
[INFO ] 09:23:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:23:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190225',true)]]--
[INFO ] 09:23:32 [com.work.main.BatchRealtime] - 201612190230
[INFO ] 09:23:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:23:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190230',true)]]--
[INFO ] 09:23:46 [com.work.main.BatchRealtime] - 201612190235
[INFO ] 09:23:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:23:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190235',true)]]--
[INFO ] 09:24:00 [com.work.main.BatchRealtime] - 201612190240
[INFO ] 09:24:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:24:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190240',true)]]--
[INFO ] 09:24:14 [com.work.main.BatchRealtime] - 201612190245
[INFO ] 09:24:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:24:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190245',true)]]--
[INFO ] 09:24:28 [com.work.main.BatchRealtime] - 201612190250
[INFO ] 09:24:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:24:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190250',true)]]--
[INFO ] 09:24:43 [com.work.main.BatchRealtime] - 201612190255
[INFO ] 09:24:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:24:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190255',true)]]--
[INFO ] 09:24:57 [com.work.main.BatchRealtime] - 201612190300
[INFO ] 09:24:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:24:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190300',true)]]--
[INFO ] 09:25:11 [com.work.main.BatchRealtime] - 201612190305
[INFO ] 09:25:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:25:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190305',true)]]--
[INFO ] 09:25:25 [com.work.main.BatchRealtime] - 201612190310
[INFO ] 09:25:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:25:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190310',true)]]--
[INFO ] 09:25:39 [com.work.main.BatchRealtime] - 201612190315
[INFO ] 09:25:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:25:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190315',true)]]--
[INFO ] 09:25:54 [com.work.main.BatchRealtime] - 201612190320
[INFO ] 09:25:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:25:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190320',true)]]--
[INFO ] 09:26:08 [com.work.main.BatchRealtime] - 201612190325
[INFO ] 09:26:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:26:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190325',true)]]--
[INFO ] 09:26:22 [com.work.main.BatchRealtime] - 201612190330
[INFO ] 09:26:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:26:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190330',true)]]--
[INFO ] 09:26:36 [com.work.main.BatchRealtime] - 201612190335
[INFO ] 09:26:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:26:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190335',true)]]--
[INFO ] 09:26:50 [com.work.main.BatchRealtime] - 201612190340
[INFO ] 09:26:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:26:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190340',true)]]--
[INFO ] 09:27:04 [com.work.main.BatchRealtime] - 201612190345
[INFO ] 09:27:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:27:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190345',true)]]--
[INFO ] 09:27:18 [com.work.main.BatchRealtime] - 201612190350
[INFO ] 09:27:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:27:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190350',true)]]--
[INFO ] 09:27:32 [com.work.main.BatchRealtime] - 201612190355
[INFO ] 09:27:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:27:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190355',true)]]--
[INFO ] 09:27:46 [com.work.main.BatchRealtime] - 201612190400
[INFO ] 09:27:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:27:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190400',true)]]--
[ERROR] 09:27:57 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 04:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:27:58 [com.work.main.BatchRealtime] - 201612190405
[INFO ] 09:27:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:27:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190405',true)]]--
[INFO ] 09:28:12 [com.work.main.BatchRealtime] - 201612190410
[INFO ] 09:28:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:28:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190410',true)]]--
[INFO ] 09:28:26 [com.work.main.BatchRealtime] - 201612190415
[INFO ] 09:28:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:28:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190415',true)]]--
[INFO ] 09:28:40 [com.work.main.BatchRealtime] - 201612190420
[INFO ] 09:28:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:28:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190420',true)]]--
[INFO ] 09:28:55 [com.work.main.BatchRealtime] - 201612190425
[INFO ] 09:28:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:28:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190425',true)]]--
[INFO ] 09:29:09 [com.work.main.BatchRealtime] - 201612190430
[INFO ] 09:29:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:29:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190430',true)]]--
[INFO ] 09:29:23 [com.work.main.BatchRealtime] - 201612190435
[INFO ] 09:29:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:29:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190435',true)]]--
[INFO ] 09:29:37 [com.work.main.BatchRealtime] - 201612190440
[INFO ] 09:29:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:29:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190440',true)]]--
[INFO ] 09:29:51 [com.work.main.BatchRealtime] - 201612190445
[INFO ] 09:29:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:29:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190445',true)]]--
[INFO ] 09:30:05 [com.work.main.BatchRealtime] - 201612190450
[INFO ] 09:30:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:30:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190450',true)]]--
[INFO ] 09:30:19 [com.work.main.BatchRealtime] - 201612190455
[INFO ] 09:30:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:30:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190455',true)]]--
[INFO ] 09:30:33 [com.work.main.BatchRealtime] - 201612190500
[INFO ] 09:30:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:30:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190500',true)]]--
[INFO ] 09:30:47 [com.work.main.BatchRealtime] - 201612190505
[INFO ] 09:30:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:30:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190505',true)]]--
[INFO ] 09:31:01 [com.work.main.BatchRealtime] - 201612190510
[INFO ] 09:31:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:31:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190510',true)]]--
[INFO ] 09:31:15 [com.work.main.BatchRealtime] - 201612190515
[INFO ] 09:31:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:31:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190515',true)]]--
[INFO ] 09:31:29 [com.work.main.BatchRealtime] - 201612190520
[INFO ] 09:31:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:31:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190520',true)]]--
[INFO ] 09:31:43 [com.work.main.BatchRealtime] - 201612190525
[INFO ] 09:31:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:31:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190525',true)]]--
[INFO ] 09:31:57 [com.work.main.BatchRealtime] - 201612190530
[INFO ] 09:31:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:31:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190530',true)]]--
[INFO ] 09:32:12 [com.work.main.BatchRealtime] - 201612190535
[INFO ] 09:32:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:32:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190535',true)]]--
[INFO ] 09:32:26 [com.work.main.BatchRealtime] - 201612190540
[INFO ] 09:32:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:32:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190540',true)]]--
[INFO ] 09:32:40 [com.work.main.BatchRealtime] - 201612190545
[INFO ] 09:32:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:32:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190545',true)]]--
[INFO ] 09:32:54 [com.work.main.BatchRealtime] - 201612190550
[INFO ] 09:32:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:32:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190550',true)]]--
[INFO ] 09:33:08 [com.work.main.BatchRealtime] - 201612190555
[INFO ] 09:33:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:33:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190555',true)]]--
[INFO ] 09:33:22 [com.work.main.BatchRealtime] - 201612190600
[INFO ] 09:33:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:33:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190600',true)]]--
[INFO ] 09:33:36 [com.work.main.BatchRealtime] - 201612190605
[INFO ] 09:33:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:33:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190605',true)]]--
[INFO ] 09:33:50 [com.work.main.BatchRealtime] - 201612190610
[INFO ] 09:33:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:33:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190610',true)]]--
[INFO ] 09:34:04 [com.work.main.BatchRealtime] - 201612190615
[INFO ] 09:34:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:34:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190615',true)]]--
[INFO ] 09:34:18 [com.work.main.BatchRealtime] - 201612190620
[INFO ] 09:34:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:34:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190620',true)]]--
[INFO ] 09:34:32 [com.work.main.BatchRealtime] - 201612190625
[INFO ] 09:34:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:34:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190625',true)]]--
[INFO ] 09:34:46 [com.work.main.BatchRealtime] - 201612190630
[INFO ] 09:34:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:34:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190630',true)]]--
[INFO ] 09:35:00 [com.work.main.BatchRealtime] - 201612190635
[INFO ] 09:35:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:35:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190635',true)]]--
[INFO ] 09:35:14 [com.work.main.BatchRealtime] - 201612190640
[INFO ] 09:35:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:35:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190640',true)]]--
[INFO ] 09:35:28 [com.work.main.BatchRealtime] - 201612190645
[INFO ] 09:35:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:35:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190645',true)]]--
[INFO ] 09:35:42 [com.work.main.BatchRealtime] - 201612190650
[INFO ] 09:35:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:35:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190650',true)]]--
[INFO ] 09:35:56 [com.work.main.BatchRealtime] - 201612190655
[INFO ] 09:35:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:35:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190655',true)]]--
[INFO ] 09:36:10 [com.work.main.BatchRealtime] - 201612190700
[INFO ] 09:36:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:36:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190700',true)]]--
[ERROR] 09:36:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 07:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:36:22 [com.work.main.BatchRealtime] - 201612190705
[INFO ] 09:36:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:36:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190705',true)]]--
[INFO ] 09:36:36 [com.work.main.BatchRealtime] - 201612190710
[INFO ] 09:36:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:36:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190710',true)]]--
[INFO ] 09:36:50 [com.work.main.BatchRealtime] - 201612190715
[INFO ] 09:36:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:36:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190715',true)]]--
[INFO ] 09:37:04 [com.work.main.BatchRealtime] - 201612190720
[INFO ] 09:37:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:37:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190720',true)]]--
[INFO ] 09:37:18 [com.work.main.BatchRealtime] - 201612190725
[INFO ] 09:37:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:37:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190725',true)]]--
[INFO ] 09:37:32 [com.work.main.BatchRealtime] - 201612190730
[INFO ] 09:37:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:37:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190730',true)]]--
[INFO ] 09:37:45 [com.work.main.BatchRealtime] - 201612190735
[INFO ] 09:37:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:37:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190735',true)]]--
[INFO ] 09:37:59 [com.work.main.BatchRealtime] - 201612190740
[INFO ] 09:37:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:37:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190740',true)]]--
[INFO ] 09:38:13 [com.work.main.BatchRealtime] - 201612190745
[INFO ] 09:38:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:38:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190745',true)]]--
[INFO ] 09:38:27 [com.work.main.BatchRealtime] - 201612190750
[INFO ] 09:38:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:38:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190750',true)]]--
[INFO ] 09:38:41 [com.work.main.BatchRealtime] - 201612190755
[INFO ] 09:38:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:38:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190755',true)]]--
[INFO ] 09:38:55 [com.work.main.BatchRealtime] - 201612190800
[INFO ] 09:38:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:38:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190800',true)]]--
[ERROR] 09:39:06 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 08:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:39:07 [com.work.main.BatchRealtime] - 201612190805
[INFO ] 09:39:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:39:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190805',true)]]--
[INFO ] 09:39:21 [com.work.main.BatchRealtime] - 201612190810
[INFO ] 09:39:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:39:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190810',true)]]--
[INFO ] 09:39:35 [com.work.main.BatchRealtime] - 201612190815
[INFO ] 09:39:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:39:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190815',true)]]--
[INFO ] 09:39:48 [com.work.main.BatchRealtime] - 201612190820
[INFO ] 09:39:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:39:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190820',true)]]--
[ERROR] 09:39:59 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 08:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:40:00 [com.work.main.BatchRealtime] - 201612190825
[INFO ] 09:40:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:40:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190825',true)]]--
[INFO ] 09:40:13 [com.work.main.BatchRealtime] - 201612190830
[INFO ] 09:40:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:40:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190830',true)]]--
[INFO ] 09:40:27 [com.work.main.BatchRealtime] - 201612190835
[INFO ] 09:40:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:40:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190835',true)]]--
[INFO ] 09:40:41 [com.work.main.BatchRealtime] - 201612190840
[INFO ] 09:40:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:40:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190840',true)]]--
[INFO ] 09:40:55 [com.work.main.BatchRealtime] - 201612190845
[INFO ] 09:40:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:40:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190845',true)]]--
[INFO ] 09:41:09 [com.work.main.BatchRealtime] - 201612190850
[INFO ] 09:41:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:41:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190850',true)]]--
[INFO ] 09:41:22 [com.work.main.BatchRealtime] - 201612190855
[INFO ] 09:41:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:41:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190855',true)]]--
[INFO ] 09:41:36 [com.work.main.BatchRealtime] - 201612190900
[INFO ] 09:41:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:41:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190900',true)]]--
[INFO ] 09:41:50 [com.work.main.BatchRealtime] - 201612190905
[INFO ] 09:41:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:41:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190905',true)]]--
[INFO ] 09:42:04 [com.work.main.BatchRealtime] - 201612190910
[INFO ] 09:42:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:42:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190910',true)]]--
[INFO ] 09:42:18 [com.work.main.BatchRealtime] - 201612190915
[INFO ] 09:42:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:42:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190915',true)]]--
[INFO ] 09:42:32 [com.work.main.BatchRealtime] - 201612190920
[INFO ] 09:42:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:42:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190920',true)]]--
[INFO ] 09:42:45 [com.work.main.BatchRealtime] - 201612190925
[INFO ] 09:42:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:42:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190925',true)]]--
[INFO ] 09:42:59 [com.work.main.BatchRealtime] - 201612190930
[INFO ] 09:42:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:42:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190930',true)]]--
[INFO ] 09:43:13 [com.work.main.BatchRealtime] - 201612190935
[INFO ] 09:43:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:43:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190935',true)]]--
[INFO ] 09:43:26 [com.work.main.BatchRealtime] - 201612190940
[INFO ] 09:43:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:43:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190940',true)]]--
[INFO ] 09:43:40 [com.work.main.BatchRealtime] - 201612190945
[INFO ] 09:43:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:43:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190945',true)]]--
[INFO ] 09:43:54 [com.work.main.BatchRealtime] - 201612190950
[INFO ] 09:43:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:43:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190950',true)]]--
[INFO ] 09:44:07 [com.work.main.BatchRealtime] - 201612190955
[INFO ] 09:44:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:44:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612190955',true)]]--
[INFO ] 09:44:21 [com.work.main.BatchRealtime] - 201612191000
[INFO ] 09:44:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:44:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191000',true)]]--
[INFO ] 09:44:35 [com.work.main.BatchRealtime] - 201612191005
[INFO ] 09:44:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:44:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191005',true)]]--
[INFO ] 09:44:48 [com.work.main.BatchRealtime] - 201612191010
[INFO ] 09:44:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:44:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191010',true)]]--
[INFO ] 09:45:01 [com.work.main.BatchRealtime] - 201612191015
[INFO ] 09:45:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:45:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191015',true)]]--
[INFO ] 09:45:15 [com.work.main.BatchRealtime] - 201612191020
[INFO ] 09:45:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:45:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191020',true)]]--
[INFO ] 09:45:28 [com.work.main.BatchRealtime] - 201612191025
[INFO ] 09:45:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:45:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191025',true)]]--
[INFO ] 09:45:42 [com.work.main.BatchRealtime] - 201612191030
[INFO ] 09:45:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:45:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191030',true)]]--
[INFO ] 09:45:55 [com.work.main.BatchRealtime] - 201612191035
[INFO ] 09:45:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:45:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191035',true)]]--
[INFO ] 09:46:09 [com.work.main.BatchRealtime] - 201612191040
[INFO ] 09:46:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:46:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191040',true)]]--
[INFO ] 09:46:22 [com.work.main.BatchRealtime] - 201612191045
[INFO ] 09:46:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:46:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191045',true)]]--
[INFO ] 09:46:35 [com.work.main.BatchRealtime] - 201612191050
[INFO ] 09:46:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:46:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191050',true)]]--
[INFO ] 09:46:49 [com.work.main.BatchRealtime] - 201612191055
[INFO ] 09:46:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:46:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191055',true)]]--
[INFO ] 09:47:02 [com.work.main.BatchRealtime] - 201612191100
[INFO ] 09:47:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:47:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191100',true)]]--
[INFO ] 09:47:15 [com.work.main.BatchRealtime] - 201612191105
[INFO ] 09:47:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:47:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191105',true)]]--
[INFO ] 09:47:29 [com.work.main.BatchRealtime] - 201612191110
[INFO ] 09:47:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:47:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191110',true)]]--
[INFO ] 09:47:42 [com.work.main.BatchRealtime] - 201612191115
[INFO ] 09:47:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:47:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191115',true)]]--
[INFO ] 09:47:55 [com.work.main.BatchRealtime] - 201612191120
[INFO ] 09:47:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:47:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191120',true)]]--
[INFO ] 09:48:08 [com.work.main.BatchRealtime] - 201612191125
[INFO ] 09:48:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:48:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191125',true)]]--
[INFO ] 09:48:21 [com.work.main.BatchRealtime] - 201612191130
[INFO ] 09:48:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:48:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191130',true)]]--
[INFO ] 09:48:34 [com.work.main.BatchRealtime] - 201612191135
[INFO ] 09:48:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:48:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191135',true)]]--
[INFO ] 09:48:47 [com.work.main.BatchRealtime] - 201612191140
[INFO ] 09:48:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:48:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191140',true)]]--
[INFO ] 09:49:00 [com.work.main.BatchRealtime] - 201612191145
[INFO ] 09:49:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:49:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191145',true)]]--
[INFO ] 09:49:13 [com.work.main.BatchRealtime] - 201612191150
[INFO ] 09:49:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:49:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191150',true)]]--
[INFO ] 09:49:26 [com.work.main.BatchRealtime] - 201612191155
[INFO ] 09:49:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:49:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191155',true)]]--
[INFO ] 09:49:40 [com.work.main.BatchRealtime] - 201612191200
[INFO ] 09:49:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:49:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191200',true)]]--
[INFO ] 09:49:53 [com.work.main.BatchRealtime] - 201612191205
[INFO ] 09:49:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:49:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191205',true)]]--
[INFO ] 09:50:06 [com.work.main.BatchRealtime] - 201612191210
[INFO ] 09:50:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:50:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191210',true)]]--
[INFO ] 09:50:18 [com.work.main.BatchRealtime] - 201612191215
[INFO ] 09:50:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:50:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191215',true)]]--
[INFO ] 09:50:31 [com.work.main.BatchRealtime] - 201612191220
[INFO ] 09:50:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:50:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191220',true)]]--
[INFO ] 09:50:44 [com.work.main.BatchRealtime] - 201612191225
[INFO ] 09:50:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:50:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191225',true)]]--
[INFO ] 09:50:57 [com.work.main.BatchRealtime] - 201612191230
[INFO ] 09:50:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:50:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191230',true)]]--
[INFO ] 09:51:10 [com.work.main.BatchRealtime] - 201612191235
[INFO ] 09:51:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:51:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191235',true)]]--
[INFO ] 09:51:23 [com.work.main.BatchRealtime] - 201612191240
[INFO ] 09:51:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:51:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191240',true)]]--
[INFO ] 09:51:35 [com.work.main.BatchRealtime] - 201612191245
[INFO ] 09:51:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:51:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191245',true)]]--
[INFO ] 09:51:48 [com.work.main.BatchRealtime] - 201612191250
[INFO ] 09:51:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:51:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191250',true)]]--
[INFO ] 09:52:01 [com.work.main.BatchRealtime] - 201612191255
[INFO ] 09:52:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:52:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191255',true)]]--
[INFO ] 09:52:14 [com.work.main.BatchRealtime] - 201612191300
[INFO ] 09:52:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:52:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191300',true)]]--
[INFO ] 09:52:27 [com.work.main.BatchRealtime] - 201612191305
[INFO ] 09:52:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:52:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191305',true)]]--
[INFO ] 09:52:39 [com.work.main.BatchRealtime] - 201612191310
[INFO ] 09:52:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:52:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191310',true)]]--
[ERROR] 09:52:49 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 13:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:52:50 [com.work.main.BatchRealtime] - 201612191315
[INFO ] 09:52:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:52:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191315',true)]]--
[ERROR] 09:52:59 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 13:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 09:53:00 [com.work.main.BatchRealtime] - 201612191320
[INFO ] 09:53:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:53:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191320',true)]]--
[INFO ] 09:53:13 [com.work.main.BatchRealtime] - 201612191325
[INFO ] 09:53:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:53:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191325',true)]]--
[INFO ] 09:53:25 [com.work.main.BatchRealtime] - 201612191330
[INFO ] 09:53:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:53:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191330',true)]]--
[INFO ] 09:53:38 [com.work.main.BatchRealtime] - 201612191335
[INFO ] 09:53:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:53:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191335',true)]]--
[INFO ] 09:53:50 [com.work.main.BatchRealtime] - 201612191340
[INFO ] 09:53:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:53:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191340',true)]]--
[INFO ] 09:54:02 [com.work.main.BatchRealtime] - 201612191345
[INFO ] 09:54:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:54:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191345',true)]]--
[INFO ] 09:54:15 [com.work.main.BatchRealtime] - 201612191350
[INFO ] 09:54:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:54:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191350',true)]]--
[INFO ] 09:54:27 [com.work.main.BatchRealtime] - 201612191355
[INFO ] 09:54:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:54:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191355',true)]]--
[INFO ] 09:54:39 [com.work.main.BatchRealtime] - 201612191400
[INFO ] 09:54:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:54:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191400',true)]]--
[INFO ] 09:54:52 [com.work.main.BatchRealtime] - 201612191405
[INFO ] 09:54:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:54:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191405',true)]]--
[INFO ] 09:55:04 [com.work.main.BatchRealtime] - 201612191410
[INFO ] 09:55:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:55:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191410',true)]]--
[INFO ] 09:55:16 [com.work.main.BatchRealtime] - 201612191415
[INFO ] 09:55:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:55:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191415',true)]]--
[INFO ] 09:55:29 [com.work.main.BatchRealtime] - 201612191420
[INFO ] 09:55:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:55:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191420',true)]]--
[INFO ] 09:55:41 [com.work.main.BatchRealtime] - 201612191425
[INFO ] 09:55:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:55:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191425',true)]]--
[INFO ] 09:55:53 [com.work.main.BatchRealtime] - 201612191430
[INFO ] 09:55:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:55:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191430',true)]]--
[INFO ] 09:56:05 [com.work.main.BatchRealtime] - 201612191435
[INFO ] 09:56:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:56:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191435',true)]]--
[INFO ] 09:56:17 [com.work.main.BatchRealtime] - 201612191440
[INFO ] 09:56:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:56:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191440',true)]]--
[INFO ] 09:56:29 [com.work.main.BatchRealtime] - 201612191445
[INFO ] 09:56:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:56:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191445',true)]]--
[INFO ] 09:56:41 [com.work.main.BatchRealtime] - 201612191450
[INFO ] 09:56:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:56:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191450',true)]]--
[INFO ] 09:56:54 [com.work.main.BatchRealtime] - 201612191455
[INFO ] 09:56:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:56:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191455',true)]]--
[INFO ] 09:57:06 [com.work.main.BatchRealtime] - 201612191500
[INFO ] 09:57:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:57:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191500',true)]]--
[INFO ] 09:57:18 [com.work.main.BatchRealtime] - 201612191505
[INFO ] 09:57:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:57:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191505',true)]]--
[INFO ] 09:57:30 [com.work.main.BatchRealtime] - 201612191510
[INFO ] 09:57:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 09:57:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191510',true)]]--
[INFO ] 10:00:41 [com.work.main.BatchRealtime] - 201612191515
[INFO ] 10:00:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:00:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191515',true)]]--
[INFO ] 10:00:53 [com.work.main.BatchRealtime] - 201612191520
[INFO ] 10:00:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:00:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191520',true)]]--
[INFO ] 10:01:05 [com.work.main.BatchRealtime] - 201612191525
[INFO ] 10:01:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:01:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191525',true)]]--
[INFO ] 10:01:17 [com.work.main.BatchRealtime] - 201612191530
[INFO ] 10:01:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:01:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191530',true)]]--
[INFO ] 10:01:29 [com.work.main.BatchRealtime] - 201612191535
[INFO ] 10:01:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:01:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191535',true)]]--
[INFO ] 10:01:41 [com.work.main.BatchRealtime] - 201612191540
[INFO ] 10:01:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:01:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191540',true)]]--
[INFO ] 10:01:53 [com.work.main.BatchRealtime] - 201612191545
[INFO ] 10:01:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:01:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191545',true)]]--
[INFO ] 10:02:04 [com.work.main.BatchRealtime] - 201612191550
[INFO ] 10:02:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:02:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191550',true)]]--
[INFO ] 10:02:16 [com.work.main.BatchRealtime] - 201612191555
[INFO ] 10:02:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:02:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191555',true)]]--
[INFO ] 10:02:28 [com.work.main.BatchRealtime] - 201612191600
[INFO ] 10:02:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:02:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191600',true)]]--
[INFO ] 10:02:40 [com.work.main.BatchRealtime] - 201612191605
[INFO ] 10:02:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:02:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191605',true)]]--
[INFO ] 10:02:51 [com.work.main.BatchRealtime] - 201612191610
[INFO ] 10:02:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:02:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191610',true)]]--
[INFO ] 10:03:03 [com.work.main.BatchRealtime] - 201612191615
[INFO ] 10:03:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:03:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191615',true)]]--
[INFO ] 10:03:15 [com.work.main.BatchRealtime] - 201612191620
[INFO ] 10:03:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:03:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191620',true)]]--
[INFO ] 10:03:26 [com.work.main.BatchRealtime] - 201612191625
[INFO ] 10:03:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:03:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191625',true)]]--
[INFO ] 10:03:38 [com.work.main.BatchRealtime] - 201612191630
[INFO ] 10:03:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:03:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191630',true)]]--
[INFO ] 10:03:50 [com.work.main.BatchRealtime] - 201612191635
[INFO ] 10:03:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:03:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191635',true)]]--
[INFO ] 10:04:01 [com.work.main.BatchRealtime] - 201612191640
[INFO ] 10:04:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:04:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191640',true)]]--
[INFO ] 10:04:13 [com.work.main.BatchRealtime] - 201612191645
[INFO ] 10:04:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:04:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191645',true)]]--
[INFO ] 10:04:25 [com.work.main.BatchRealtime] - 201612191650
[INFO ] 10:04:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:04:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191650',true)]]--
[INFO ] 10:04:36 [com.work.main.BatchRealtime] - 201612191655
[INFO ] 10:04:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:04:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191655',true)]]--
[INFO ] 10:04:48 [com.work.main.BatchRealtime] - 201612191700
[INFO ] 10:04:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:04:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191700',true)]]--
[INFO ] 10:04:59 [com.work.main.BatchRealtime] - 201612191705
[INFO ] 10:05:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191705',true)]]--
[INFO ] 10:05:11 [com.work.main.BatchRealtime] - 201612191710
[INFO ] 10:05:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191710',true)]]--
[INFO ] 10:05:23 [com.work.main.BatchRealtime] - 201612191715
[INFO ] 10:05:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191715',true)]]--
[INFO ] 10:05:34 [com.work.main.BatchRealtime] - 201612191720
[INFO ] 10:05:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191720',true)]]--
[INFO ] 10:05:46 [com.work.main.BatchRealtime] - 201612191725
[INFO ] 10:05:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191725',true)]]--
[INFO ] 10:05:57 [com.work.main.BatchRealtime] - 201612191730
[INFO ] 10:05:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:05:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191730',true)]]--
[INFO ] 10:06:08 [com.work.main.BatchRealtime] - 201612191735
[INFO ] 10:06:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:06:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191735',true)]]--
[INFO ] 10:06:19 [com.work.main.BatchRealtime] - 201612191740
[INFO ] 10:06:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:06:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191740',true)]]--
[INFO ] 10:06:31 [com.work.main.BatchRealtime] - 201612191745
[INFO ] 10:06:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:06:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191745',true)]]--
[INFO ] 10:06:42 [com.work.main.BatchRealtime] - 201612191750
[INFO ] 10:06:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:06:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191750',true)]]--
[INFO ] 10:06:53 [com.work.main.BatchRealtime] - 201612191755
[INFO ] 10:06:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:06:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191755',true)]]--
[INFO ] 10:07:04 [com.work.main.BatchRealtime] - 201612191800
[INFO ] 10:07:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:07:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191800',true)]]--
[INFO ] 10:07:16 [com.work.main.BatchRealtime] - 201612191805
[INFO ] 10:07:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:07:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191805',true)]]--
[INFO ] 10:07:27 [com.work.main.BatchRealtime] - 201612191810
[INFO ] 10:07:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:07:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191810',true)]]--
[INFO ] 10:07:38 [com.work.main.BatchRealtime] - 201612191815
[INFO ] 10:07:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:07:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191815',true)]]--
[INFO ] 10:07:49 [com.work.main.BatchRealtime] - 201612191820
[INFO ] 10:07:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:07:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191820',true)]]--
[INFO ] 10:08:00 [com.work.main.BatchRealtime] - 201612191825
[INFO ] 10:08:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191825',true)]]--
[INFO ] 10:08:11 [com.work.main.BatchRealtime] - 201612191830
[INFO ] 10:08:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191830',true)]]--
[INFO ] 10:08:22 [com.work.main.BatchRealtime] - 201612191835
[INFO ] 10:08:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191835',true)]]--
[INFO ] 10:08:33 [com.work.main.BatchRealtime] - 201612191840
[INFO ] 10:08:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191840',true)]]--
[INFO ] 10:08:44 [com.work.main.BatchRealtime] - 201612191845
[INFO ] 10:08:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191845',true)]]--
[INFO ] 10:08:55 [com.work.main.BatchRealtime] - 201612191850
[INFO ] 10:08:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:08:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191850',true)]]--
[ERROR] 10:09:03 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 18:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:04 [com.work.main.BatchRealtime] - 201612191855
[INFO ] 10:09:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191855',true)]]--
[ERROR] 10:09:12 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:13 [com.work.main.BatchRealtime] - 201612191900
[INFO ] 10:09:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191900',true)]]--
[ERROR] 10:09:20 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:21 [com.work.main.BatchRealtime] - 201612191905
[INFO ] 10:09:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191905',true)]]--
[ERROR] 10:09:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:30 [com.work.main.BatchRealtime] - 201612191910
[INFO ] 10:09:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191910',true)]]--
[ERROR] 10:09:38 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:39 [com.work.main.BatchRealtime] - 201612191915
[INFO ] 10:09:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191915',true)]]--
[ERROR] 10:09:47 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 19:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:48 [com.work.main.BatchRealtime] - 201612191920
[INFO ] 10:09:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191920',true)]]--
[ERROR] 10:09:55 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:09:56 [com.work.main.BatchRealtime] - 201612191925
[INFO ] 10:09:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:09:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191925',true)]]--
[ERROR] 10:10:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:05 [com.work.main.BatchRealtime] - 201612191930
[INFO ] 10:10:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191930',true)]]--
[ERROR] 10:10:13 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:14 [com.work.main.BatchRealtime] - 201612191935
[INFO ] 10:10:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191935',true)]]--
[ERROR] 10:10:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 19:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:22 [com.work.main.BatchRealtime] - 201612191940
[INFO ] 10:10:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191940',true)]]--
[ERROR] 10:10:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 19:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:31 [com.work.main.BatchRealtime] - 201612191945
[INFO ] 10:10:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191945',true)]]--
[ERROR] 10:10:39 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 19:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:40 [com.work.main.BatchRealtime] - 201612191950
[INFO ] 10:10:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191950',true)]]--
[ERROR] 10:10:47 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 19:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:48 [com.work.main.BatchRealtime] - 201612191955
[INFO ] 10:10:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612191955',true)]]--
[ERROR] 10:10:56 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:10:57 [com.work.main.BatchRealtime] - 201612192000
[INFO ] 10:10:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:10:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192000',true)]]--
[ERROR] 10:11:05 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:06 [com.work.main.BatchRealtime] - 201612192005
[INFO ] 10:11:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192005',true)]]--
[ERROR] 10:11:13 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:14 [com.work.main.BatchRealtime] - 201612192010
[INFO ] 10:11:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192010',true)]]--
[ERROR] 10:11:22 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:23 [com.work.main.BatchRealtime] - 201612192015
[INFO ] 10:11:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192015',true)]]--
[ERROR] 10:11:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:31 [com.work.main.BatchRealtime] - 201612192020
[INFO ] 10:11:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192020',true)]]--
[ERROR] 10:11:38 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 20:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:40 [com.work.main.BatchRealtime] - 201612192025
[INFO ] 10:11:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192025',true)]]--
[ERROR] 10:11:47 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 20:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:48 [com.work.main.BatchRealtime] - 201612192030
[INFO ] 10:11:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192030',true)]]--
[ERROR] 10:11:55 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:11:56 [com.work.main.BatchRealtime] - 201612192035
[INFO ] 10:11:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:11:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192035',true)]]--
[ERROR] 10:12:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 20:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:05 [com.work.main.BatchRealtime] - 201612192040
[INFO ] 10:12:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192040',true)]]--
[ERROR] 10:12:12 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:13 [com.work.main.BatchRealtime] - 201612192045
[INFO ] 10:12:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192045',true)]]--
[ERROR] 10:12:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 20:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:22 [com.work.main.BatchRealtime] - 201612192050
[INFO ] 10:12:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192050',true)]]--
[ERROR] 10:12:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 20:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:30 [com.work.main.BatchRealtime] - 201612192055
[INFO ] 10:12:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192055',true)]]--
[ERROR] 10:12:37 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 21:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:38 [com.work.main.BatchRealtime] - 201612192100
[INFO ] 10:12:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192100',true)]]--
[ERROR] 10:12:45 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:47 [com.work.main.BatchRealtime] - 201612192105
[INFO ] 10:12:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192105',true)]]--
[ERROR] 10:12:54 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:12:55 [com.work.main.BatchRealtime] - 201612192110
[INFO ] 10:12:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:12:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192110',true)]]--
[ERROR] 10:13:02 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:03 [com.work.main.BatchRealtime] - 201612192115
[INFO ] 10:13:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192115',true)]]--
[ERROR] 10:13:10 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:11 [com.work.main.BatchRealtime] - 201612192120
[INFO ] 10:13:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192120',true)]]--
[ERROR] 10:13:19 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:20 [com.work.main.BatchRealtime] - 201612192125
[INFO ] 10:13:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192125',true)]]--
[ERROR] 10:13:27 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:28 [com.work.main.BatchRealtime] - 201612192130
[INFO ] 10:13:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192130',true)]]--
[ERROR] 10:13:35 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 21:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:36 [com.work.main.BatchRealtime] - 201612192135
[INFO ] 10:13:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192135',true)]]--
[ERROR] 10:13:43 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 21:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:44 [com.work.main.BatchRealtime] - 201612192140
[INFO ] 10:13:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192140',true)]]--
[ERROR] 10:13:51 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 21:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:13:52 [com.work.main.BatchRealtime] - 201612192145
[INFO ] 10:13:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:13:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192145',true)]]--
[ERROR] 10:14:00 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 21:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:01 [com.work.main.BatchRealtime] - 201612192150
[INFO ] 10:14:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192150',true)]]--
[ERROR] 10:14:08 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 21:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:09 [com.work.main.BatchRealtime] - 201612192155
[INFO ] 10:14:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192155',true)]]--
[ERROR] 10:14:16 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:17 [com.work.main.BatchRealtime] - 201612192200
[INFO ] 10:14:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192200',true)]]--
[ERROR] 10:14:24 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:25 [com.work.main.BatchRealtime] - 201612192205
[INFO ] 10:14:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192205',true)]]--
[ERROR] 10:14:32 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:33 [com.work.main.BatchRealtime] - 201612192210
[INFO ] 10:14:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192210',true)]]--
[ERROR] 10:14:41 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:42 [com.work.main.BatchRealtime] - 201612192215
[INFO ] 10:14:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192215',true)]]--
[ERROR] 10:14:49 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:50 [com.work.main.BatchRealtime] - 201612192220
[INFO ] 10:14:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192220',true)]]--
[ERROR] 10:14:57 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:14:58 [com.work.main.BatchRealtime] - 201612192225
[INFO ] 10:14:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:14:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192225',true)]]--
[ERROR] 10:15:05 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:06 [com.work.main.BatchRealtime] - 201612192230
[INFO ] 10:15:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192230',true)]]--
[ERROR] 10:15:13 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:14 [com.work.main.BatchRealtime] - 201612192235
[INFO ] 10:15:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192235',true)]]--
[ERROR] 10:15:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:22 [com.work.main.BatchRealtime] - 201612192240
[INFO ] 10:15:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192240',true)]]--
[ERROR] 10:15:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:30 [com.work.main.BatchRealtime] - 201612192245
[INFO ] 10:15:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192245',true)]]--
[ERROR] 10:15:37 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 22:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:38 [com.work.main.BatchRealtime] - 201612192250
[INFO ] 10:15:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192250',true)]]--
[ERROR] 10:15:45 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 22:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:46 [com.work.main.BatchRealtime] - 201612192255
[INFO ] 10:15:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192255',true)]]--
[ERROR] 10:15:53 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 23:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:15:54 [com.work.main.BatchRealtime] - 201612192300
[INFO ] 10:15:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:15:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192300',true)]]--
[ERROR] 10:16:01 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:02 [com.work.main.BatchRealtime] - 201612192305
[INFO ] 10:16:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192305',true)]]--
[ERROR] 10:16:09 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:10 [com.work.main.BatchRealtime] - 201612192310
[INFO ] 10:16:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192310',true)]]--
[ERROR] 10:16:17 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:18 [com.work.main.BatchRealtime] - 201612192315
[INFO ] 10:16:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192315',true)]]--
[ERROR] 10:16:25 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 23:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:26 [com.work.main.BatchRealtime] - 201612192320
[INFO ] 10:16:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192320',true)]]--
[ERROR] 10:16:33 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:34 [com.work.main.BatchRealtime] - 201612192325
[INFO ] 10:16:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192325',true)]]--
[ERROR] 10:16:41 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 23:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:42 [com.work.main.BatchRealtime] - 201612192330
[INFO ] 10:16:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192330',true)]]--
[ERROR] 10:16:48 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:49 [com.work.main.BatchRealtime] - 201612192335
[INFO ] 10:16:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192335',true)]]--
[ERROR] 10:16:56 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 23:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:16:57 [com.work.main.BatchRealtime] - 201612192340
[INFO ] 10:16:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:16:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192340',true)]]--
[ERROR] 10:17:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-19 23:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:17:05 [com.work.main.BatchRealtime] - 201612192345
[INFO ] 10:17:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:17:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192345',true)]]--
[ERROR] 10:17:12 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:17:13 [com.work.main.BatchRealtime] - 201612192350
[INFO ] 10:17:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:17:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192350',true)]]--
[ERROR] 10:17:20 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-19 23:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:17:21 [com.work.main.BatchRealtime] - 201612192355
[INFO ] 10:17:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:17:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612192355',true)]]--
[ERROR] 10:17:28 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-20 00:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:20:31 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 10:20:31 [com.work.main.BatchRealtime] - 201612180000
[INFO ] 10:20:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:20:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180000',true)]]--
[ERROR] 10:20:46 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:20:47 [com.work.main.BatchRealtime] - 201612180005
[INFO ] 10:20:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:20:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180005',true)]]--
[ERROR] 10:20:58 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 00:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:20:59 [com.work.main.BatchRealtime] - 201612180010
[INFO ] 10:20:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:20:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180010',true)]]--
[INFO ] 10:21:15 [com.work.main.BatchRealtime] - 201612180015
[INFO ] 10:21:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:21:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180015',true)]]--
[INFO ] 10:21:29 [com.work.main.BatchRealtime] - 201612180020
[INFO ] 10:21:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:21:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180020',true)]]--
[INFO ] 10:21:44 [com.work.main.BatchRealtime] - 201612180025
[INFO ] 10:21:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:21:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180025',true)]]--
[INFO ] 10:21:59 [com.work.main.BatchRealtime] - 201612180030
[INFO ] 10:21:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:21:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180030',true)]]--
[INFO ] 10:22:13 [com.work.main.BatchRealtime] - 201612180035
[INFO ] 10:22:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:22:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180035',true)]]--
[INFO ] 10:22:27 [com.work.main.BatchRealtime] - 201612180040
[INFO ] 10:22:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:22:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180040',true)]]--
[INFO ] 10:22:42 [com.work.main.BatchRealtime] - 201612180045
[INFO ] 10:22:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:22:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180045',true)]]--
[INFO ] 10:22:56 [com.work.main.BatchRealtime] - 201612180050
[INFO ] 10:22:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:22:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180050',true)]]--
[INFO ] 10:23:11 [com.work.main.BatchRealtime] - 201612180055
[INFO ] 10:23:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:23:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180055',true)]]--
[INFO ] 10:23:25 [com.work.main.BatchRealtime] - 201612180100
[INFO ] 10:23:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:23:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180100',true)]]--
[INFO ] 10:23:40 [com.work.main.BatchRealtime] - 201612180105
[INFO ] 10:23:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:23:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180105',true)]]--
[INFO ] 10:23:55 [com.work.main.BatchRealtime] - 201612180110
[INFO ] 10:23:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:23:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180110',true)]]--
[INFO ] 10:24:09 [com.work.main.BatchRealtime] - 201612180115
[INFO ] 10:24:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:24:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180115',true)]]--
[INFO ] 10:24:23 [com.work.main.BatchRealtime] - 201612180120
[INFO ] 10:24:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:24:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180120',true)]]--
[INFO ] 10:24:38 [com.work.main.BatchRealtime] - 201612180125
[INFO ] 10:24:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:24:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180125',true)]]--
[INFO ] 10:24:52 [com.work.main.BatchRealtime] - 201612180130
[INFO ] 10:24:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:24:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180130',true)]]--
[INFO ] 10:25:07 [com.work.main.BatchRealtime] - 201612180135
[INFO ] 10:25:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:25:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180135',true)]]--
[INFO ] 10:25:21 [com.work.main.BatchRealtime] - 201612180140
[INFO ] 10:25:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:25:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180140',true)]]--
[INFO ] 10:25:35 [com.work.main.BatchRealtime] - 201612180145
[INFO ] 10:25:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:25:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180145',true)]]--
[INFO ] 10:25:50 [com.work.main.BatchRealtime] - 201612180150
[INFO ] 10:25:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:25:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180150',true)]]--
[INFO ] 10:26:04 [com.work.main.BatchRealtime] - 201612180155
[INFO ] 10:26:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:26:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180155',true)]]--
[INFO ] 10:26:19 [com.work.main.BatchRealtime] - 201612180200
[INFO ] 10:26:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:26:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180200',true)]]--
[INFO ] 10:26:33 [com.work.main.BatchRealtime] - 201612180205
[INFO ] 10:26:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:26:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180205',true)]]--
[INFO ] 10:26:55 [com.work.main.BatchRealtime] - 201612180210
[INFO ] 10:26:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:26:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180210',true)]]--
[INFO ] 10:27:10 [com.work.main.BatchRealtime] - 201612180215
[INFO ] 10:27:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:27:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180215',true)]]--
[INFO ] 10:27:24 [com.work.main.BatchRealtime] - 201612180220
[INFO ] 10:27:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:27:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180220',true)]]--
[INFO ] 10:27:39 [com.work.main.BatchRealtime] - 201612180225
[INFO ] 10:27:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:27:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180225',true)]]--
[INFO ] 10:27:53 [com.work.main.BatchRealtime] - 201612180230
[INFO ] 10:27:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:27:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180230',true)]]--
[INFO ] 10:28:07 [com.work.main.BatchRealtime] - 201612180235
[INFO ] 10:28:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:28:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180235',true)]]--
[INFO ] 10:28:22 [com.work.main.BatchRealtime] - 201612180240
[INFO ] 10:28:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:28:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180240',true)]]--
[INFO ] 10:28:36 [com.work.main.BatchRealtime] - 201612180245
[INFO ] 10:28:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:28:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180245',true)]]--
[INFO ] 10:28:50 [com.work.main.BatchRealtime] - 201612180250
[INFO ] 10:28:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:28:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180250',true)]]--
[INFO ] 10:29:04 [com.work.main.BatchRealtime] - 201612180255
[INFO ] 10:29:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:29:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180255',true)]]--
[INFO ] 10:29:19 [com.work.main.BatchRealtime] - 201612180300
[INFO ] 10:29:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:29:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180300',true)]]--
[INFO ] 10:29:33 [com.work.main.BatchRealtime] - 201612180305
[INFO ] 10:29:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:29:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180305',true)]]--
[INFO ] 10:29:48 [com.work.main.BatchRealtime] - 201612180310
[INFO ] 10:29:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:29:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180310',true)]]--
[INFO ] 10:30:02 [com.work.main.BatchRealtime] - 201612180315
[INFO ] 10:30:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:30:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180315',true)]]--
[INFO ] 10:30:16 [com.work.main.BatchRealtime] - 201612180320
[INFO ] 10:30:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:30:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180320',true)]]--
[INFO ] 10:30:31 [com.work.main.BatchRealtime] - 201612180325
[INFO ] 10:30:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:30:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180325',true)]]--
[INFO ] 10:30:45 [com.work.main.BatchRealtime] - 201612180330
[INFO ] 10:30:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:30:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180330',true)]]--
[INFO ] 10:30:59 [com.work.main.BatchRealtime] - 201612180335
[INFO ] 10:30:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:30:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180335',true)]]--
[INFO ] 10:31:13 [com.work.main.BatchRealtime] - 201612180340
[INFO ] 10:31:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:31:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180340',true)]]--
[INFO ] 10:31:28 [com.work.main.BatchRealtime] - 201612180345
[INFO ] 10:31:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:31:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180345',true)]]--
[INFO ] 10:31:42 [com.work.main.BatchRealtime] - 201612180350
[INFO ] 10:31:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:31:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180350',true)]]--
[INFO ] 10:31:56 [com.work.main.BatchRealtime] - 201612180355
[INFO ] 10:31:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:31:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180355',true)]]--
[INFO ] 10:32:11 [com.work.main.BatchRealtime] - 201612180400
[INFO ] 10:32:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:32:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180400',true)]]--
[ERROR] 10:32:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 04:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:32:22 [com.work.main.BatchRealtime] - 201612180405
[INFO ] 10:32:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:32:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180405',true)]]--
[INFO ] 10:32:37 [com.work.main.BatchRealtime] - 201612180410
[INFO ] 10:32:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:32:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180410',true)]]--
[INFO ] 10:32:51 [com.work.main.BatchRealtime] - 201612180415
[INFO ] 10:32:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:32:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180415',true)]]--
[INFO ] 10:33:05 [com.work.main.BatchRealtime] - 201612180420
[INFO ] 10:33:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:33:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180420',true)]]--
[INFO ] 10:33:20 [com.work.main.BatchRealtime] - 201612180425
[INFO ] 10:33:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:33:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180425',true)]]--
[INFO ] 10:33:34 [com.work.main.BatchRealtime] - 201612180430
[INFO ] 10:33:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:33:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180430',true)]]--
[INFO ] 10:33:48 [com.work.main.BatchRealtime] - 201612180435
[INFO ] 10:33:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:33:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180435',true)]]--
[INFO ] 10:34:02 [com.work.main.BatchRealtime] - 201612180440
[INFO ] 10:34:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:34:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180440',true)]]--
[INFO ] 10:34:16 [com.work.main.BatchRealtime] - 201612180445
[INFO ] 10:34:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:34:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180445',true)]]--
[INFO ] 10:34:30 [com.work.main.BatchRealtime] - 201612180450
[INFO ] 10:34:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:34:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180450',true)]]--
[INFO ] 10:34:45 [com.work.main.BatchRealtime] - 201612180455
[INFO ] 10:34:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:34:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180455',true)]]--
[INFO ] 10:34:59 [com.work.main.BatchRealtime] - 201612180500
[INFO ] 10:34:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:34:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180500',true)]]--
[ERROR] 10:35:10 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 05:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:35:11 [com.work.main.BatchRealtime] - 201612180505
[INFO ] 10:35:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:35:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180505',true)]]--
[INFO ] 10:35:25 [com.work.main.BatchRealtime] - 201612180510
[INFO ] 10:35:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:35:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180510',true)]]--
[INFO ] 10:35:39 [com.work.main.BatchRealtime] - 201612180515
[INFO ] 10:35:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:35:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180515',true)]]--
[INFO ] 10:35:53 [com.work.main.BatchRealtime] - 201612180520
[INFO ] 10:35:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:35:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180520',true)]]--
[INFO ] 10:36:07 [com.work.main.BatchRealtime] - 201612180525
[INFO ] 10:36:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:36:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180525',true)]]--
[INFO ] 10:36:22 [com.work.main.BatchRealtime] - 201612180530
[INFO ] 10:36:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:36:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180530',true)]]--
[INFO ] 10:36:36 [com.work.main.BatchRealtime] - 201612180535
[INFO ] 10:36:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:36:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180535',true)]]--
[INFO ] 10:36:50 [com.work.main.BatchRealtime] - 201612180540
[INFO ] 10:36:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:36:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180540',true)]]--
[INFO ] 10:37:04 [com.work.main.BatchRealtime] - 201612180545
[INFO ] 10:37:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:37:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180545',true)]]--
[INFO ] 10:37:18 [com.work.main.BatchRealtime] - 201612180550
[INFO ] 10:37:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:37:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180550',true)]]--
[INFO ] 10:37:32 [com.work.main.BatchRealtime] - 201612180555
[INFO ] 10:37:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:37:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180555',true)]]--
[INFO ] 10:37:47 [com.work.main.BatchRealtime] - 201612180600
[INFO ] 10:37:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:37:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180600',true)]]--
[ERROR] 10:37:58 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-18 06:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:37:59 [com.work.main.BatchRealtime] - 201612180605
[INFO ] 10:37:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:37:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180605',true)]]--
[INFO ] 10:38:13 [com.work.main.BatchRealtime] - 201612180610
[INFO ] 10:38:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:38:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180610',true)]]--
[INFO ] 10:38:27 [com.work.main.BatchRealtime] - 201612180615
[INFO ] 10:38:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:38:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180615',true)]]--
[INFO ] 10:38:41 [com.work.main.BatchRealtime] - 201612180620
[INFO ] 10:38:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:38:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180620',true)]]--
[INFO ] 10:38:55 [com.work.main.BatchRealtime] - 201612180625
[INFO ] 10:38:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:38:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180625',true)]]--
[INFO ] 10:39:09 [com.work.main.BatchRealtime] - 201612180630
[INFO ] 10:39:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:39:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180630',true)]]--
[INFO ] 10:39:23 [com.work.main.BatchRealtime] - 201612180635
[INFO ] 10:39:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:39:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180635',true)]]--
[INFO ] 10:39:37 [com.work.main.BatchRealtime] - 201612180640
[INFO ] 10:39:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:39:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180640',true)]]--
[INFO ] 10:39:51 [com.work.main.BatchRealtime] - 201612180645
[INFO ] 10:39:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:39:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180645',true)]]--
[INFO ] 10:40:05 [com.work.main.BatchRealtime] - 201612180650
[INFO ] 10:40:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:40:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180650',true)]]--
[INFO ] 10:40:19 [com.work.main.BatchRealtime] - 201612180655
[INFO ] 10:40:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:40:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180655',true)]]--
[INFO ] 10:40:33 [com.work.main.BatchRealtime] - 201612180700
[INFO ] 10:40:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:40:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180700',true)]]--
[ERROR] 10:40:44 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 07:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:40:45 [com.work.main.BatchRealtime] - 201612180705
[INFO ] 10:40:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:40:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180705',true)]]--
[INFO ] 10:40:59 [com.work.main.BatchRealtime] - 201612180710
[INFO ] 10:40:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:40:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180710',true)]]--
[INFO ] 10:41:13 [com.work.main.BatchRealtime] - 201612180715
[INFO ] 10:41:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:41:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180715',true)]]--
[INFO ] 10:41:27 [com.work.main.BatchRealtime] - 201612180720
[INFO ] 10:41:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:41:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180720',true)]]--
[INFO ] 10:41:41 [com.work.main.BatchRealtime] - 201612180725
[INFO ] 10:41:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:41:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180725',true)]]--
[INFO ] 10:41:55 [com.work.main.BatchRealtime] - 201612180730
[INFO ] 10:41:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:41:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180730',true)]]--
[INFO ] 10:42:09 [com.work.main.BatchRealtime] - 201612180735
[INFO ] 10:42:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:42:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180735',true)]]--
[INFO ] 10:42:23 [com.work.main.BatchRealtime] - 201612180740
[INFO ] 10:42:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:42:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180740',true)]]--
[INFO ] 10:42:37 [com.work.main.BatchRealtime] - 201612180745
[INFO ] 10:42:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:42:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180745',true)]]--
[INFO ] 10:42:51 [com.work.main.BatchRealtime] - 201612180750
[INFO ] 10:42:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:42:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180750',true)]]--
[INFO ] 10:43:05 [com.work.main.BatchRealtime] - 201612180755
[INFO ] 10:43:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:43:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180755',true)]]--
[INFO ] 10:43:19 [com.work.main.BatchRealtime] - 201612180800
[INFO ] 10:43:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:43:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180800',true)]]--
[ERROR] 10:43:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 08:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:43:31 [com.work.main.BatchRealtime] - 201612180805
[INFO ] 10:43:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:43:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180805',true)]]--
[INFO ] 10:43:45 [com.work.main.BatchRealtime] - 201612180810
[INFO ] 10:43:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:43:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180810',true)]]--
[INFO ] 10:43:59 [com.work.main.BatchRealtime] - 201612180815
[INFO ] 10:43:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:43:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180815',true)]]--
[INFO ] 10:44:12 [com.work.main.BatchRealtime] - 201612180820
[INFO ] 10:44:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:44:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180820',true)]]--
[ERROR] 10:44:23 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 08:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:44:24 [com.work.main.BatchRealtime] - 201612180825
[INFO ] 10:44:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:44:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180825',true)]]--
[INFO ] 10:44:38 [com.work.main.BatchRealtime] - 201612180830
[INFO ] 10:44:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:44:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180830',true)]]--
[INFO ] 10:44:52 [com.work.main.BatchRealtime] - 201612180835
[INFO ] 10:44:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:44:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180835',true)]]--
[INFO ] 10:45:05 [com.work.main.BatchRealtime] - 201612180840
[INFO ] 10:45:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:45:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180840',true)]]--
[INFO ] 10:45:19 [com.work.main.BatchRealtime] - 201612180845
[INFO ] 10:45:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:45:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180845',true)]]--
[INFO ] 10:45:33 [com.work.main.BatchRealtime] - 201612180850
[INFO ] 10:45:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:45:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180850',true)]]--
[INFO ] 10:45:47 [com.work.main.BatchRealtime] - 201612180855
[INFO ] 10:45:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:45:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180855',true)]]--
[INFO ] 10:46:01 [com.work.main.BatchRealtime] - 201612180900
[INFO ] 10:46:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:46:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180900',true)]]--
[ERROR] 10:46:11 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-18 09:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:46:12 [com.work.main.BatchRealtime] - 201612180905
[INFO ] 10:46:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:46:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180905',true)]]--
[INFO ] 10:46:26 [com.work.main.BatchRealtime] - 201612180910
[INFO ] 10:46:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:46:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180910',true)]]--
[INFO ] 10:46:39 [com.work.main.BatchRealtime] - 201612180915
[INFO ] 10:46:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:46:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180915',true)]]--
[INFO ] 10:46:53 [com.work.main.BatchRealtime] - 201612180920
[INFO ] 10:46:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:46:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180920',true)]]--
[INFO ] 10:47:07 [com.work.main.BatchRealtime] - 201612180925
[INFO ] 10:47:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:47:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180925',true)]]--
[INFO ] 10:47:20 [com.work.main.BatchRealtime] - 201612180930
[INFO ] 10:47:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:47:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180930',true)]]--
[INFO ] 10:47:34 [com.work.main.BatchRealtime] - 201612180935
[INFO ] 10:47:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:47:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180935',true)]]--
[INFO ] 10:47:47 [com.work.main.BatchRealtime] - 201612180940
[INFO ] 10:47:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:47:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180940',true)]]--
[INFO ] 10:48:01 [com.work.main.BatchRealtime] - 201612180945
[INFO ] 10:48:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:48:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180945',true)]]--
[INFO ] 10:48:15 [com.work.main.BatchRealtime] - 201612180950
[INFO ] 10:48:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:48:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180950',true)]]--
[INFO ] 10:48:28 [com.work.main.BatchRealtime] - 201612180955
[INFO ] 10:48:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:48:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612180955',true)]]--
[INFO ] 10:48:42 [com.work.main.BatchRealtime] - 201612181000
[INFO ] 10:48:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:48:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181000',true)]]--
[ERROR] 10:48:52 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 10:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:48:53 [com.work.main.BatchRealtime] - 201612181005
[INFO ] 10:48:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:48:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181005',true)]]--
[INFO ] 10:49:06 [com.work.main.BatchRealtime] - 201612181010
[INFO ] 10:49:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:49:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181010',true)]]--
[INFO ] 10:49:20 [com.work.main.BatchRealtime] - 201612181015
[INFO ] 10:49:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:49:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181015',true)]]--
[INFO ] 10:49:33 [com.work.main.BatchRealtime] - 201612181020
[INFO ] 10:49:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:49:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181020',true)]]--
[INFO ] 10:49:47 [com.work.main.BatchRealtime] - 201612181025
[INFO ] 10:49:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:49:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181025',true)]]--
[INFO ] 10:50:00 [com.work.main.BatchRealtime] - 201612181030
[INFO ] 10:50:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:50:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181030',true)]]--
[INFO ] 10:50:13 [com.work.main.BatchRealtime] - 201612181035
[INFO ] 10:50:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:50:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181035',true)]]--
[INFO ] 10:50:27 [com.work.main.BatchRealtime] - 201612181040
[INFO ] 10:50:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:50:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181040',true)]]--
[INFO ] 10:50:40 [com.work.main.BatchRealtime] - 201612181045
[INFO ] 10:50:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:50:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181045',true)]]--
[INFO ] 10:50:53 [com.work.main.BatchRealtime] - 201612181050
[INFO ] 10:50:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:50:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181050',true)]]--
[INFO ] 10:51:06 [com.work.main.BatchRealtime] - 201612181055
[INFO ] 10:51:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:51:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181055',true)]]--
[INFO ] 10:51:20 [com.work.main.BatchRealtime] - 201612181100
[INFO ] 10:51:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:51:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181100',true)]]--
[ERROR] 10:51:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 11:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:51:31 [com.work.main.BatchRealtime] - 201612181105
[INFO ] 10:51:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:51:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181105',true)]]--
[INFO ] 10:51:44 [com.work.main.BatchRealtime] - 201612181110
[INFO ] 10:51:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:51:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181110',true)]]--
[INFO ] 10:51:57 [com.work.main.BatchRealtime] - 201612181115
[INFO ] 10:51:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:51:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181115',true)]]--
[INFO ] 10:52:10 [com.work.main.BatchRealtime] - 201612181120
[INFO ] 10:52:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:52:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181120',true)]]--
[INFO ] 10:52:23 [com.work.main.BatchRealtime] - 201612181125
[INFO ] 10:52:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:52:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181125',true)]]--
[INFO ] 10:52:36 [com.work.main.BatchRealtime] - 201612181130
[INFO ] 10:52:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:52:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181130',true)]]--
[INFO ] 10:52:49 [com.work.main.BatchRealtime] - 201612181135
[INFO ] 10:52:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:52:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181135',true)]]--
[INFO ] 10:53:02 [com.work.main.BatchRealtime] - 201612181140
[INFO ] 10:53:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:53:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181140',true)]]--
[INFO ] 10:53:15 [com.work.main.BatchRealtime] - 201612181145
[INFO ] 10:53:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:53:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181145',true)]]--
[INFO ] 10:53:28 [com.work.main.BatchRealtime] - 201612181150
[INFO ] 10:53:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:53:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181150',true)]]--
[INFO ] 10:53:41 [com.work.main.BatchRealtime] - 201612181155
[INFO ] 10:53:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:53:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181155',true)]]--
[INFO ] 10:53:54 [com.work.main.BatchRealtime] - 201612181200
[INFO ] 10:53:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:53:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181200',true)]]--
[INFO ] 10:54:07 [com.work.main.BatchRealtime] - 201612181205
[INFO ] 10:54:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:54:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181205',true)]]--
[INFO ] 10:54:20 [com.work.main.BatchRealtime] - 201612181210
[INFO ] 10:54:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:54:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181210',true)]]--
[INFO ] 10:54:33 [com.work.main.BatchRealtime] - 201612181215
[INFO ] 10:54:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:54:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181215',true)]]--
[INFO ] 10:54:46 [com.work.main.BatchRealtime] - 201612181220
[INFO ] 10:54:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:54:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181220',true)]]--
[INFO ] 10:54:59 [com.work.main.BatchRealtime] - 201612181225
[INFO ] 10:54:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:54:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181225',true)]]--
[INFO ] 10:55:11 [com.work.main.BatchRealtime] - 201612181230
[INFO ] 10:55:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:55:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181230',true)]]--
[INFO ] 10:55:24 [com.work.main.BatchRealtime] - 201612181235
[INFO ] 10:55:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:55:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181235',true)]]--
[INFO ] 10:55:37 [com.work.main.BatchRealtime] - 201612181240
[INFO ] 10:55:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:55:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181240',true)]]--
[INFO ] 10:55:49 [com.work.main.BatchRealtime] - 201612181245
[INFO ] 10:55:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:55:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181245',true)]]--
[INFO ] 10:56:02 [com.work.main.BatchRealtime] - 201612181250
[INFO ] 10:56:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:56:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181250',true)]]--
[INFO ] 10:56:15 [com.work.main.BatchRealtime] - 201612181255
[INFO ] 10:56:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:56:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181255',true)]]--
[INFO ] 10:56:28 [com.work.main.BatchRealtime] - 201612181300
[INFO ] 10:56:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:56:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181300',true)]]--
[ERROR] 10:56:37 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 13:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:56:38 [com.work.main.BatchRealtime] - 201612181305
[INFO ] 10:56:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:56:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181305',true)]]--
[INFO ] 10:56:50 [com.work.main.BatchRealtime] - 201612181310
[INFO ] 10:56:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:56:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181310',true)]]--
[INFO ] 10:57:03 [com.work.main.BatchRealtime] - 201612181315
[INFO ] 10:57:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:57:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181315',true)]]--
[ERROR] 10:57:12 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 13:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:57:13 [com.work.main.BatchRealtime] - 201612181320
[INFO ] 10:57:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:57:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181320',true)]]--
[INFO ] 10:57:26 [com.work.main.BatchRealtime] - 201612181325
[INFO ] 10:57:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:57:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181325',true)]]--
[INFO ] 10:57:38 [com.work.main.BatchRealtime] - 201612181330
[INFO ] 10:57:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:57:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181330',true)]]--
[INFO ] 10:57:50 [com.work.main.BatchRealtime] - 201612181335
[INFO ] 10:57:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:57:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181335',true)]]--
[INFO ] 10:58:03 [com.work.main.BatchRealtime] - 201612181340
[INFO ] 10:58:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:58:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181340',true)]]--
[INFO ] 10:58:15 [com.work.main.BatchRealtime] - 201612181345
[INFO ] 10:58:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:58:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181345',true)]]--
[INFO ] 10:58:28 [com.work.main.BatchRealtime] - 201612181350
[INFO ] 10:58:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:58:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181350',true)]]--
[INFO ] 10:58:40 [com.work.main.BatchRealtime] - 201612181355
[INFO ] 10:58:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:58:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181355',true)]]--
[INFO ] 10:58:52 [com.work.main.BatchRealtime] - 201612181400
[INFO ] 10:58:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:58:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181400',true)]]--
[ERROR] 10:59:01 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 14:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 10:59:02 [com.work.main.BatchRealtime] - 201612181405
[INFO ] 10:59:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:59:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181405',true)]]--
[INFO ] 10:59:15 [com.work.main.BatchRealtime] - 201612181410
[INFO ] 10:59:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:59:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181410',true)]]--
[INFO ] 10:59:27 [com.work.main.BatchRealtime] - 201612181415
[INFO ] 10:59:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:59:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181415',true)]]--
[INFO ] 10:59:39 [com.work.main.BatchRealtime] - 201612181420
[INFO ] 10:59:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:59:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181420',true)]]--
[INFO ] 10:59:51 [com.work.main.BatchRealtime] - 201612181425
[INFO ] 10:59:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 10:59:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181425',true)]]--
[INFO ] 11:00:03 [com.work.main.BatchRealtime] - 201612181430
[INFO ] 11:00:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:00:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181430',true)]]--
[INFO ] 11:00:16 [com.work.main.BatchRealtime] - 201612181435
[INFO ] 11:00:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:00:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181435',true)]]--
[INFO ] 11:00:28 [com.work.main.BatchRealtime] - 201612181440
[INFO ] 11:00:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:00:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181440',true)]]--
[INFO ] 11:00:40 [com.work.main.BatchRealtime] - 201612181445
[INFO ] 11:00:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:00:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181445',true)]]--
[INFO ] 11:00:52 [com.work.main.BatchRealtime] - 201612181450
[INFO ] 11:00:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:00:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181450',true)]]--
[INFO ] 11:01:04 [com.work.main.BatchRealtime] - 201612181455
[INFO ] 11:01:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:01:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181455',true)]]--
[INFO ] 11:01:16 [com.work.main.BatchRealtime] - 201612181500
[INFO ] 11:01:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:01:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181500',true)]]--
[ERROR] 11:01:25 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 15:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 11:01:26 [com.work.main.BatchRealtime] - 201612181505
[INFO ] 11:01:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:01:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181505',true)]]--
[INFO ] 11:01:38 [com.work.main.BatchRealtime] - 201612181510
[INFO ] 11:01:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:01:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181510',true)]]--
[INFO ] 11:01:50 [com.work.main.BatchRealtime] - 201612181515
[INFO ] 11:01:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:01:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181515',true)]]--
[INFO ] 11:02:01 [com.work.main.BatchRealtime] - 201612181520
[INFO ] 11:02:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:02:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181520',true)]]--
[INFO ] 11:02:13 [com.work.main.BatchRealtime] - 201612181525
[INFO ] 11:02:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:02:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181525',true)]]--
[INFO ] 11:02:25 [com.work.main.BatchRealtime] - 201612181530
[INFO ] 11:02:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:02:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181530',true)]]--
[INFO ] 11:02:37 [com.work.main.BatchRealtime] - 201612181535
[INFO ] 11:02:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:02:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181535',true)]]--
[INFO ] 11:02:49 [com.work.main.BatchRealtime] - 201612181540
[INFO ] 11:02:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:02:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181540',true)]]--
[INFO ] 11:03:01 [com.work.main.BatchRealtime] - 201612181545
[INFO ] 11:03:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181545',true)]]--
[INFO ] 11:03:12 [com.work.main.BatchRealtime] - 201612181550
[INFO ] 11:03:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181550',true)]]--
[INFO ] 11:03:24 [com.work.main.BatchRealtime] - 201612181555
[INFO ] 11:03:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181555',true)]]--
[INFO ] 11:03:36 [com.work.main.BatchRealtime] - 201612181600
[INFO ] 11:03:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181600',true)]]--
[ERROR] 11:03:44 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 16:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 11:03:45 [com.work.main.BatchRealtime] - 201612181605
[INFO ] 11:03:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181605',true)]]--
[INFO ] 11:03:57 [com.work.main.BatchRealtime] - 201612181610
[INFO ] 11:03:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:03:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181610',true)]]--
[INFO ] 11:04:09 [com.work.main.BatchRealtime] - 201612181615
[INFO ] 11:04:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:04:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181615',true)]]--
[INFO ] 11:04:20 [com.work.main.BatchRealtime] - 201612181620
[INFO ] 11:04:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:04:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181620',true)]]--
[INFO ] 11:04:32 [com.work.main.BatchRealtime] - 201612181625
[INFO ] 11:04:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:04:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181625',true)]]--
[INFO ] 11:04:44 [com.work.main.BatchRealtime] - 201612181630
[INFO ] 11:04:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:04:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181630',true)]]--
[INFO ] 11:04:55 [com.work.main.BatchRealtime] - 201612181635
[INFO ] 11:04:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:04:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181635',true)]]--
[INFO ] 11:05:07 [com.work.main.BatchRealtime] - 201612181640
[INFO ] 11:05:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:05:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181640',true)]]--
[INFO ] 11:05:18 [com.work.main.BatchRealtime] - 201612181645
[INFO ] 11:05:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:05:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181645',true)]]--
[INFO ] 11:05:30 [com.work.main.BatchRealtime] - 201612181650
[INFO ] 11:05:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:05:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181650',true)]]--
[INFO ] 11:05:41 [com.work.main.BatchRealtime] - 201612181655
[INFO ] 11:05:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:05:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181655',true)]]--
[INFO ] 11:05:53 [com.work.main.BatchRealtime] - 201612181700
[INFO ] 11:05:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:05:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181700',true)]]--
[INFO ] 11:06:04 [com.work.main.BatchRealtime] - 201612181705
[INFO ] 11:06:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:06:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181705',true)]]--
[INFO ] 11:06:16 [com.work.main.BatchRealtime] - 201612181710
[INFO ] 11:06:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:06:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181710',true)]]--
[INFO ] 11:06:27 [com.work.main.BatchRealtime] - 201612181715
[INFO ] 11:06:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:06:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181715',true)]]--
[INFO ] 11:06:38 [com.work.main.BatchRealtime] - 201612181720
[INFO ] 11:06:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:06:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181720',true)]]--
[INFO ] 11:06:50 [com.work.main.BatchRealtime] - 201612181725
[INFO ] 11:06:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:06:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181725',true)]]--
[INFO ] 11:07:01 [com.work.main.BatchRealtime] - 201612181730
[INFO ] 11:07:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181730',true)]]--
[INFO ] 11:07:13 [com.work.main.BatchRealtime] - 201612181735
[INFO ] 11:07:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181735',true)]]--
[INFO ] 11:07:24 [com.work.main.BatchRealtime] - 201612181740
[INFO ] 11:07:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181740',true)]]--
[INFO ] 11:07:35 [com.work.main.BatchRealtime] - 201612181745
[INFO ] 11:07:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181745',true)]]--
[INFO ] 11:07:46 [com.work.main.BatchRealtime] - 201612181750
[INFO ] 11:07:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181750',true)]]--
[INFO ] 11:07:58 [com.work.main.BatchRealtime] - 201612181755
[INFO ] 11:07:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:07:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181755',true)]]--
[INFO ] 11:08:09 [com.work.main.BatchRealtime] - 201612181800
[INFO ] 11:08:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:08:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181800',true)]]--
[INFO ] 11:08:20 [com.work.main.BatchRealtime] - 201612181805
[INFO ] 11:08:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:08:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181805',true)]]--
[INFO ] 11:08:31 [com.work.main.BatchRealtime] - 201612181810
[INFO ] 11:08:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:08:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181810',true)]]--
[INFO ] 11:08:43 [com.work.main.BatchRealtime] - 201612181815
[INFO ] 11:08:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:08:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181815',true)]]--
[INFO ] 11:08:54 [com.work.main.BatchRealtime] - 201612181820
[INFO ] 11:08:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:08:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181820',true)]]--
[INFO ] 11:09:05 [com.work.main.BatchRealtime] - 201612181825
[INFO ] 11:09:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:09:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181825',true)]]--
[INFO ] 11:09:16 [com.work.main.BatchRealtime] - 201612181830
[INFO ] 11:09:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:09:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181830',true)]]--
[INFO ] 11:09:27 [com.work.main.BatchRealtime] - 201612181835
[INFO ] 11:09:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:09:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181835',true)]]--
[INFO ] 11:09:38 [com.work.main.BatchRealtime] - 201612181840
[INFO ] 11:09:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:09:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181840',true)]]--
[INFO ] 11:09:50 [com.work.main.BatchRealtime] - 201612181845
[INFO ] 11:09:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:09:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181845',true)]]--
[INFO ] 11:10:01 [com.work.main.BatchRealtime] - 201612181850
[INFO ] 11:10:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181850',true)]]--
[INFO ] 11:10:12 [com.work.main.BatchRealtime] - 201612181855
[INFO ] 11:10:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181855',true)]]--
[ERROR] 11:10:20 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 19:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 11:10:21 [com.work.main.BatchRealtime] - 201612181900
[INFO ] 11:10:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181900',true)]]--
[ERROR] 11:10:28 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-18 19:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 11:10:29 [com.work.main.BatchRealtime] - 201612181905
[INFO ] 11:10:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181905',true)]]--
[INFO ] 11:10:41 [com.work.main.BatchRealtime] - 201612181910
[INFO ] 11:10:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181910',true)]]--
[INFO ] 11:10:52 [com.work.main.BatchRealtime] - 201612181915
[INFO ] 11:10:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:10:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181915',true)]]--
[INFO ] 11:11:03 [com.work.main.BatchRealtime] - 201612181920
[INFO ] 11:11:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181920',true)]]--
[INFO ] 11:11:14 [com.work.main.BatchRealtime] - 201612181925
[INFO ] 11:11:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181925',true)]]--
[INFO ] 11:11:24 [com.work.main.BatchRealtime] - 201612181930
[INFO ] 11:11:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181930',true)]]--
[INFO ] 11:11:35 [com.work.main.BatchRealtime] - 201612181935
[INFO ] 11:11:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181935',true)]]--
[INFO ] 11:11:46 [com.work.main.BatchRealtime] - 201612181940
[INFO ] 11:11:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181940',true)]]--
[INFO ] 11:11:57 [com.work.main.BatchRealtime] - 201612181945
[INFO ] 11:11:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:11:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181945',true)]]--
[INFO ] 11:12:08 [com.work.main.BatchRealtime] - 201612181950
[INFO ] 11:12:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:12:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181950',true)]]--
[INFO ] 11:12:19 [com.work.main.BatchRealtime] - 201612181955
[INFO ] 11:12:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:12:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612181955',true)]]--
[INFO ] 11:12:30 [com.work.main.BatchRealtime] - 201612182000
[INFO ] 11:12:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:12:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182000',true)]]--
[INFO ] 11:12:41 [com.work.main.BatchRealtime] - 201612182005
[INFO ] 11:12:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:12:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182005',true)]]--
[INFO ] 11:12:51 [com.work.main.BatchRealtime] - 201612182010
[INFO ] 11:12:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:12:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182010',true)]]--
[INFO ] 11:13:02 [com.work.main.BatchRealtime] - 201612182015
[INFO ] 11:13:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182015',true)]]--
[INFO ] 11:13:13 [com.work.main.BatchRealtime] - 201612182020
[INFO ] 11:13:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182020',true)]]--
[INFO ] 11:13:24 [com.work.main.BatchRealtime] - 201612182025
[INFO ] 11:13:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182025',true)]]--
[INFO ] 11:13:34 [com.work.main.BatchRealtime] - 201612182030
[INFO ] 11:13:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182030',true)]]--
[INFO ] 11:13:45 [com.work.main.BatchRealtime] - 201612182035
[INFO ] 11:13:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182035',true)]]--
[INFO ] 11:13:56 [com.work.main.BatchRealtime] - 201612182040
[INFO ] 11:13:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:13:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182040',true)]]--
[INFO ] 11:14:06 [com.work.main.BatchRealtime] - 201612182045
[INFO ] 11:14:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182045',true)]]--
[INFO ] 11:14:17 [com.work.main.BatchRealtime] - 201612182050
[INFO ] 11:14:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182050',true)]]--
[INFO ] 11:14:28 [com.work.main.BatchRealtime] - 201612182055
[INFO ] 11:14:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182055',true)]]--
[INFO ] 11:14:38 [com.work.main.BatchRealtime] - 201612182100
[INFO ] 11:14:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182100',true)]]--
[INFO ] 11:14:49 [com.work.main.BatchRealtime] - 201612182105
[INFO ] 11:14:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182105',true)]]--
[INFO ] 11:14:59 [com.work.main.BatchRealtime] - 201612182110
[INFO ] 11:14:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:14:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182110',true)]]--
[INFO ] 11:15:10 [com.work.main.BatchRealtime] - 201612182115
[INFO ] 11:15:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:15:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182115',true)]]--
[INFO ] 11:15:20 [com.work.main.BatchRealtime] - 201612182120
[INFO ] 11:15:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:15:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182120',true)]]--
[INFO ] 11:15:31 [com.work.main.BatchRealtime] - 201612182125
[INFO ] 11:15:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:15:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182125',true)]]--
[INFO ] 11:15:41 [com.work.main.BatchRealtime] - 201612182130
[INFO ] 11:15:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:15:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182130',true)]]--
[INFO ] 11:15:52 [com.work.main.BatchRealtime] - 201612182135
[INFO ] 11:15:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:15:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182135',true)]]--
[INFO ] 11:16:02 [com.work.main.BatchRealtime] - 201612182140
[INFO ] 11:16:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182140',true)]]--
[INFO ] 11:16:13 [com.work.main.BatchRealtime] - 201612182145
[INFO ] 11:16:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182145',true)]]--
[INFO ] 11:16:23 [com.work.main.BatchRealtime] - 201612182150
[INFO ] 11:16:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182150',true)]]--
[INFO ] 11:16:34 [com.work.main.BatchRealtime] - 201612182155
[INFO ] 11:16:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182155',true)]]--
[INFO ] 11:16:44 [com.work.main.BatchRealtime] - 201612182200
[INFO ] 11:16:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182200',true)]]--
[INFO ] 11:16:54 [com.work.main.BatchRealtime] - 201612182205
[INFO ] 11:16:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:16:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182205',true)]]--
[INFO ] 11:17:05 [com.work.main.BatchRealtime] - 201612182210
[INFO ] 11:17:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182210',true)]]--
[INFO ] 11:17:15 [com.work.main.BatchRealtime] - 201612182215
[INFO ] 11:17:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182215',true)]]--
[INFO ] 11:17:25 [com.work.main.BatchRealtime] - 201612182220
[INFO ] 11:17:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182220',true)]]--
[INFO ] 11:17:36 [com.work.main.BatchRealtime] - 201612182225
[INFO ] 11:17:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182225',true)]]--
[INFO ] 11:17:46 [com.work.main.BatchRealtime] - 201612182230
[INFO ] 11:17:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182230',true)]]--
[INFO ] 11:17:56 [com.work.main.BatchRealtime] - 201612182235
[INFO ] 11:17:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:17:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182235',true)]]--
[INFO ] 11:18:07 [com.work.main.BatchRealtime] - 201612182240
[INFO ] 11:18:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182240',true)]]--
[INFO ] 11:18:17 [com.work.main.BatchRealtime] - 201612182245
[INFO ] 11:18:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182245',true)]]--
[INFO ] 11:18:27 [com.work.main.BatchRealtime] - 201612182250
[INFO ] 11:18:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182250',true)]]--
[INFO ] 11:18:38 [com.work.main.BatchRealtime] - 201612182255
[INFO ] 11:18:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182255',true)]]--
[INFO ] 11:18:48 [com.work.main.BatchRealtime] - 201612182300
[INFO ] 11:18:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182300',true)]]--
[INFO ] 11:18:58 [com.work.main.BatchRealtime] - 201612182305
[INFO ] 11:18:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:18:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182305',true)]]--
[INFO ] 11:19:08 [com.work.main.BatchRealtime] - 201612182310
[INFO ] 11:19:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:19:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182310',true)]]--
[INFO ] 11:19:19 [com.work.main.BatchRealtime] - 201612182315
[INFO ] 11:19:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:19:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182315',true)]]--
[INFO ] 11:19:29 [com.work.main.BatchRealtime] - 201612182320
[INFO ] 11:19:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:19:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182320',true)]]--
[INFO ] 11:19:39 [com.work.main.BatchRealtime] - 201612182325
[INFO ] 11:19:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:19:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182325',true)]]--
[INFO ] 11:19:49 [com.work.main.BatchRealtime] - 201612182330
[INFO ] 11:19:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:19:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182330',true)]]--
[INFO ] 11:20:00 [com.work.main.BatchRealtime] - 201612182335
[INFO ] 11:20:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:20:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182335',true)]]--
[INFO ] 11:20:10 [com.work.main.BatchRealtime] - 201612182340
[INFO ] 11:20:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:20:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182340',true)]]--
[INFO ] 11:20:20 [com.work.main.BatchRealtime] - 201612182345
[INFO ] 11:20:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:20:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182345',true)]]--
[INFO ] 11:20:30 [com.work.main.BatchRealtime] - 201612182350
[INFO ] 11:20:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:20:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182350',true)]]--
[INFO ] 11:20:40 [com.work.main.BatchRealtime] - 201612182355
[INFO ] 11:20:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:20:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612182355',true)]]--
[INFO ] 11:27:53 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 11:27:53 [com.work.main.BatchRealtime] - 201612170000
[INFO ] 11:27:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:27:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170000',true)]]--
[ERROR] 11:28:08 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-17 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 11:28:09 [com.work.main.BatchRealtime] - 201612170005
[INFO ] 11:28:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:28:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170005',true)]]--
[INFO ] 11:28:24 [com.work.main.BatchRealtime] - 201612170010
[INFO ] 11:28:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:28:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170010',true)]]--
[INFO ] 11:28:39 [com.work.main.BatchRealtime] - 201612170015
[INFO ] 11:28:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:28:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170015',true)]]--
[INFO ] 11:28:53 [com.work.main.BatchRealtime] - 201612170020
[INFO ] 11:28:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:28:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170020',true)]]--
[INFO ] 11:29:08 [com.work.main.BatchRealtime] - 201612170025
[INFO ] 11:29:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:29:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170025',true)]]--
[INFO ] 11:29:22 [com.work.main.BatchRealtime] - 201612170030
[INFO ] 11:29:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:29:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170030',true)]]--
[INFO ] 11:29:37 [com.work.main.BatchRealtime] - 201612170035
[INFO ] 11:29:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:29:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170035',true)]]--
[INFO ] 11:29:51 [com.work.main.BatchRealtime] - 201612170040
[INFO ] 11:29:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:29:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170040',true)]]--
[INFO ] 11:30:05 [com.work.main.BatchRealtime] - 201612170045
[INFO ] 11:30:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:30:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170045',true)]]--
[INFO ] 11:30:20 [com.work.main.BatchRealtime] - 201612170050
[INFO ] 11:30:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:30:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170050',true)]]--
[INFO ] 11:30:34 [com.work.main.BatchRealtime] - 201612170055
[INFO ] 11:30:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:30:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170055',true)]]--
[INFO ] 11:30:49 [com.work.main.BatchRealtime] - 201612170100
[INFO ] 11:30:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:30:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170100',true)]]--
[INFO ] 11:31:03 [com.work.main.BatchRealtime] - 201612170105
[INFO ] 11:31:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:31:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170105',true)]]--
[INFO ] 11:31:18 [com.work.main.BatchRealtime] - 201612170110
[INFO ] 11:31:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:31:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170110',true)]]--
[INFO ] 11:31:32 [com.work.main.BatchRealtime] - 201612170115
[INFO ] 11:31:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:31:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170115',true)]]--
[INFO ] 11:31:46 [com.work.main.BatchRealtime] - 201612170120
[INFO ] 11:31:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:31:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170120',true)]]--
[INFO ] 11:32:01 [com.work.main.BatchRealtime] - 201612170125
[INFO ] 11:32:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:32:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170125',true)]]--
[INFO ] 11:32:15 [com.work.main.BatchRealtime] - 201612170130
[INFO ] 11:32:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:32:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170130',true)]]--
[INFO ] 11:32:29 [com.work.main.BatchRealtime] - 201612170135
[INFO ] 11:32:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:32:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170135',true)]]--
[INFO ] 11:32:44 [com.work.main.BatchRealtime] - 201612170140
[INFO ] 11:32:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:32:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170140',true)]]--
[INFO ] 11:32:58 [com.work.main.BatchRealtime] - 201612170145
[INFO ] 11:32:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:32:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170145',true)]]--
[INFO ] 11:33:13 [com.work.main.BatchRealtime] - 201612170150
[INFO ] 11:33:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:33:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170150',true)]]--
[INFO ] 11:33:27 [com.work.main.BatchRealtime] - 201612170155
[INFO ] 11:33:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:33:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170155',true)]]--
[INFO ] 11:33:41 [com.work.main.BatchRealtime] - 201612170200
[INFO ] 11:33:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:33:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170200',true)]]--
[INFO ] 11:33:56 [com.work.main.BatchRealtime] - 201612170205
[INFO ] 11:33:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:33:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170205',true)]]--
[INFO ] 11:34:10 [com.work.main.BatchRealtime] - 201612170210
[INFO ] 11:34:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:34:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170210',true)]]--
[INFO ] 11:34:25 [com.work.main.BatchRealtime] - 201612170215
[INFO ] 11:34:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:34:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170215',true)]]--
[INFO ] 11:34:39 [com.work.main.BatchRealtime] - 201612170220
[INFO ] 11:34:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:34:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170220',true)]]--
[INFO ] 11:34:53 [com.work.main.BatchRealtime] - 201612170225
[INFO ] 11:34:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:34:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170225',true)]]--
[INFO ] 11:35:08 [com.work.main.BatchRealtime] - 201612170230
[INFO ] 11:35:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:35:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170230',true)]]--
[INFO ] 11:35:22 [com.work.main.BatchRealtime] - 201612170235
[INFO ] 11:35:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:35:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170235',true)]]--
[INFO ] 11:35:36 [com.work.main.BatchRealtime] - 201612170240
[INFO ] 11:35:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:35:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170240',true)]]--
[INFO ] 11:35:50 [com.work.main.BatchRealtime] - 201612170245
[INFO ] 11:35:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:35:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170245',true)]]--
[INFO ] 11:36:05 [com.work.main.BatchRealtime] - 201612170250
[INFO ] 11:36:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:36:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170250',true)]]--
[INFO ] 11:36:19 [com.work.main.BatchRealtime] - 201612170255
[INFO ] 11:36:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:36:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170255',true)]]--
[INFO ] 11:36:33 [com.work.main.BatchRealtime] - 201612170300
[INFO ] 11:36:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:36:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170300',true)]]--
[INFO ] 11:36:48 [com.work.main.BatchRealtime] - 201612170305
[INFO ] 11:36:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:36:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170305',true)]]--
[INFO ] 11:37:02 [com.work.main.BatchRealtime] - 201612170310
[INFO ] 11:37:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:37:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170310',true)]]--
[INFO ] 11:37:17 [com.work.main.BatchRealtime] - 201612170315
[INFO ] 11:37:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:37:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170315',true)]]--
[INFO ] 11:37:31 [com.work.main.BatchRealtime] - 201612170320
[INFO ] 11:37:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:37:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170320',true)]]--
[INFO ] 11:37:45 [com.work.main.BatchRealtime] - 201612170325
[INFO ] 11:37:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:37:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170325',true)]]--
[INFO ] 11:37:59 [com.work.main.BatchRealtime] - 201612170330
[INFO ] 11:37:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:37:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170330',true)]]--
[INFO ] 11:38:14 [com.work.main.BatchRealtime] - 201612170335
[INFO ] 11:38:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:38:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170335',true)]]--
[INFO ] 11:38:28 [com.work.main.BatchRealtime] - 201612170340
[INFO ] 11:38:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:38:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170340',true)]]--
[INFO ] 11:38:42 [com.work.main.BatchRealtime] - 201612170345
[INFO ] 11:38:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:38:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170345',true)]]--
[INFO ] 11:38:56 [com.work.main.BatchRealtime] - 201612170350
[INFO ] 11:38:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:38:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170350',true)]]--
[INFO ] 11:39:11 [com.work.main.BatchRealtime] - 201612170355
[INFO ] 11:39:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:39:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170355',true)]]--
[INFO ] 11:39:25 [com.work.main.BatchRealtime] - 201612170400
[INFO ] 11:39:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:39:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170400',true)]]--
[INFO ] 11:39:39 [com.work.main.BatchRealtime] - 201612170405
[INFO ] 11:39:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:39:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170405',true)]]--
[INFO ] 11:39:54 [com.work.main.BatchRealtime] - 201612170410
[INFO ] 11:39:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:39:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170410',true)]]--
[INFO ] 11:40:08 [com.work.main.BatchRealtime] - 201612170415
[INFO ] 11:40:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:40:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170415',true)]]--
[INFO ] 11:40:22 [com.work.main.BatchRealtime] - 201612170420
[INFO ] 11:40:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:40:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170420',true)]]--
[INFO ] 11:40:36 [com.work.main.BatchRealtime] - 201612170425
[INFO ] 11:40:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:40:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170425',true)]]--
[INFO ] 11:40:50 [com.work.main.BatchRealtime] - 201612170430
[INFO ] 11:40:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:40:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170430',true)]]--
[INFO ] 11:41:05 [com.work.main.BatchRealtime] - 201612170435
[INFO ] 11:41:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:41:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170435',true)]]--
[INFO ] 11:41:19 [com.work.main.BatchRealtime] - 201612170440
[INFO ] 11:41:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:41:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170440',true)]]--
[INFO ] 11:41:33 [com.work.main.BatchRealtime] - 201612170445
[INFO ] 11:41:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:41:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170445',true)]]--
[INFO ] 11:41:47 [com.work.main.BatchRealtime] - 201612170450
[INFO ] 11:41:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:41:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170450',true)]]--
[INFO ] 11:42:02 [com.work.main.BatchRealtime] - 201612170455
[INFO ] 11:42:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:42:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170455',true)]]--
[INFO ] 11:42:16 [com.work.main.BatchRealtime] - 201612170500
[INFO ] 11:42:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:42:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170500',true)]]--
[INFO ] 11:42:30 [com.work.main.BatchRealtime] - 201612170505
[INFO ] 11:42:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:42:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170505',true)]]--
[INFO ] 11:42:44 [com.work.main.BatchRealtime] - 201612170510
[INFO ] 11:42:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:42:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170510',true)]]--
[INFO ] 11:42:59 [com.work.main.BatchRealtime] - 201612170515
[INFO ] 11:42:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:42:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170515',true)]]--
[INFO ] 11:43:13 [com.work.main.BatchRealtime] - 201612170520
[INFO ] 11:43:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:43:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170520',true)]]--
[INFO ] 11:43:27 [com.work.main.BatchRealtime] - 201612170525
[INFO ] 11:43:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:43:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170525',true)]]--
[INFO ] 11:43:41 [com.work.main.BatchRealtime] - 201612170530
[INFO ] 11:43:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:43:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170530',true)]]--
[INFO ] 11:43:55 [com.work.main.BatchRealtime] - 201612170535
[INFO ] 11:43:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:43:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170535',true)]]--
[INFO ] 11:47:08 [com.work.main.BatchRealtime] - 201612170540
[INFO ] 11:47:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:47:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170540',true)]]--
[INFO ] 11:47:22 [com.work.main.BatchRealtime] - 201612170545
[INFO ] 11:47:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:47:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170545',true)]]--
[INFO ] 11:47:37 [com.work.main.BatchRealtime] - 201612170550
[INFO ] 11:47:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:47:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170550',true)]]--
[INFO ] 11:47:51 [com.work.main.BatchRealtime] - 201612170555
[INFO ] 11:47:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:47:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170555',true)]]--
[INFO ] 11:48:05 [com.work.main.BatchRealtime] - 201612170600
[INFO ] 11:48:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:48:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170600',true)]]--
[INFO ] 11:48:19 [com.work.main.BatchRealtime] - 201612170605
[INFO ] 11:48:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:48:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170605',true)]]--
[INFO ] 11:48:34 [com.work.main.BatchRealtime] - 201612170610
[INFO ] 11:48:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:48:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170610',true)]]--
[INFO ] 11:48:48 [com.work.main.BatchRealtime] - 201612170615
[INFO ] 11:48:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:48:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170615',true)]]--
[INFO ] 11:49:02 [com.work.main.BatchRealtime] - 201612170620
[INFO ] 11:49:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:49:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170620',true)]]--
[INFO ] 11:49:16 [com.work.main.BatchRealtime] - 201612170625
[INFO ] 11:49:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:49:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170625',true)]]--
[INFO ] 11:49:30 [com.work.main.BatchRealtime] - 201612170630
[INFO ] 11:49:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:49:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170630',true)]]--
[INFO ] 11:49:44 [com.work.main.BatchRealtime] - 201612170635
[INFO ] 11:49:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:49:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170635',true)]]--
[INFO ] 11:49:58 [com.work.main.BatchRealtime] - 201612170640
[INFO ] 11:49:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:49:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170640',true)]]--
[INFO ] 11:50:12 [com.work.main.BatchRealtime] - 201612170645
[INFO ] 11:50:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:50:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170645',true)]]--
[INFO ] 11:51:25 [com.work.main.BatchRealtime] - 201612170650
[INFO ] 11:51:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:51:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170650',true)]]--
[INFO ] 11:51:39 [com.work.main.BatchRealtime] - 201612170655
[INFO ] 11:51:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:51:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170655',true)]]--
[INFO ] 11:51:54 [com.work.main.BatchRealtime] - 201612170700
[INFO ] 11:51:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:51:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170700',true)]]--
[INFO ] 11:52:08 [com.work.main.BatchRealtime] - 201612170705
[INFO ] 11:52:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:52:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170705',true)]]--
[INFO ] 11:52:22 [com.work.main.BatchRealtime] - 201612170710
[INFO ] 11:52:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:52:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170710',true)]]--
[INFO ] 11:52:36 [com.work.main.BatchRealtime] - 201612170715
[INFO ] 11:52:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:52:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170715',true)]]--
[INFO ] 11:52:50 [com.work.main.BatchRealtime] - 201612170720
[INFO ] 11:52:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:52:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170720',true)]]--
[INFO ] 11:53:04 [com.work.main.BatchRealtime] - 201612170725
[INFO ] 11:53:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:53:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170725',true)]]--
[INFO ] 11:53:19 [com.work.main.BatchRealtime] - 201612170730
[INFO ] 11:53:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:53:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170730',true)]]--
[INFO ] 11:53:33 [com.work.main.BatchRealtime] - 201612170735
[INFO ] 11:53:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:53:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170735',true)]]--
[INFO ] 11:53:47 [com.work.main.BatchRealtime] - 201612170740
[INFO ] 11:53:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:53:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170740',true)]]--
[INFO ] 11:54:01 [com.work.main.BatchRealtime] - 201612170745
[INFO ] 11:54:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:54:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170745',true)]]--
[INFO ] 11:54:15 [com.work.main.BatchRealtime] - 201612170750
[INFO ] 11:54:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:54:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170750',true)]]--
[INFO ] 11:54:29 [com.work.main.BatchRealtime] - 201612170755
[INFO ] 11:54:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:54:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170755',true)]]--
[INFO ] 11:54:43 [com.work.main.BatchRealtime] - 201612170800
[INFO ] 11:54:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:54:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170800',true)]]--
[INFO ] 11:54:58 [com.work.main.BatchRealtime] - 201612170805
[INFO ] 11:54:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:54:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170805',true)]]--
[INFO ] 11:55:12 [com.work.main.BatchRealtime] - 201612170810
[INFO ] 11:55:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:55:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170810',true)]]--
[INFO ] 11:55:26 [com.work.main.BatchRealtime] - 201612170815
[INFO ] 11:55:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:55:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170815',true)]]--
[INFO ] 11:55:40 [com.work.main.BatchRealtime] - 201612170820
[INFO ] 11:55:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:55:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170820',true)]]--
[INFO ] 11:55:54 [com.work.main.BatchRealtime] - 201612170825
[INFO ] 11:55:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:55:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170825',true)]]--
[INFO ] 11:56:09 [com.work.main.BatchRealtime] - 201612170830
[INFO ] 11:56:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:56:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170830',true)]]--
[INFO ] 11:56:22 [com.work.main.BatchRealtime] - 201612170835
[INFO ] 11:56:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:56:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170835',true)]]--
[INFO ] 11:56:36 [com.work.main.BatchRealtime] - 201612170840
[INFO ] 11:56:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:56:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170840',true)]]--
[INFO ] 11:56:50 [com.work.main.BatchRealtime] - 201612170845
[INFO ] 11:56:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:56:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170845',true)]]--
[INFO ] 11:57:04 [com.work.main.BatchRealtime] - 201612170850
[INFO ] 11:57:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:57:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170850',true)]]--
[INFO ] 11:57:18 [com.work.main.BatchRealtime] - 201612170855
[INFO ] 11:57:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:57:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170855',true)]]--
[INFO ] 11:57:32 [com.work.main.BatchRealtime] - 201612170900
[INFO ] 11:57:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:57:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170900',true)]]--
[INFO ] 11:57:46 [com.work.main.BatchRealtime] - 201612170905
[INFO ] 11:57:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:57:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170905',true)]]--
[INFO ] 11:58:00 [com.work.main.BatchRealtime] - 201612170910
[INFO ] 11:58:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:58:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170910',true)]]--
[INFO ] 11:58:14 [com.work.main.BatchRealtime] - 201612170915
[INFO ] 11:58:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:58:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170915',true)]]--
[INFO ] 11:58:28 [com.work.main.BatchRealtime] - 201612170920
[INFO ] 11:58:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:58:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170920',true)]]--
[INFO ] 11:58:42 [com.work.main.BatchRealtime] - 201612170925
[INFO ] 11:58:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:58:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170925',true)]]--
[INFO ] 11:58:56 [com.work.main.BatchRealtime] - 201612170930
[INFO ] 11:58:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:58:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170930',true)]]--
[INFO ] 11:59:09 [com.work.main.BatchRealtime] - 201612170935
[INFO ] 11:59:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:59:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170935',true)]]--
[INFO ] 11:59:23 [com.work.main.BatchRealtime] - 201612170940
[INFO ] 11:59:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:59:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170940',true)]]--
[INFO ] 11:59:37 [com.work.main.BatchRealtime] - 201612170945
[INFO ] 11:59:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:59:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170945',true)]]--
[INFO ] 11:59:51 [com.work.main.BatchRealtime] - 201612170950
[INFO ] 11:59:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 11:59:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170950',true)]]--
[INFO ] 12:00:04 [com.work.main.BatchRealtime] - 201612170955
[INFO ] 12:00:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:00:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612170955',true)]]--
[INFO ] 12:00:18 [com.work.main.BatchRealtime] - 201612171000
[INFO ] 12:00:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:00:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171000',true)]]--
[INFO ] 12:00:32 [com.work.main.BatchRealtime] - 201612171005
[INFO ] 12:00:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:00:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171005',true)]]--
[INFO ] 12:00:46 [com.work.main.BatchRealtime] - 201612171010
[INFO ] 12:00:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:00:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171010',true)]]--
[INFO ] 12:00:59 [com.work.main.BatchRealtime] - 201612171015
[INFO ] 12:00:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:00:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171015',true)]]--
[INFO ] 12:01:13 [com.work.main.BatchRealtime] - 201612171020
[INFO ] 12:01:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:01:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171020',true)]]--
[INFO ] 12:01:26 [com.work.main.BatchRealtime] - 201612171025
[INFO ] 12:01:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:01:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171025',true)]]--
[INFO ] 12:01:40 [com.work.main.BatchRealtime] - 201612171030
[INFO ] 12:01:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:01:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171030',true)]]--
[INFO ] 12:01:53 [com.work.main.BatchRealtime] - 201612171035
[INFO ] 12:01:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:01:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171035',true)]]--
[INFO ] 12:02:07 [com.work.main.BatchRealtime] - 201612171040
[INFO ] 12:02:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:02:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171040',true)]]--
[INFO ] 12:02:20 [com.work.main.BatchRealtime] - 201612171045
[INFO ] 12:02:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:02:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171045',true)]]--
[INFO ] 12:02:34 [com.work.main.BatchRealtime] - 201612171050
[INFO ] 12:02:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:02:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171050',true)]]--
[INFO ] 12:02:47 [com.work.main.BatchRealtime] - 201612171055
[INFO ] 12:02:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:02:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171055',true)]]--
[INFO ] 12:03:01 [com.work.main.BatchRealtime] - 201612171100
[INFO ] 12:03:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:03:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171100',true)]]--
[INFO ] 12:03:14 [com.work.main.BatchRealtime] - 201612171105
[INFO ] 12:03:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:03:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171105',true)]]--
[INFO ] 12:03:27 [com.work.main.BatchRealtime] - 201612171110
[INFO ] 12:03:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:03:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171110',true)]]--
[INFO ] 12:03:41 [com.work.main.BatchRealtime] - 201612171115
[INFO ] 12:03:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:03:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171115',true)]]--
[INFO ] 12:03:54 [com.work.main.BatchRealtime] - 201612171120
[INFO ] 12:03:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:03:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171120',true)]]--
[INFO ] 12:04:07 [com.work.main.BatchRealtime] - 201612171125
[INFO ] 12:04:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:04:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171125',true)]]--
[INFO ] 12:04:20 [com.work.main.BatchRealtime] - 201612171130
[INFO ] 12:04:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:04:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171130',true)]]--
[INFO ] 12:04:34 [com.work.main.BatchRealtime] - 201612171135
[INFO ] 12:04:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:04:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171135',true)]]--
[INFO ] 12:04:47 [com.work.main.BatchRealtime] - 201612171140
[INFO ] 12:04:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:04:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171140',true)]]--
[INFO ] 12:05:00 [com.work.main.BatchRealtime] - 201612171145
[INFO ] 12:05:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:05:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171145',true)]]--
[INFO ] 12:05:13 [com.work.main.BatchRealtime] - 201612171150
[INFO ] 12:05:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:05:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171150',true)]]--
[INFO ] 12:05:26 [com.work.main.BatchRealtime] - 201612171155
[INFO ] 12:05:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:05:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171155',true)]]--
[INFO ] 12:05:39 [com.work.main.BatchRealtime] - 201612171200
[INFO ] 12:05:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:05:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171200',true)]]--
[INFO ] 12:05:53 [com.work.main.BatchRealtime] - 201612171205
[INFO ] 12:05:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:05:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171205',true)]]--
[INFO ] 12:06:06 [com.work.main.BatchRealtime] - 201612171210
[INFO ] 12:06:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:06:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171210',true)]]--
[INFO ] 12:06:19 [com.work.main.BatchRealtime] - 201612171215
[INFO ] 12:06:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:06:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171215',true)]]--
[INFO ] 12:06:32 [com.work.main.BatchRealtime] - 201612171220
[INFO ] 12:06:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:06:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171220',true)]]--
[INFO ] 12:06:45 [com.work.main.BatchRealtime] - 201612171225
[INFO ] 12:06:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:06:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171225',true)]]--
[INFO ] 12:06:57 [com.work.main.BatchRealtime] - 201612171230
[INFO ] 12:06:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:06:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171230',true)]]--
[INFO ] 12:07:10 [com.work.main.BatchRealtime] - 201612171235
[INFO ] 12:07:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:07:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171235',true)]]--
[INFO ] 12:07:23 [com.work.main.BatchRealtime] - 201612171240
[INFO ] 12:07:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:07:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171240',true)]]--
[INFO ] 12:07:36 [com.work.main.BatchRealtime] - 201612171245
[INFO ] 12:07:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:07:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171245',true)]]--
[INFO ] 12:07:49 [com.work.main.BatchRealtime] - 201612171250
[INFO ] 12:07:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:07:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171250',true)]]--
[INFO ] 12:08:02 [com.work.main.BatchRealtime] - 201612171255
[INFO ] 12:08:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:08:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171255',true)]]--
[INFO ] 12:08:15 [com.work.main.BatchRealtime] - 201612171300
[INFO ] 12:08:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:08:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171300',true)]]--
[INFO ] 12:08:27 [com.work.main.BatchRealtime] - 201612171305
[INFO ] 12:08:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:08:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171305',true)]]--
[INFO ] 12:08:40 [com.work.main.BatchRealtime] - 201612171310
[INFO ] 12:08:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:08:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171310',true)]]--
[INFO ] 12:08:53 [com.work.main.BatchRealtime] - 201612171315
[INFO ] 12:08:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:08:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171315',true)]]--
[INFO ] 12:09:06 [com.work.main.BatchRealtime] - 201612171320
[INFO ] 12:09:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:09:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171320',true)]]--
[INFO ] 12:09:18 [com.work.main.BatchRealtime] - 201612171325
[INFO ] 12:09:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:09:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171325',true)]]--
[INFO ] 12:09:31 [com.work.main.BatchRealtime] - 201612171330
[INFO ] 12:09:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:09:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171330',true)]]--
[INFO ] 12:09:43 [com.work.main.BatchRealtime] - 201612171335
[INFO ] 12:09:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:09:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171335',true)]]--
[INFO ] 12:09:56 [com.work.main.BatchRealtime] - 201612171340
[INFO ] 12:09:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:09:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171340',true)]]--
[INFO ] 12:10:08 [com.work.main.BatchRealtime] - 201612171345
[INFO ] 12:10:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:10:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171345',true)]]--
[INFO ] 12:10:21 [com.work.main.BatchRealtime] - 201612171350
[INFO ] 12:10:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:10:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171350',true)]]--
[INFO ] 12:10:33 [com.work.main.BatchRealtime] - 201612171355
[INFO ] 12:10:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:10:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171355',true)]]--
[INFO ] 12:10:46 [com.work.main.BatchRealtime] - 201612171400
[INFO ] 12:10:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:10:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171400',true)]]--
[INFO ] 12:10:58 [com.work.main.BatchRealtime] - 201612171405
[INFO ] 12:10:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:10:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171405',true)]]--
[INFO ] 12:11:11 [com.work.main.BatchRealtime] - 201612171410
[INFO ] 12:11:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:11:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171410',true)]]--
[INFO ] 12:11:23 [com.work.main.BatchRealtime] - 201612171415
[INFO ] 12:11:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:11:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171415',true)]]--
[INFO ] 12:11:35 [com.work.main.BatchRealtime] - 201612171420
[INFO ] 12:11:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:11:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171420',true)]]--
[INFO ] 12:11:48 [com.work.main.BatchRealtime] - 201612171425
[INFO ] 12:11:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:11:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171425',true)]]--
[INFO ] 12:12:00 [com.work.main.BatchRealtime] - 201612171430
[INFO ] 12:12:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:12:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171430',true)]]--
[INFO ] 12:12:12 [com.work.main.BatchRealtime] - 201612171435
[INFO ] 12:12:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:12:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171435',true)]]--
[INFO ] 12:12:24 [com.work.main.BatchRealtime] - 201612171440
[INFO ] 12:12:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:12:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171440',true)]]--
[INFO ] 12:12:37 [com.work.main.BatchRealtime] - 201612171445
[INFO ] 12:12:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:12:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171445',true)]]--
[INFO ] 12:12:49 [com.work.main.BatchRealtime] - 201612171450
[INFO ] 12:12:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:12:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171450',true)]]--
[INFO ] 12:13:01 [com.work.main.BatchRealtime] - 201612171455
[INFO ] 12:13:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:13:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171455',true)]]--
[INFO ] 12:13:13 [com.work.main.BatchRealtime] - 201612171500
[INFO ] 12:13:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:13:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171500',true)]]--
[INFO ] 12:13:25 [com.work.main.BatchRealtime] - 201612171505
[INFO ] 12:13:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:13:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171505',true)]]--
[INFO ] 12:13:38 [com.work.main.BatchRealtime] - 201612171510
[INFO ] 12:13:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:13:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171510',true)]]--
[INFO ] 12:13:50 [com.work.main.BatchRealtime] - 201612171515
[INFO ] 12:13:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:13:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171515',true)]]--
[INFO ] 12:14:02 [com.work.main.BatchRealtime] - 201612171520
[INFO ] 12:14:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:14:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171520',true)]]--
[INFO ] 12:14:14 [com.work.main.BatchRealtime] - 201612171525
[INFO ] 12:14:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:14:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171525',true)]]--
[INFO ] 12:14:26 [com.work.main.BatchRealtime] - 201612171530
[INFO ] 12:14:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:14:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171530',true)]]--
[INFO ] 12:14:38 [com.work.main.BatchRealtime] - 201612171535
[INFO ] 12:14:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:14:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171535',true)]]--
[INFO ] 12:14:50 [com.work.main.BatchRealtime] - 201612171540
[INFO ] 12:14:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:14:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171540',true)]]--
[INFO ] 12:15:01 [com.work.main.BatchRealtime] - 201612171545
[INFO ] 12:15:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:15:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171545',true)]]--
[INFO ] 12:15:13 [com.work.main.BatchRealtime] - 201612171550
[INFO ] 12:15:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:15:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171550',true)]]--
[INFO ] 12:15:25 [com.work.main.BatchRealtime] - 201612171555
[INFO ] 12:15:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:15:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171555',true)]]--
[INFO ] 12:15:37 [com.work.main.BatchRealtime] - 201612171600
[INFO ] 12:15:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:15:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171600',true)]]--
[INFO ] 12:15:49 [com.work.main.BatchRealtime] - 201612171605
[INFO ] 12:15:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:15:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171605',true)]]--
[INFO ] 12:16:01 [com.work.main.BatchRealtime] - 201612171610
[INFO ] 12:16:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171610',true)]]--
[INFO ] 12:16:13 [com.work.main.BatchRealtime] - 201612171615
[INFO ] 12:16:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171615',true)]]--
[INFO ] 12:16:24 [com.work.main.BatchRealtime] - 201612171620
[INFO ] 12:16:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171620',true)]]--
[INFO ] 12:16:36 [com.work.main.BatchRealtime] - 201612171625
[INFO ] 12:16:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171625',true)]]--
[INFO ] 12:16:48 [com.work.main.BatchRealtime] - 201612171630
[INFO ] 12:16:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171630',true)]]--
[INFO ] 12:16:59 [com.work.main.BatchRealtime] - 201612171635
[INFO ] 12:16:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:16:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171635',true)]]--
[INFO ] 12:17:11 [com.work.main.BatchRealtime] - 201612171640
[INFO ] 12:17:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:17:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171640',true)]]--
[INFO ] 12:17:23 [com.work.main.BatchRealtime] - 201612171645
[INFO ] 12:17:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:17:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171645',true)]]--
[INFO ] 12:17:34 [com.work.main.BatchRealtime] - 201612171650
[INFO ] 12:17:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:17:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171650',true)]]--
[INFO ] 12:17:46 [com.work.main.BatchRealtime] - 201612171655
[INFO ] 12:17:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:17:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171655',true)]]--
[INFO ] 12:17:58 [com.work.main.BatchRealtime] - 201612171700
[INFO ] 12:17:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:17:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171700',true)]]--
[INFO ] 12:18:09 [com.work.main.BatchRealtime] - 201612171705
[INFO ] 12:18:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:18:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171705',true)]]--
[INFO ] 12:18:21 [com.work.main.BatchRealtime] - 201612171710
[INFO ] 12:18:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:18:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171710',true)]]--
[INFO ] 12:18:32 [com.work.main.BatchRealtime] - 201612171715
[INFO ] 12:18:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:18:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171715',true)]]--
[INFO ] 12:18:44 [com.work.main.BatchRealtime] - 201612171720
[INFO ] 12:18:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:18:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171720',true)]]--
[INFO ] 12:18:55 [com.work.main.BatchRealtime] - 201612171725
[INFO ] 12:18:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:18:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171725',true)]]--
[INFO ] 12:19:07 [com.work.main.BatchRealtime] - 201612171730
[INFO ] 12:19:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:19:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171730',true)]]--
[INFO ] 12:19:18 [com.work.main.BatchRealtime] - 201612171735
[INFO ] 12:19:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:19:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171735',true)]]--
[INFO ] 12:19:30 [com.work.main.BatchRealtime] - 201612171740
[INFO ] 12:19:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:19:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171740',true)]]--
[INFO ] 12:19:41 [com.work.main.BatchRealtime] - 201612171745
[INFO ] 12:19:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:19:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171745',true)]]--
[INFO ] 12:19:52 [com.work.main.BatchRealtime] - 201612171750
[INFO ] 12:19:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:19:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171750',true)]]--
[INFO ] 12:20:04 [com.work.main.BatchRealtime] - 201612171755
[INFO ] 12:20:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:20:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171755',true)]]--
[INFO ] 12:20:15 [com.work.main.BatchRealtime] - 201612171800
[INFO ] 12:20:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:20:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171800',true)]]--
[INFO ] 12:23:28 [com.work.main.BatchRealtime] - 201612171805
[INFO ] 12:23:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:23:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171805',true)]]--
[INFO ] 12:23:39 [com.work.main.BatchRealtime] - 201612171810
[INFO ] 12:23:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:23:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171810',true)]]--
[INFO ] 12:23:51 [com.work.main.BatchRealtime] - 201612171815
[INFO ] 12:23:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:23:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171815',true)]]--
[INFO ] 12:24:02 [com.work.main.BatchRealtime] - 201612171820
[INFO ] 12:24:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171820',true)]]--
[INFO ] 12:24:13 [com.work.main.BatchRealtime] - 201612171825
[INFO ] 12:24:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171825',true)]]--
[INFO ] 12:24:24 [com.work.main.BatchRealtime] - 201612171830
[INFO ] 12:24:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171830',true)]]--
[INFO ] 12:24:36 [com.work.main.BatchRealtime] - 201612171835
[INFO ] 12:24:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171835',true)]]--
[INFO ] 12:24:47 [com.work.main.BatchRealtime] - 201612171840
[INFO ] 12:24:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171840',true)]]--
[INFO ] 12:24:58 [com.work.main.BatchRealtime] - 201612171845
[INFO ] 12:24:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:24:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171845',true)]]--
[INFO ] 12:25:09 [com.work.main.BatchRealtime] - 201612171850
[INFO ] 12:25:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:25:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171850',true)]]--
[INFO ] 12:25:20 [com.work.main.BatchRealtime] - 201612171855
[INFO ] 12:25:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:25:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171855',true)]]--
[INFO ] 12:25:32 [com.work.main.BatchRealtime] - 201612171900
[INFO ] 12:25:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:25:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171900',true)]]--
[INFO ] 12:25:43 [com.work.main.BatchRealtime] - 201612171905
[INFO ] 12:25:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:25:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171905',true)]]--
[INFO ] 12:25:54 [com.work.main.BatchRealtime] - 201612171910
[INFO ] 12:25:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:25:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171910',true)]]--
[INFO ] 12:26:05 [com.work.main.BatchRealtime] - 201612171915
[INFO ] 12:26:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:26:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171915',true)]]--
[INFO ] 12:26:16 [com.work.main.BatchRealtime] - 201612171920
[INFO ] 12:26:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:26:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171920',true)]]--
[INFO ] 12:26:27 [com.work.main.BatchRealtime] - 201612171925
[INFO ] 12:26:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:26:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171925',true)]]--
[INFO ] 12:26:39 [com.work.main.BatchRealtime] - 201612171930
[INFO ] 12:26:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:26:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171930',true)]]--
[INFO ] 12:26:50 [com.work.main.BatchRealtime] - 201612171935
[INFO ] 12:26:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:26:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171935',true)]]--
[INFO ] 12:27:01 [com.work.main.BatchRealtime] - 201612171940
[INFO ] 12:27:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171940',true)]]--
[INFO ] 12:27:12 [com.work.main.BatchRealtime] - 201612171945
[INFO ] 12:27:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171945',true)]]--
[INFO ] 12:27:23 [com.work.main.BatchRealtime] - 201612171950
[INFO ] 12:27:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171950',true)]]--
[INFO ] 12:27:34 [com.work.main.BatchRealtime] - 201612171955
[INFO ] 12:27:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612171955',true)]]--
[INFO ] 12:27:45 [com.work.main.BatchRealtime] - 201612172000
[INFO ] 12:27:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172000',true)]]--
[INFO ] 12:27:56 [com.work.main.BatchRealtime] - 201612172005
[INFO ] 12:27:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:27:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172005',true)]]--
[INFO ] 12:28:07 [com.work.main.BatchRealtime] - 201612172010
[INFO ] 12:28:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:28:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172010',true)]]--
[INFO ] 12:28:18 [com.work.main.BatchRealtime] - 201612172015
[INFO ] 12:28:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:28:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172015',true)]]--
[INFO ] 12:28:29 [com.work.main.BatchRealtime] - 201612172020
[INFO ] 12:28:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:28:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172020',true)]]--
[INFO ] 12:28:40 [com.work.main.BatchRealtime] - 201612172025
[INFO ] 12:28:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:28:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172025',true)]]--
[INFO ] 12:28:51 [com.work.main.BatchRealtime] - 201612172030
[INFO ] 12:28:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:28:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172030',true)]]--
[INFO ] 12:29:02 [com.work.main.BatchRealtime] - 201612172035
[INFO ] 12:29:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172035',true)]]--
[INFO ] 12:29:12 [com.work.main.BatchRealtime] - 201612172040
[INFO ] 12:29:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172040',true)]]--
[INFO ] 12:29:23 [com.work.main.BatchRealtime] - 201612172045
[INFO ] 12:29:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172045',true)]]--
[INFO ] 12:29:34 [com.work.main.BatchRealtime] - 201612172050
[INFO ] 12:29:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172050',true)]]--
[INFO ] 12:29:45 [com.work.main.BatchRealtime] - 201612172055
[INFO ] 12:29:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172055',true)]]--
[INFO ] 12:29:55 [com.work.main.BatchRealtime] - 201612172100
[INFO ] 12:29:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:29:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172100',true)]]--
[INFO ] 12:30:06 [com.work.main.BatchRealtime] - 201612172105
[INFO ] 12:30:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172105',true)]]--
[INFO ] 12:30:17 [com.work.main.BatchRealtime] - 201612172110
[INFO ] 12:30:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172110',true)]]--
[INFO ] 12:30:27 [com.work.main.BatchRealtime] - 201612172115
[INFO ] 12:30:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172115',true)]]--
[INFO ] 12:30:38 [com.work.main.BatchRealtime] - 201612172120
[INFO ] 12:30:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172120',true)]]--
[INFO ] 12:30:49 [com.work.main.BatchRealtime] - 201612172125
[INFO ] 12:30:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172125',true)]]--
[INFO ] 12:30:59 [com.work.main.BatchRealtime] - 201612172130
[INFO ] 12:30:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:30:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172130',true)]]--
[INFO ] 12:31:10 [com.work.main.BatchRealtime] - 201612172135
[INFO ] 12:31:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:31:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172135',true)]]--
[INFO ] 12:31:20 [com.work.main.BatchRealtime] - 201612172140
[INFO ] 12:31:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:31:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172140',true)]]--
[INFO ] 12:31:31 [com.work.main.BatchRealtime] - 201612172145
[INFO ] 12:31:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:31:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172145',true)]]--
[INFO ] 12:31:41 [com.work.main.BatchRealtime] - 201612172150
[INFO ] 12:31:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:31:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172150',true)]]--
[INFO ] 12:31:52 [com.work.main.BatchRealtime] - 201612172155
[INFO ] 12:31:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:31:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172155',true)]]--
[INFO ] 12:32:02 [com.work.main.BatchRealtime] - 201612172200
[INFO ] 12:32:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172200',true)]]--
[INFO ] 12:32:13 [com.work.main.BatchRealtime] - 201612172205
[INFO ] 12:32:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172205',true)]]--
[INFO ] 12:32:23 [com.work.main.BatchRealtime] - 201612172210
[INFO ] 12:32:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172210',true)]]--
[INFO ] 12:32:33 [com.work.main.BatchRealtime] - 201612172215
[INFO ] 12:32:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172215',true)]]--
[INFO ] 12:32:44 [com.work.main.BatchRealtime] - 201612172220
[INFO ] 12:32:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172220',true)]]--
[INFO ] 12:32:54 [com.work.main.BatchRealtime] - 201612172225
[INFO ] 12:32:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:32:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172225',true)]]--
[INFO ] 12:33:05 [com.work.main.BatchRealtime] - 201612172230
[INFO ] 12:33:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172230',true)]]--
[INFO ] 12:33:15 [com.work.main.BatchRealtime] - 201612172235
[INFO ] 12:33:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172235',true)]]--
[INFO ] 12:33:26 [com.work.main.BatchRealtime] - 201612172240
[INFO ] 12:33:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172240',true)]]--
[INFO ] 12:33:36 [com.work.main.BatchRealtime] - 201612172245
[INFO ] 12:33:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172245',true)]]--
[INFO ] 12:33:46 [com.work.main.BatchRealtime] - 201612172250
[INFO ] 12:33:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172250',true)]]--
[INFO ] 12:33:56 [com.work.main.BatchRealtime] - 201612172255
[INFO ] 12:33:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:33:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172255',true)]]--
[INFO ] 12:34:07 [com.work.main.BatchRealtime] - 201612172300
[INFO ] 12:34:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172300',true)]]--
[INFO ] 12:34:17 [com.work.main.BatchRealtime] - 201612172305
[INFO ] 12:34:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172305',true)]]--
[INFO ] 12:34:27 [com.work.main.BatchRealtime] - 201612172310
[INFO ] 12:34:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172310',true)]]--
[INFO ] 12:34:37 [com.work.main.BatchRealtime] - 201612172315
[INFO ] 12:34:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172315',true)]]--
[INFO ] 12:34:48 [com.work.main.BatchRealtime] - 201612172320
[INFO ] 12:34:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172320',true)]]--
[INFO ] 12:34:58 [com.work.main.BatchRealtime] - 201612172325
[INFO ] 12:34:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:34:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172325',true)]]--
[INFO ] 12:35:08 [com.work.main.BatchRealtime] - 201612172330
[INFO ] 12:35:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:35:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172330',true)]]--
[INFO ] 12:35:18 [com.work.main.BatchRealtime] - 201612172335
[INFO ] 12:35:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:35:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172335',true)]]--
[INFO ] 12:35:29 [com.work.main.BatchRealtime] - 201612172340
[INFO ] 12:35:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:35:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172340',true)]]--
[INFO ] 12:35:39 [com.work.main.BatchRealtime] - 201612172345
[INFO ] 12:35:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:35:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172345',true)]]--
[INFO ] 12:35:49 [com.work.main.BatchRealtime] - 201612172350
[INFO ] 12:35:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:35:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172350',true)]]--
[INFO ] 12:35:59 [com.work.main.BatchRealtime] - 201612172355
[INFO ] 12:36:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:36:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612172355',true)]]--
[INFO ] 12:37:47 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 12:37:47 [com.work.main.BatchRealtime] - 201612160000
[INFO ] 12:37:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:37:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160000',true)]]--
[ERROR] 12:38:01 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-16 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 12:38:02 [com.work.main.BatchRealtime] - 201612160005
[INFO ] 12:38:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:38:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160005',true)]]--
[ERROR] 12:38:13 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-16 00:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 12:38:14 [com.work.main.BatchRealtime] - 201612160010
[INFO ] 12:38:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:38:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160010',true)]]--
[INFO ] 12:38:28 [com.work.main.BatchRealtime] - 201612160015
[INFO ] 12:38:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:38:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160015',true)]]--
[INFO ] 12:38:42 [com.work.main.BatchRealtime] - 201612160020
[INFO ] 12:38:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:38:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160020',true)]]--
[INFO ] 12:38:56 [com.work.main.BatchRealtime] - 201612160025
[INFO ] 12:38:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:38:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160025',true)]]--
[INFO ] 12:39:10 [com.work.main.BatchRealtime] - 201612160030
[INFO ] 12:39:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:39:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160030',true)]]--
[INFO ] 12:39:24 [com.work.main.BatchRealtime] - 201612160035
[INFO ] 12:39:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:39:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160035',true)]]--
[INFO ] 12:39:38 [com.work.main.BatchRealtime] - 201612160040
[INFO ] 12:39:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:39:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160040',true)]]--
[INFO ] 12:39:52 [com.work.main.BatchRealtime] - 201612160045
[INFO ] 12:39:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:39:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160045',true)]]--
[INFO ] 12:40:06 [com.work.main.BatchRealtime] - 201612160050
[INFO ] 12:40:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:40:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160050',true)]]--
[INFO ] 12:40:19 [com.work.main.BatchRealtime] - 201612160055
[INFO ] 12:40:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:40:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160055',true)]]--
[INFO ] 12:40:33 [com.work.main.BatchRealtime] - 201612160100
[INFO ] 12:40:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:40:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160100',true)]]--
[INFO ] 12:40:47 [com.work.main.BatchRealtime] - 201612160105
[INFO ] 12:40:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:40:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160105',true)]]--
[INFO ] 12:41:01 [com.work.main.BatchRealtime] - 201612160110
[INFO ] 12:41:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:41:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160110',true)]]--
[INFO ] 12:41:15 [com.work.main.BatchRealtime] - 201612160115
[INFO ] 12:41:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:41:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160115',true)]]--
[INFO ] 12:41:29 [com.work.main.BatchRealtime] - 201612160120
[INFO ] 12:41:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:41:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160120',true)]]--
[INFO ] 12:41:43 [com.work.main.BatchRealtime] - 201612160125
[INFO ] 12:41:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:41:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160125',true)]]--
[INFO ] 12:41:57 [com.work.main.BatchRealtime] - 201612160130
[INFO ] 12:41:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:41:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160130',true)]]--
[INFO ] 12:42:11 [com.work.main.BatchRealtime] - 201612160135
[INFO ] 12:42:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:42:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160135',true)]]--
[INFO ] 12:42:25 [com.work.main.BatchRealtime] - 201612160140
[INFO ] 12:42:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:42:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160140',true)]]--
[INFO ] 12:42:38 [com.work.main.BatchRealtime] - 201612160145
[INFO ] 12:42:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:42:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160145',true)]]--
[INFO ] 12:42:52 [com.work.main.BatchRealtime] - 201612160150
[INFO ] 12:42:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:42:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160150',true)]]--
[INFO ] 12:43:06 [com.work.main.BatchRealtime] - 201612160155
[INFO ] 12:43:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:43:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160155',true)]]--
[INFO ] 12:43:20 [com.work.main.BatchRealtime] - 201612160200
[INFO ] 12:43:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:43:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160200',true)]]--
[INFO ] 12:43:34 [com.work.main.BatchRealtime] - 201612160205
[INFO ] 12:43:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:43:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160205',true)]]--
[INFO ] 12:43:48 [com.work.main.BatchRealtime] - 201612160210
[INFO ] 12:43:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:43:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160210',true)]]--
[INFO ] 12:44:01 [com.work.main.BatchRealtime] - 201612160215
[INFO ] 12:44:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:44:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160215',true)]]--
[INFO ] 12:44:15 [com.work.main.BatchRealtime] - 201612160220
[INFO ] 12:44:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:44:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160220',true)]]--
[INFO ] 12:44:29 [com.work.main.BatchRealtime] - 201612160225
[INFO ] 12:44:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:44:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160225',true)]]--
[INFO ] 12:44:43 [com.work.main.BatchRealtime] - 201612160230
[INFO ] 12:44:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:44:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160230',true)]]--
[INFO ] 12:44:57 [com.work.main.BatchRealtime] - 201612160235
[INFO ] 12:44:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:44:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160235',true)]]--
[INFO ] 12:45:10 [com.work.main.BatchRealtime] - 201612160240
[INFO ] 12:45:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:45:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160240',true)]]--
[INFO ] 12:45:24 [com.work.main.BatchRealtime] - 201612160245
[INFO ] 12:45:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:45:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160245',true)]]--
[INFO ] 12:45:38 [com.work.main.BatchRealtime] - 201612160250
[INFO ] 12:45:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:45:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160250',true)]]--
[INFO ] 12:45:52 [com.work.main.BatchRealtime] - 201612160255
[INFO ] 12:45:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:45:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160255',true)]]--
[INFO ] 12:46:06 [com.work.main.BatchRealtime] - 201612160300
[INFO ] 12:46:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:46:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160300',true)]]--
[INFO ] 12:46:19 [com.work.main.BatchRealtime] - 201612160305
[INFO ] 12:46:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:46:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160305',true)]]--
[INFO ] 12:46:33 [com.work.main.BatchRealtime] - 201612160310
[INFO ] 12:46:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:46:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160310',true)]]--
[INFO ] 12:46:47 [com.work.main.BatchRealtime] - 201612160315
[INFO ] 12:46:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:46:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160315',true)]]--
[INFO ] 12:47:01 [com.work.main.BatchRealtime] - 201612160320
[INFO ] 12:47:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:47:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160320',true)]]--
[INFO ] 12:47:15 [com.work.main.BatchRealtime] - 201612160325
[INFO ] 12:47:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:47:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160325',true)]]--
[INFO ] 12:47:28 [com.work.main.BatchRealtime] - 201612160330
[INFO ] 12:47:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:47:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160330',true)]]--
[INFO ] 12:47:42 [com.work.main.BatchRealtime] - 201612160335
[INFO ] 12:47:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:47:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160335',true)]]--
[INFO ] 12:47:56 [com.work.main.BatchRealtime] - 201612160340
[INFO ] 12:47:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:47:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160340',true)]]--
[INFO ] 12:48:10 [com.work.main.BatchRealtime] - 201612160345
[INFO ] 12:48:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:48:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160345',true)]]--
[INFO ] 12:48:23 [com.work.main.BatchRealtime] - 201612160350
[INFO ] 12:48:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:48:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160350',true)]]--
[INFO ] 12:48:37 [com.work.main.BatchRealtime] - 201612160355
[INFO ] 12:48:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:48:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160355',true)]]--
[INFO ] 12:48:51 [com.work.main.BatchRealtime] - 201612160400
[INFO ] 12:48:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:48:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160400',true)]]--
[INFO ] 12:49:05 [com.work.main.BatchRealtime] - 201612160405
[INFO ] 12:49:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:49:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160405',true)]]--
[INFO ] 12:49:18 [com.work.main.BatchRealtime] - 201612160410
[INFO ] 12:49:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:49:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160410',true)]]--
[INFO ] 12:49:32 [com.work.main.BatchRealtime] - 201612160415
[INFO ] 12:49:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:49:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160415',true)]]--
[INFO ] 12:49:46 [com.work.main.BatchRealtime] - 201612160420
[INFO ] 12:49:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:49:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160420',true)]]--
[INFO ] 12:49:59 [com.work.main.BatchRealtime] - 201612160425
[INFO ] 12:49:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:49:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160425',true)]]--
[INFO ] 12:50:13 [com.work.main.BatchRealtime] - 201612160430
[INFO ] 12:50:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:50:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160430',true)]]--
[INFO ] 12:50:27 [com.work.main.BatchRealtime] - 201612160435
[INFO ] 12:50:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:50:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160435',true)]]--
[INFO ] 12:50:41 [com.work.main.BatchRealtime] - 201612160440
[INFO ] 12:50:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:50:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160440',true)]]--
[INFO ] 12:50:54 [com.work.main.BatchRealtime] - 201612160445
[INFO ] 12:50:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:50:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160445',true)]]--
[INFO ] 12:51:08 [com.work.main.BatchRealtime] - 201612160450
[INFO ] 12:51:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:51:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160450',true)]]--
[INFO ] 12:51:22 [com.work.main.BatchRealtime] - 201612160455
[INFO ] 12:51:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:51:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160455',true)]]--
[INFO ] 12:51:36 [com.work.main.BatchRealtime] - 201612160500
[INFO ] 12:51:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:51:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160500',true)]]--
[INFO ] 12:51:49 [com.work.main.BatchRealtime] - 201612160505
[INFO ] 12:51:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:51:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160505',true)]]--
[INFO ] 12:52:03 [com.work.main.BatchRealtime] - 201612160510
[INFO ] 12:52:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:52:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160510',true)]]--
[INFO ] 12:52:17 [com.work.main.BatchRealtime] - 201612160515
[INFO ] 12:52:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:52:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160515',true)]]--
[INFO ] 12:52:31 [com.work.main.BatchRealtime] - 201612160520
[INFO ] 12:52:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:52:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160520',true)]]--
[INFO ] 12:52:44 [com.work.main.BatchRealtime] - 201612160525
[INFO ] 12:52:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:52:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160525',true)]]--
[INFO ] 12:52:58 [com.work.main.BatchRealtime] - 201612160530
[INFO ] 12:52:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:52:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160530',true)]]--
[INFO ] 12:53:12 [com.work.main.BatchRealtime] - 201612160535
[INFO ] 12:53:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:53:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160535',true)]]--
[INFO ] 12:53:25 [com.work.main.BatchRealtime] - 201612160540
[INFO ] 12:53:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:53:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160540',true)]]--
[INFO ] 12:53:39 [com.work.main.BatchRealtime] - 201612160545
[INFO ] 12:53:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:53:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160545',true)]]--
[INFO ] 12:53:53 [com.work.main.BatchRealtime] - 201612160550
[INFO ] 12:53:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:53:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160550',true)]]--
[INFO ] 12:54:06 [com.work.main.BatchRealtime] - 201612160555
[INFO ] 12:54:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:54:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160555',true)]]--
[INFO ] 12:54:20 [com.work.main.BatchRealtime] - 201612160600
[INFO ] 12:54:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:54:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160600',true)]]--
[INFO ] 12:54:34 [com.work.main.BatchRealtime] - 201612160605
[INFO ] 12:54:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:54:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160605',true)]]--
[INFO ] 12:54:47 [com.work.main.BatchRealtime] - 201612160610
[INFO ] 12:54:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:54:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160610',true)]]--
[INFO ] 12:55:01 [com.work.main.BatchRealtime] - 201612160615
[INFO ] 12:55:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:55:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160615',true)]]--
[INFO ] 12:55:15 [com.work.main.BatchRealtime] - 201612160620
[INFO ] 12:55:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:55:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160620',true)]]--
[INFO ] 12:55:28 [com.work.main.BatchRealtime] - 201612160625
[INFO ] 12:55:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:55:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160625',true)]]--
[INFO ] 12:55:42 [com.work.main.BatchRealtime] - 201612160630
[INFO ] 12:55:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:55:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160630',true)]]--
[INFO ] 12:55:55 [com.work.main.BatchRealtime] - 201612160635
[INFO ] 12:55:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:55:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160635',true)]]--
[INFO ] 12:56:09 [com.work.main.BatchRealtime] - 201612160640
[INFO ] 12:56:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:56:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160640',true)]]--
[INFO ] 12:56:23 [com.work.main.BatchRealtime] - 201612160645
[INFO ] 12:56:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:56:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160645',true)]]--
[INFO ] 12:56:36 [com.work.main.BatchRealtime] - 201612160650
[INFO ] 12:56:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:56:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160650',true)]]--
[INFO ] 12:56:50 [com.work.main.BatchRealtime] - 201612160655
[INFO ] 12:56:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:56:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160655',true)]]--
[INFO ] 12:57:04 [com.work.main.BatchRealtime] - 201612160700
[INFO ] 12:57:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:57:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160700',true)]]--
[INFO ] 12:57:17 [com.work.main.BatchRealtime] - 201612160705
[INFO ] 12:57:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:57:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160705',true)]]--
[INFO ] 12:57:31 [com.work.main.BatchRealtime] - 201612160710
[INFO ] 12:57:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:57:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160710',true)]]--
[INFO ] 12:57:45 [com.work.main.BatchRealtime] - 201612160715
[INFO ] 12:57:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:57:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160715',true)]]--
[INFO ] 12:57:58 [com.work.main.BatchRealtime] - 201612160720
[INFO ] 12:57:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:57:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160720',true)]]--
[INFO ] 12:58:12 [com.work.main.BatchRealtime] - 201612160725
[INFO ] 12:58:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:58:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160725',true)]]--
[INFO ] 12:58:25 [com.work.main.BatchRealtime] - 201612160730
[INFO ] 12:58:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:58:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160730',true)]]--
[INFO ] 12:58:39 [com.work.main.BatchRealtime] - 201612160735
[INFO ] 12:58:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:58:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160735',true)]]--
[INFO ] 12:58:52 [com.work.main.BatchRealtime] - 201612160740
[INFO ] 12:58:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:58:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160740',true)]]--
[INFO ] 12:59:06 [com.work.main.BatchRealtime] - 201612160745
[INFO ] 12:59:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:59:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160745',true)]]--
[INFO ] 12:59:19 [com.work.main.BatchRealtime] - 201612160750
[INFO ] 12:59:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:59:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160750',true)]]--
[INFO ] 12:59:33 [com.work.main.BatchRealtime] - 201612160755
[INFO ] 12:59:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:59:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160755',true)]]--
[INFO ] 12:59:47 [com.work.main.BatchRealtime] - 201612160800
[INFO ] 12:59:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 12:59:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160800',true)]]--
[INFO ] 13:00:00 [com.work.main.BatchRealtime] - 201612160805
[INFO ] 13:00:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:00:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160805',true)]]--
[INFO ] 13:00:14 [com.work.main.BatchRealtime] - 201612160810
[INFO ] 13:00:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:00:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160810',true)]]--
[INFO ] 13:00:27 [com.work.main.BatchRealtime] - 201612160815
[INFO ] 13:00:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:00:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160815',true)]]--
[INFO ] 13:00:41 [com.work.main.BatchRealtime] - 201612160820
[INFO ] 13:00:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:00:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160820',true)]]--
[INFO ] 13:00:54 [com.work.main.BatchRealtime] - 201612160825
[INFO ] 13:00:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:00:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160825',true)]]--
[INFO ] 13:01:08 [com.work.main.BatchRealtime] - 201612160830
[INFO ] 13:01:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:01:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160830',true)]]--
[INFO ] 13:01:21 [com.work.main.BatchRealtime] - 201612160835
[INFO ] 13:01:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:01:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160835',true)]]--
[INFO ] 13:01:35 [com.work.main.BatchRealtime] - 201612160840
[INFO ] 13:01:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:01:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160840',true)]]--
[INFO ] 13:01:48 [com.work.main.BatchRealtime] - 201612160845
[INFO ] 13:01:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:01:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160845',true)]]--
[INFO ] 13:02:01 [com.work.main.BatchRealtime] - 201612160850
[INFO ] 13:02:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:02:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160850',true)]]--
[INFO ] 13:02:15 [com.work.main.BatchRealtime] - 201612160855
[INFO ] 13:02:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:02:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160855',true)]]--
[INFO ] 13:02:28 [com.work.main.BatchRealtime] - 201612160900
[INFO ] 13:02:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:02:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160900',true)]]--
[INFO ] 13:02:42 [com.work.main.BatchRealtime] - 201612160905
[INFO ] 13:02:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:02:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160905',true)]]--
[INFO ] 13:02:55 [com.work.main.BatchRealtime] - 201612160910
[INFO ] 13:02:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:02:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160910',true)]]--
[INFO ] 13:03:08 [com.work.main.BatchRealtime] - 201612160915
[INFO ] 13:03:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:03:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160915',true)]]--
[INFO ] 13:03:22 [com.work.main.BatchRealtime] - 201612160920
[INFO ] 13:03:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:03:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160920',true)]]--
[INFO ] 13:03:35 [com.work.main.BatchRealtime] - 201612160925
[INFO ] 13:03:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:03:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160925',true)]]--
[INFO ] 13:03:48 [com.work.main.BatchRealtime] - 201612160930
[INFO ] 13:03:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:03:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160930',true)]]--
[INFO ] 13:04:02 [com.work.main.BatchRealtime] - 201612160935
[INFO ] 13:04:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:04:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160935',true)]]--
[INFO ] 13:04:15 [com.work.main.BatchRealtime] - 201612160940
[INFO ] 13:04:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:04:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160940',true)]]--
[INFO ] 13:04:28 [com.work.main.BatchRealtime] - 201612160945
[INFO ] 13:04:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:04:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160945',true)]]--
[INFO ] 13:04:41 [com.work.main.BatchRealtime] - 201612160950
[INFO ] 13:04:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:04:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160950',true)]]--
[INFO ] 13:04:55 [com.work.main.BatchRealtime] - 201612160955
[INFO ] 13:04:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:04:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612160955',true)]]--
[INFO ] 13:05:08 [com.work.main.BatchRealtime] - 201612161000
[INFO ] 13:05:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:05:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161000',true)]]--
[INFO ] 13:05:21 [com.work.main.BatchRealtime] - 201612161005
[INFO ] 13:05:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:05:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161005',true)]]--
[INFO ] 13:05:34 [com.work.main.BatchRealtime] - 201612161010
[INFO ] 13:05:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:05:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161010',true)]]--
[INFO ] 13:05:48 [com.work.main.BatchRealtime] - 201612161015
[INFO ] 13:05:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:05:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161015',true)]]--
[INFO ] 13:06:01 [com.work.main.BatchRealtime] - 201612161020
[INFO ] 13:06:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:06:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161020',true)]]--
[INFO ] 13:06:14 [com.work.main.BatchRealtime] - 201612161025
[INFO ] 13:06:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:06:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161025',true)]]--
[INFO ] 13:06:27 [com.work.main.BatchRealtime] - 201612161030
[INFO ] 13:06:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:06:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161030',true)]]--
[INFO ] 13:06:40 [com.work.main.BatchRealtime] - 201612161035
[INFO ] 13:06:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:06:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161035',true)]]--
[INFO ] 13:06:53 [com.work.main.BatchRealtime] - 201612161040
[INFO ] 13:06:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:06:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161040',true)]]--
[INFO ] 13:07:06 [com.work.main.BatchRealtime] - 201612161045
[INFO ] 13:07:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:07:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161045',true)]]--
[INFO ] 13:07:19 [com.work.main.BatchRealtime] - 201612161050
[INFO ] 13:07:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:07:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161050',true)]]--
[INFO ] 13:07:32 [com.work.main.BatchRealtime] - 201612161055
[INFO ] 13:07:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:07:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161055',true)]]--
[INFO ] 13:07:45 [com.work.main.BatchRealtime] - 201612161100
[INFO ] 13:07:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:07:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161100',true)]]--
[INFO ] 13:07:58 [com.work.main.BatchRealtime] - 201612161105
[INFO ] 13:07:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:07:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161105',true)]]--
[INFO ] 13:08:11 [com.work.main.BatchRealtime] - 201612161110
[INFO ] 13:08:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:08:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161110',true)]]--
[INFO ] 13:08:23 [com.work.main.BatchRealtime] - 201612161115
[INFO ] 13:08:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:08:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161115',true)]]--
[INFO ] 13:08:36 [com.work.main.BatchRealtime] - 201612161120
[INFO ] 13:08:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:08:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161120',true)]]--
[INFO ] 13:08:49 [com.work.main.BatchRealtime] - 201612161125
[INFO ] 13:08:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:08:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161125',true)]]--
[INFO ] 13:09:02 [com.work.main.BatchRealtime] - 201612161130
[INFO ] 13:09:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:09:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161130',true)]]--
[INFO ] 13:09:15 [com.work.main.BatchRealtime] - 201612161135
[INFO ] 13:09:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:09:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161135',true)]]--
[INFO ] 13:09:27 [com.work.main.BatchRealtime] - 201612161140
[INFO ] 13:09:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:09:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161140',true)]]--
[INFO ] 13:09:40 [com.work.main.BatchRealtime] - 201612161145
[INFO ] 13:09:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:09:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161145',true)]]--
[INFO ] 13:09:53 [com.work.main.BatchRealtime] - 201612161150
[INFO ] 13:09:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:09:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161150',true)]]--
[INFO ] 13:10:05 [com.work.main.BatchRealtime] - 201612161155
[INFO ] 13:10:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:10:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161155',true)]]--
[INFO ] 13:10:18 [com.work.main.BatchRealtime] - 201612161200
[INFO ] 13:10:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:10:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161200',true)]]--
[INFO ] 13:10:31 [com.work.main.BatchRealtime] - 201612161205
[INFO ] 13:10:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:10:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161205',true)]]--
[INFO ] 13:10:44 [com.work.main.BatchRealtime] - 201612161210
[INFO ] 13:10:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:10:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161210',true)]]--
[INFO ] 13:10:56 [com.work.main.BatchRealtime] - 201612161215
[INFO ] 13:10:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:10:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161215',true)]]--
[INFO ] 13:11:09 [com.work.main.BatchRealtime] - 201612161220
[INFO ] 13:11:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:11:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161220',true)]]--
[INFO ] 13:11:21 [com.work.main.BatchRealtime] - 201612161225
[INFO ] 13:11:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:11:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161225',true)]]--
[INFO ] 13:11:34 [com.work.main.BatchRealtime] - 201612161230
[INFO ] 13:11:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:11:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161230',true)]]--
[INFO ] 13:11:46 [com.work.main.BatchRealtime] - 201612161235
[INFO ] 13:11:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:11:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161235',true)]]--
[INFO ] 13:11:59 [com.work.main.BatchRealtime] - 201612161240
[INFO ] 13:11:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:11:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161240',true)]]--
[INFO ] 13:12:11 [com.work.main.BatchRealtime] - 201612161245
[INFO ] 13:12:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:12:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161245',true)]]--
[INFO ] 13:12:24 [com.work.main.BatchRealtime] - 201612161250
[INFO ] 13:12:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:12:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161250',true)]]--
[INFO ] 13:12:36 [com.work.main.BatchRealtime] - 201612161255
[INFO ] 13:12:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:12:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161255',true)]]--
[INFO ] 13:12:49 [com.work.main.BatchRealtime] - 201612161300
[INFO ] 13:12:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:12:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161300',true)]]--
[INFO ] 13:13:01 [com.work.main.BatchRealtime] - 201612161305
[INFO ] 13:13:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:13:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161305',true)]]--
[INFO ] 13:13:13 [com.work.main.BatchRealtime] - 201612161310
[INFO ] 13:13:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:13:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161310',true)]]--
[INFO ] 13:13:26 [com.work.main.BatchRealtime] - 201612161315
[INFO ] 13:13:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:13:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161315',true)]]--
[INFO ] 13:13:38 [com.work.main.BatchRealtime] - 201612161320
[INFO ] 13:13:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:13:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161320',true)]]--
[INFO ] 13:13:50 [com.work.main.BatchRealtime] - 201612161325
[INFO ] 13:13:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:13:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161325',true)]]--
[INFO ] 13:14:02 [com.work.main.BatchRealtime] - 201612161330
[INFO ] 13:14:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:14:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161330',true)]]--
[INFO ] 13:14:15 [com.work.main.BatchRealtime] - 201612161335
[INFO ] 13:14:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:14:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161335',true)]]--
[INFO ] 13:14:27 [com.work.main.BatchRealtime] - 201612161340
[INFO ] 13:14:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:14:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161340',true)]]--
[INFO ] 13:14:39 [com.work.main.BatchRealtime] - 201612161345
[INFO ] 13:14:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:14:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161345',true)]]--
[INFO ] 13:14:51 [com.work.main.BatchRealtime] - 201612161350
[INFO ] 13:14:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:14:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161350',true)]]--
[INFO ] 13:15:03 [com.work.main.BatchRealtime] - 201612161355
[INFO ] 13:15:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:15:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161355',true)]]--
[INFO ] 13:15:15 [com.work.main.BatchRealtime] - 201612161400
[INFO ] 13:15:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:15:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161400',true)]]--
[INFO ] 13:15:27 [com.work.main.BatchRealtime] - 201612161405
[INFO ] 13:15:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:15:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161405',true)]]--
[INFO ] 13:15:39 [com.work.main.BatchRealtime] - 201612161410
[INFO ] 13:15:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:15:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161410',true)]]--
[INFO ] 13:15:51 [com.work.main.BatchRealtime] - 201612161415
[INFO ] 13:15:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:15:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161415',true)]]--
[INFO ] 13:16:03 [com.work.main.BatchRealtime] - 201612161420
[INFO ] 13:16:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:16:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161420',true)]]--
[INFO ] 13:16:15 [com.work.main.BatchRealtime] - 201612161425
[INFO ] 13:16:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:16:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161425',true)]]--
[INFO ] 13:16:27 [com.work.main.BatchRealtime] - 201612161430
[INFO ] 13:16:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:16:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161430',true)]]--
[INFO ] 13:16:39 [com.work.main.BatchRealtime] - 201612161435
[INFO ] 13:16:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:16:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161435',true)]]--
[INFO ] 13:16:51 [com.work.main.BatchRealtime] - 201612161440
[INFO ] 13:16:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:16:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161440',true)]]--
[INFO ] 13:17:03 [com.work.main.BatchRealtime] - 201612161445
[INFO ] 13:17:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:17:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161445',true)]]--
[INFO ] 13:17:14 [com.work.main.BatchRealtime] - 201612161450
[INFO ] 13:17:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:17:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161450',true)]]--
[INFO ] 13:17:26 [com.work.main.BatchRealtime] - 201612161455
[INFO ] 13:17:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:17:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161455',true)]]--
[INFO ] 13:17:38 [com.work.main.BatchRealtime] - 201612161500
[INFO ] 13:17:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:17:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161500',true)]]--
[INFO ] 13:17:50 [com.work.main.BatchRealtime] - 201612161505
[INFO ] 13:17:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:17:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161505',true)]]--
[INFO ] 13:18:01 [com.work.main.BatchRealtime] - 201612161510
[INFO ] 13:18:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:18:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161510',true)]]--
[INFO ] 13:18:13 [com.work.main.BatchRealtime] - 201612161515
[INFO ] 13:18:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:18:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161515',true)]]--
[INFO ] 13:18:25 [com.work.main.BatchRealtime] - 201612161520
[INFO ] 13:18:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:18:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161520',true)]]--
[INFO ] 13:18:36 [com.work.main.BatchRealtime] - 201612161525
[INFO ] 13:18:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:18:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161525',true)]]--
[INFO ] 13:18:48 [com.work.main.BatchRealtime] - 201612161530
[INFO ] 13:18:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:18:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161530',true)]]--
[INFO ] 13:19:00 [com.work.main.BatchRealtime] - 201612161535
[INFO ] 13:19:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161535',true)]]--
[INFO ] 13:19:11 [com.work.main.BatchRealtime] - 201612161540
[INFO ] 13:19:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161540',true)]]--
[INFO ] 13:19:23 [com.work.main.BatchRealtime] - 201612161545
[INFO ] 13:19:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161545',true)]]--
[INFO ] 13:19:34 [com.work.main.BatchRealtime] - 201612161550
[INFO ] 13:19:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161550',true)]]--
[INFO ] 13:19:46 [com.work.main.BatchRealtime] - 201612161555
[INFO ] 13:19:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161555',true)]]--
[INFO ] 13:19:57 [com.work.main.BatchRealtime] - 201612161600
[INFO ] 13:19:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:19:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161600',true)]]--
[INFO ] 13:20:09 [com.work.main.BatchRealtime] - 201612161605
[INFO ] 13:20:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:20:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161605',true)]]--
[INFO ] 13:20:21 [com.work.main.BatchRealtime] - 201612161610
[INFO ] 13:20:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:20:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161610',true)]]--
[INFO ] 13:20:32 [com.work.main.BatchRealtime] - 201612161615
[INFO ] 13:20:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:20:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161615',true)]]--
[INFO ] 13:20:44 [com.work.main.BatchRealtime] - 201612161620
[INFO ] 13:20:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:20:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161620',true)]]--
[INFO ] 13:20:55 [com.work.main.BatchRealtime] - 201612161625
[INFO ] 13:20:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:20:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161625',true)]]--
[INFO ] 13:21:07 [com.work.main.BatchRealtime] - 201612161630
[INFO ] 13:21:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:21:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161630',true)]]--
[INFO ] 13:21:19 [com.work.main.BatchRealtime] - 201612161635
[INFO ] 13:21:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:21:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161635',true)]]--
[INFO ] 13:21:30 [com.work.main.BatchRealtime] - 201612161640
[INFO ] 13:21:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:21:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161640',true)]]--
[INFO ] 13:21:41 [com.work.main.BatchRealtime] - 201612161645
[INFO ] 13:21:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:21:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161645',true)]]--
[INFO ] 13:21:53 [com.work.main.BatchRealtime] - 201612161650
[INFO ] 13:21:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:21:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161650',true)]]--
[INFO ] 13:22:04 [com.work.main.BatchRealtime] - 201612161655
[INFO ] 13:22:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:22:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161655',true)]]--
[INFO ] 13:22:16 [com.work.main.BatchRealtime] - 201612161700
[INFO ] 13:22:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:22:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161700',true)]]--
[INFO ] 13:22:27 [com.work.main.BatchRealtime] - 201612161705
[INFO ] 13:22:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:22:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161705',true)]]--
[INFO ] 13:22:39 [com.work.main.BatchRealtime] - 201612161710
[INFO ] 13:22:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:22:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161710',true)]]--
[INFO ] 13:22:51 [com.work.main.BatchRealtime] - 201612161715
[INFO ] 13:22:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:22:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161715',true)]]--
[INFO ] 13:23:04 [com.work.main.BatchRealtime] - 201612161720
[INFO ] 13:23:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:23:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161720',true)]]--
[INFO ] 13:23:17 [com.work.main.BatchRealtime] - 201612161725
[INFO ] 13:23:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:23:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161725',true)]]--
[INFO ] 13:23:28 [com.work.main.BatchRealtime] - 201612161730
[INFO ] 13:23:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:23:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161730',true)]]--
[INFO ] 13:23:40 [com.work.main.BatchRealtime] - 201612161735
[INFO ] 13:23:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:23:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161735',true)]]--
[INFO ] 13:23:52 [com.work.main.BatchRealtime] - 201612161740
[INFO ] 13:23:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:23:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161740',true)]]--
[INFO ] 13:24:03 [com.work.main.BatchRealtime] - 201612161745
[INFO ] 13:24:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:24:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161745',true)]]--
[INFO ] 13:24:16 [com.work.main.BatchRealtime] - 201612161750
[INFO ] 13:24:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:24:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161750',true)]]--
[INFO ] 13:24:28 [com.work.main.BatchRealtime] - 201612161755
[INFO ] 13:24:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:24:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161755',true)]]--
[INFO ] 13:24:41 [com.work.main.BatchRealtime] - 201612161800
[INFO ] 13:24:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:24:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161800',true)]]--
[INFO ] 13:24:54 [com.work.main.BatchRealtime] - 201612161805
[INFO ] 13:24:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:24:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161805',true)]]--
[INFO ] 13:25:05 [com.work.main.BatchRealtime] - 201612161810
[INFO ] 13:25:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:25:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161810',true)]]--
[INFO ] 13:25:16 [com.work.main.BatchRealtime] - 201612161815
[INFO ] 13:25:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:25:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161815',true)]]--
[INFO ] 13:25:27 [com.work.main.BatchRealtime] - 201612161820
[INFO ] 13:25:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:25:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161820',true)]]--
[INFO ] 13:25:38 [com.work.main.BatchRealtime] - 201612161825
[INFO ] 13:25:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:25:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161825',true)]]--
[INFO ] 13:25:49 [com.work.main.BatchRealtime] - 201612161830
[INFO ] 13:25:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:25:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161830',true)]]--
[INFO ] 13:26:00 [com.work.main.BatchRealtime] - 201612161835
[INFO ] 13:26:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161835',true)]]--
[INFO ] 13:26:11 [com.work.main.BatchRealtime] - 201612161840
[INFO ] 13:26:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161840',true)]]--
[INFO ] 13:26:22 [com.work.main.BatchRealtime] - 201612161845
[INFO ] 13:26:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161845',true)]]--
[INFO ] 13:26:34 [com.work.main.BatchRealtime] - 201612161850
[INFO ] 13:26:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161850',true)]]--
[INFO ] 13:26:45 [com.work.main.BatchRealtime] - 201612161855
[INFO ] 13:26:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161855',true)]]--
[INFO ] 13:26:55 [com.work.main.BatchRealtime] - 201612161900
[INFO ] 13:26:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:26:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161900',true)]]--
[INFO ] 13:27:06 [com.work.main.BatchRealtime] - 201612161905
[INFO ] 13:27:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:27:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161905',true)]]--
[INFO ] 13:27:17 [com.work.main.BatchRealtime] - 201612161910
[INFO ] 13:27:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:27:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161910',true)]]--
[INFO ] 13:27:28 [com.work.main.BatchRealtime] - 201612161915
[INFO ] 13:27:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:27:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161915',true)]]--
[INFO ] 13:27:39 [com.work.main.BatchRealtime] - 201612161920
[INFO ] 13:27:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:27:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161920',true)]]--
[INFO ] 13:27:50 [com.work.main.BatchRealtime] - 201612161925
[INFO ] 13:27:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:27:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161925',true)]]--
[INFO ] 13:28:01 [com.work.main.BatchRealtime] - 201612161930
[INFO ] 13:28:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161930',true)]]--
[INFO ] 13:28:12 [com.work.main.BatchRealtime] - 201612161935
[INFO ] 13:28:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161935',true)]]--
[INFO ] 13:28:22 [com.work.main.BatchRealtime] - 201612161940
[INFO ] 13:28:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161940',true)]]--
[INFO ] 13:28:33 [com.work.main.BatchRealtime] - 201612161945
[INFO ] 13:28:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161945',true)]]--
[INFO ] 13:28:44 [com.work.main.BatchRealtime] - 201612161950
[INFO ] 13:28:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161950',true)]]--
[INFO ] 13:28:55 [com.work.main.BatchRealtime] - 201612161955
[INFO ] 13:28:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:28:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612161955',true)]]--
[INFO ] 13:29:05 [com.work.main.BatchRealtime] - 201612162000
[INFO ] 13:29:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162000',true)]]--
[INFO ] 13:29:16 [com.work.main.BatchRealtime] - 201612162005
[INFO ] 13:29:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162005',true)]]--
[INFO ] 13:29:26 [com.work.main.BatchRealtime] - 201612162010
[INFO ] 13:29:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162010',true)]]--
[INFO ] 13:29:37 [com.work.main.BatchRealtime] - 201612162015
[INFO ] 13:29:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162015',true)]]--
[INFO ] 13:29:47 [com.work.main.BatchRealtime] - 201612162020
[INFO ] 13:29:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162020',true)]]--
[INFO ] 13:29:58 [com.work.main.BatchRealtime] - 201612162025
[INFO ] 13:29:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:29:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162025',true)]]--
[INFO ] 13:30:08 [com.work.main.BatchRealtime] - 201612162030
[INFO ] 13:30:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:30:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162030',true)]]--
[INFO ] 13:30:19 [com.work.main.BatchRealtime] - 201612162035
[INFO ] 13:30:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:30:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162035',true)]]--
[INFO ] 13:30:30 [com.work.main.BatchRealtime] - 201612162040
[INFO ] 13:30:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:30:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162040',true)]]--
[INFO ] 13:30:41 [com.work.main.BatchRealtime] - 201612162045
[INFO ] 13:30:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:30:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162045',true)]]--
[INFO ] 13:30:51 [com.work.main.BatchRealtime] - 201612162050
[INFO ] 13:30:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:30:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162050',true)]]--
[INFO ] 13:31:02 [com.work.main.BatchRealtime] - 201612162055
[INFO ] 13:31:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162055',true)]]--
[INFO ] 13:31:12 [com.work.main.BatchRealtime] - 201612162100
[INFO ] 13:31:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162100',true)]]--
[INFO ] 13:31:23 [com.work.main.BatchRealtime] - 201612162105
[INFO ] 13:31:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162105',true)]]--
[INFO ] 13:31:33 [com.work.main.BatchRealtime] - 201612162110
[INFO ] 13:31:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162110',true)]]--
[INFO ] 13:31:44 [com.work.main.BatchRealtime] - 201612162115
[INFO ] 13:31:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162115',true)]]--
[INFO ] 13:31:54 [com.work.main.BatchRealtime] - 201612162120
[INFO ] 13:31:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:31:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162120',true)]]--
[INFO ] 13:32:05 [com.work.main.BatchRealtime] - 201612162125
[INFO ] 13:32:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162125',true)]]--
[INFO ] 13:32:15 [com.work.main.BatchRealtime] - 201612162130
[INFO ] 13:32:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162130',true)]]--
[INFO ] 13:32:25 [com.work.main.BatchRealtime] - 201612162135
[INFO ] 13:32:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162135',true)]]--
[INFO ] 13:32:36 [com.work.main.BatchRealtime] - 201612162140
[INFO ] 13:32:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162140',true)]]--
[INFO ] 13:32:46 [com.work.main.BatchRealtime] - 201612162145
[INFO ] 13:32:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162145',true)]]--
[INFO ] 13:32:56 [com.work.main.BatchRealtime] - 201612162150
[INFO ] 13:32:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:32:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162150',true)]]--
[INFO ] 13:33:06 [com.work.main.BatchRealtime] - 201612162155
[INFO ] 13:33:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162155',true)]]--
[INFO ] 13:33:16 [com.work.main.BatchRealtime] - 201612162200
[INFO ] 13:33:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162200',true)]]--
[INFO ] 13:33:27 [com.work.main.BatchRealtime] - 201612162205
[INFO ] 13:33:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162205',true)]]--
[INFO ] 13:33:37 [com.work.main.BatchRealtime] - 201612162210
[INFO ] 13:33:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162210',true)]]--
[INFO ] 13:33:47 [com.work.main.BatchRealtime] - 201612162215
[INFO ] 13:33:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162215',true)]]--
[INFO ] 13:33:57 [com.work.main.BatchRealtime] - 201612162220
[INFO ] 13:33:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:33:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162220',true)]]--
[INFO ] 13:34:07 [com.work.main.BatchRealtime] - 201612162225
[INFO ] 13:34:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162225',true)]]--
[INFO ] 13:34:17 [com.work.main.BatchRealtime] - 201612162230
[INFO ] 13:34:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162230',true)]]--
[INFO ] 13:34:27 [com.work.main.BatchRealtime] - 201612162235
[INFO ] 13:34:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162235',true)]]--
[INFO ] 13:34:37 [com.work.main.BatchRealtime] - 201612162240
[INFO ] 13:34:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162240',true)]]--
[INFO ] 13:34:47 [com.work.main.BatchRealtime] - 201612162245
[INFO ] 13:34:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162245',true)]]--
[INFO ] 13:34:57 [com.work.main.BatchRealtime] - 201612162250
[INFO ] 13:34:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:34:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162250',true)]]--
[INFO ] 13:35:07 [com.work.main.BatchRealtime] - 201612162255
[INFO ] 13:35:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162255',true)]]--
[INFO ] 13:35:17 [com.work.main.BatchRealtime] - 201612162300
[INFO ] 13:35:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162300',true)]]--
[INFO ] 13:35:27 [com.work.main.BatchRealtime] - 201612162305
[INFO ] 13:35:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162305',true)]]--
[INFO ] 13:35:37 [com.work.main.BatchRealtime] - 201612162310
[INFO ] 13:35:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162310',true)]]--
[INFO ] 13:35:47 [com.work.main.BatchRealtime] - 201612162315
[INFO ] 13:35:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162315',true)]]--
[INFO ] 13:35:56 [com.work.main.BatchRealtime] - 201612162320
[INFO ] 13:35:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:35:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162320',true)]]--
[INFO ] 13:36:06 [com.work.main.BatchRealtime] - 201612162325
[INFO ] 13:36:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162325',true)]]--
[INFO ] 13:36:16 [com.work.main.BatchRealtime] - 201612162330
[INFO ] 13:36:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162330',true)]]--
[INFO ] 13:36:26 [com.work.main.BatchRealtime] - 201612162335
[INFO ] 13:36:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162335',true)]]--
[INFO ] 13:36:36 [com.work.main.BatchRealtime] - 201612162340
[INFO ] 13:36:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162340',true)]]--
[INFO ] 13:36:45 [com.work.main.BatchRealtime] - 201612162345
[INFO ] 13:36:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162345',true)]]--
[INFO ] 13:36:55 [com.work.main.BatchRealtime] - 201612162350
[INFO ] 13:36:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:36:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162350',true)]]--
[INFO ] 13:37:05 [com.work.main.BatchRealtime] - 201612162355
[INFO ] 13:37:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:37:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612162355',true)]]--
[INFO ] 13:51:53 [com.work.main.BatchRealtime] - --[[ start ]]]--
[INFO ] 13:51:53 [com.work.main.BatchRealtime] - 201612150000
[INFO ] 13:51:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:51:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150000',true)]]--
[ERROR] 13:52:08 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:52:09 [com.work.main.BatchRealtime] - 201612150005
[INFO ] 13:52:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:52:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150005',true)]]--
[ERROR] 13:52:20 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 00:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:52:21 [com.work.main.BatchRealtime] - 201612150010
[INFO ] 13:52:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:52:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150010',true)]]--
[ERROR] 13:52:32 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 00:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:52:33 [com.work.main.BatchRealtime] - 201612150015
[INFO ] 13:52:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:52:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150015',true)]]--
[ERROR] 13:52:44 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:52:45 [com.work.main.BatchRealtime] - 201612150020
[INFO ] 13:52:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:52:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150020',true)]]--
[ERROR] 13:52:56 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:52:57 [com.work.main.BatchRealtime] - 201612150025
[INFO ] 13:52:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:52:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150025',true)]]--
[ERROR] 13:53:08 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 00:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:53:09 [com.work.main.BatchRealtime] - 201612150030
[INFO ] 13:53:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:53:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150030',true)]]--
[ERROR] 13:53:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 00:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:53:22 [com.work.main.BatchRealtime] - 201612150035
[INFO ] 13:53:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:53:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150035',true)]]--
[ERROR] 13:53:33 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 00:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:53:34 [com.work.main.BatchRealtime] - 201612150040
[INFO ] 13:53:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:53:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150040',true)]]--
[ERROR] 13:53:45 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:53:46 [com.work.main.BatchRealtime] - 201612150045
[INFO ] 13:53:46 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:53:46 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150045',true)]]--
[ERROR] 13:53:56 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:53:58 [com.work.main.BatchRealtime] - 201612150050
[INFO ] 13:53:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:53:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150050',true)]]--
[ERROR] 13:54:09 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 00:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:54:10 [com.work.main.BatchRealtime] - 201612150055
[INFO ] 13:54:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:54:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150055',true)]]--
[ERROR] 13:54:21 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:54:22 [com.work.main.BatchRealtime] - 201612150100
[INFO ] 13:54:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:54:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150100',true)]]--
[ERROR] 13:54:33 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:54:34 [com.work.main.BatchRealtime] - 201612150105
[INFO ] 13:54:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:54:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150105',true)]]--
[ERROR] 13:54:46 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:54:47 [com.work.main.BatchRealtime] - 201612150110
[INFO ] 13:54:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:54:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150110',true)]]--
[ERROR] 13:54:59 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:55:00 [com.work.main.BatchRealtime] - 201612150115
[INFO ] 13:55:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:55:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150115',true)]]--
[ERROR] 13:55:11 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:55:12 [com.work.main.BatchRealtime] - 201612150120
[INFO ] 13:55:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:55:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150120',true)]]--
[ERROR] 13:55:24 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:55:25 [com.work.main.BatchRealtime] - 201612150125
[INFO ] 13:55:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:55:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150125',true)]]--
[ERROR] 13:55:36 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:55:37 [com.work.main.BatchRealtime] - 201612150130
[INFO ] 13:55:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:55:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150130',true)]]--
[ERROR] 13:55:48 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 01:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:55:49 [com.work.main.BatchRealtime] - 201612150135
[INFO ] 13:55:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:55:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150135',true)]]--
[ERROR] 13:56:00 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 01:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:56:01 [com.work.main.BatchRealtime] - 201612150140
[INFO ] 13:56:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:56:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150140',true)]]--
[ERROR] 13:56:12 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:56:13 [com.work.main.BatchRealtime] - 201612150145
[INFO ] 13:56:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:56:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150145',true)]]--
[ERROR] 13:56:24 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 01:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:56:25 [com.work.main.BatchRealtime] - 201612150150
[INFO ] 13:56:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:56:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150150',true)]]--
[ERROR] 13:56:36 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 01:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:56:37 [com.work.main.BatchRealtime] - 201612150155
[INFO ] 13:56:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:56:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150155',true)]]--
[ERROR] 13:56:49 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:56:50 [com.work.main.BatchRealtime] - 201612150200
[INFO ] 13:56:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:56:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150200',true)]]--
[ERROR] 13:57:02 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:57:03 [com.work.main.BatchRealtime] - 201612150205
[INFO ] 13:57:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:57:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150205',true)]]--
[ERROR] 13:57:15 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:57:16 [com.work.main.BatchRealtime] - 201612150210
[INFO ] 13:57:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:57:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150210',true)]]--
[ERROR] 13:57:27 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:57:28 [com.work.main.BatchRealtime] - 201612150215
[INFO ] 13:57:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:57:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150215',true)]]--
[ERROR] 13:57:39 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 02:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:57:40 [com.work.main.BatchRealtime] - 201612150220
[INFO ] 13:57:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:57:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150220',true)]]--
[ERROR] 13:57:51 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:57:52 [com.work.main.BatchRealtime] - 201612150225
[INFO ] 13:57:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:57:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150225',true)]]--
[ERROR] 13:58:03 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:58:04 [com.work.main.BatchRealtime] - 201612150230
[INFO ] 13:58:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:58:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150230',true)]]--
[ERROR] 13:58:15 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:58:16 [com.work.main.BatchRealtime] - 201612150235
[INFO ] 13:58:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:58:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150235',true)]]--
[ERROR] 13:58:27 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:58:28 [com.work.main.BatchRealtime] - 201612150240
[INFO ] 13:58:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:58:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150240',true)]]--
[ERROR] 13:58:39 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 02:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:58:40 [com.work.main.BatchRealtime] - 201612150245
[INFO ] 13:58:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:58:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150245',true)]]--
[ERROR] 13:58:51 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 02:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:58:52 [com.work.main.BatchRealtime] - 201612150250
[INFO ] 13:58:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:58:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150250',true)]]--
[ERROR] 13:59:03 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 02:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:59:04 [com.work.main.BatchRealtime] - 201612150255
[INFO ] 13:59:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:59:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150255',true)]]--
[ERROR] 13:59:15 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:59:16 [com.work.main.BatchRealtime] - 201612150300
[INFO ] 13:59:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:59:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150300',true)]]--
[ERROR] 13:59:28 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:59:29 [com.work.main.BatchRealtime] - 201612150305
[INFO ] 13:59:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:59:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150305',true)]]--
[ERROR] 13:59:40 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:59:41 [com.work.main.BatchRealtime] - 201612150310
[INFO ] 13:59:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:59:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150310',true)]]--
[ERROR] 13:59:52 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 13:59:53 [com.work.main.BatchRealtime] - 201612150315
[INFO ] 13:59:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 13:59:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150315',true)]]--
[ERROR] 14:00:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:00:05 [com.work.main.BatchRealtime] - 201612150320
[INFO ] 14:00:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:00:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150320',true)]]--
[ERROR] 14:00:16 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:00:17 [com.work.main.BatchRealtime] - 201612150325
[INFO ] 14:00:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:00:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150325',true)]]--
[ERROR] 14:00:28 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:00:29 [com.work.main.BatchRealtime] - 201612150330
[INFO ] 14:00:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:00:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150330',true)]]--
[ERROR] 14:00:40 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:00:41 [com.work.main.BatchRealtime] - 201612150335
[INFO ] 14:00:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:00:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150335',true)]]--
[ERROR] 14:00:52 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:00:53 [com.work.main.BatchRealtime] - 201612150340
[INFO ] 14:00:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:00:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150340',true)]]--
[ERROR] 14:01:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 03:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:01:05 [com.work.main.BatchRealtime] - 201612150345
[INFO ] 14:01:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:01:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150345',true)]]--
[ERROR] 14:01:16 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:01:17 [com.work.main.BatchRealtime] - 201612150350
[INFO ] 14:01:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:01:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150350',true)]]--
[ERROR] 14:01:28 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 03:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:01:29 [com.work.main.BatchRealtime] - 201612150355
[INFO ] 14:01:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:01:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150355',true)]]--
[ERROR] 14:01:41 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:01:42 [com.work.main.BatchRealtime] - 201612150400
[INFO ] 14:01:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:01:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150400',true)]]--
[ERROR] 14:01:53 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:01:54 [com.work.main.BatchRealtime] - 201612150405
[INFO ] 14:01:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:01:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150405',true)]]--
[ERROR] 14:02:05 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:02:06 [com.work.main.BatchRealtime] - 201612150410
[INFO ] 14:02:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:02:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150410',true)]]--
[ERROR] 14:02:17 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:02:18 [com.work.main.BatchRealtime] - 201612150415
[INFO ] 14:02:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:02:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150415',true)]]--
[ERROR] 14:02:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:02:30 [com.work.main.BatchRealtime] - 201612150420
[INFO ] 14:02:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:02:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150420',true)]]--
[ERROR] 14:02:40 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:02:41 [com.work.main.BatchRealtime] - 201612150425
[INFO ] 14:02:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:02:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150425',true)]]--
[ERROR] 14:02:52 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:02:53 [com.work.main.BatchRealtime] - 201612150430
[INFO ] 14:02:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:02:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150430',true)]]--
[ERROR] 14:03:05 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:03:06 [com.work.main.BatchRealtime] - 201612150435
[INFO ] 14:03:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:03:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150435',true)]]--
[ERROR] 14:03:18 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 04:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:03:19 [com.work.main.BatchRealtime] - 201612150440
[INFO ] 14:03:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:03:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150440',true)]]--
[ERROR] 14:03:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:03:31 [com.work.main.BatchRealtime] - 201612150445
[INFO ] 14:03:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:03:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150445',true)]]--
[ERROR] 14:03:42 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:03:43 [com.work.main.BatchRealtime] - 201612150450
[INFO ] 14:03:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:03:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150450',true)]]--
[ERROR] 14:03:54 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 04:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:03:55 [com.work.main.BatchRealtime] - 201612150455
[INFO ] 14:03:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:03:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150455',true)]]--
[ERROR] 14:04:07 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:04:08 [com.work.main.BatchRealtime] - 201612150500
[INFO ] 14:04:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:04:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150500',true)]]--
[ERROR] 14:04:18 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:04:19 [com.work.main.BatchRealtime] - 201612150505
[INFO ] 14:04:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:04:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150505',true)]]--
[ERROR] 14:04:30 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:04:31 [com.work.main.BatchRealtime] - 201612150510
[INFO ] 14:04:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:04:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150510',true)]]--
[ERROR] 14:04:42 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:04:43 [com.work.main.BatchRealtime] - 201612150515
[INFO ] 14:04:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:04:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150515',true)]]--
[ERROR] 14:04:54 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:04:55 [com.work.main.BatchRealtime] - 201612150520
[INFO ] 14:04:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:04:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150520',true)]]--
[ERROR] 14:05:06 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:05:07 [com.work.main.BatchRealtime] - 201612150525
[INFO ] 14:05:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:05:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150525',true)]]--
[ERROR] 14:05:17 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:05:18 [com.work.main.BatchRealtime] - 201612150530
[INFO ] 14:05:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:05:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150530',true)]]--
[ERROR] 14:05:29 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:05:30 [com.work.main.BatchRealtime] - 201612150535
[INFO ] 14:05:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:05:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150535',true)]]--
[ERROR] 14:05:41 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:05:42 [com.work.main.BatchRealtime] - 201612150540
[INFO ] 14:05:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:05:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150540',true)]]--
[ERROR] 14:05:52 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 05:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:05:53 [com.work.main.BatchRealtime] - 201612150545
[INFO ] 14:05:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:05:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150545',true)]]--
[ERROR] 14:06:04 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:06:05 [com.work.main.BatchRealtime] - 201612150550
[INFO ] 14:06:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:06:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150550',true)]]--
[ERROR] 14:06:15 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 05:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:06:16 [com.work.main.BatchRealtime] - 201612150555
[INFO ] 14:06:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:06:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150555',true)]]--
[ERROR] 14:06:27 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:06:28 [com.work.main.BatchRealtime] - 201612150600
[INFO ] 14:06:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:06:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150600',true)]]--
[ERROR] 14:06:39 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:05:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:06:40 [com.work.main.BatchRealtime] - 201612150605
[INFO ] 14:06:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:06:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150605',true)]]--
[ERROR] 14:06:50 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:10:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:06:51 [com.work.main.BatchRealtime] - 201612150610
[INFO ] 14:06:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:06:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150610',true)]]--
[ERROR] 14:07:02 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:15:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:07:03 [com.work.main.BatchRealtime] - 201612150615
[INFO ] 14:07:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:07:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150615',true)]]--
[ERROR] 14:07:13 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 06:20:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:07:14 [com.work.main.BatchRealtime] - 201612150620
[INFO ] 14:07:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:07:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150620',true)]]--
[ERROR] 14:07:25 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 06:25:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:07:26 [com.work.main.BatchRealtime] - 201612150625
[INFO ] 14:07:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:07:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150625',true)]]--
[ERROR] 14:07:36 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 06:30:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:07:37 [com.work.main.BatchRealtime] - 201612150630
[INFO ] 14:07:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:07:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150630',true)]]--
[ERROR] 14:07:48 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 06:35:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:07:49 [com.work.main.BatchRealtime] - 201612150635
[INFO ] 14:07:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:07:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150635',true)]]--
[ERROR] 14:07:59 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:40:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:08:00 [com.work.main.BatchRealtime] - 201612150640
[INFO ] 14:08:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:08:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150640',true)]]--
[ERROR] 14:08:11 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:45:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:08:12 [com.work.main.BatchRealtime] - 201612150645
[INFO ] 14:08:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:08:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150645',true)]]--
[ERROR] 14:08:22 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(TOS, 229, 2016-12-15 06:50:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:08:23 [com.work.main.BatchRealtime] - 201612150650
[INFO ] 14:08:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:08:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150650',true)]]--
[ERROR] 14:08:34 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 06:55:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:08:35 [com.work.main.BatchRealtime] - 201612150655
[INFO ] 14:08:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:08:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150655',true)]]--
[ERROR] 14:08:46 [com.work.main.BatchRealtime] - procGather
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "pk_tb_ad_realtime_stats"
  Detail: Key (service_code, ad_type_seq, stats_dt)=(BSID, 204, 2016-12-15 07:00:00) already exists.
  Where: SQL statement "INSERT INTO grapestats.tb_ad_realtime_stats(
				service_code, ad_type_seq, stats_dt, cnt, stats_hour, stats_min, year_day)
		select 	service_code,
			ad_type_seq,
			TO_TIMESTAMP(str_end_date,str_date_format) stats_dt,
			cnt,
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'HH24') AS stats_hour, 
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'MI') AS stats_min,	
			TO_CHAR(TO_TIMESTAMP(str_end_date,str_date_format),'YYYYMMDD') AS year_day
		from (		
			SELECT 	service_code, ad_type_seq, cnt
			 FROM 
			dblink('DBLINK_GRAPE_MESSAGE_STATS_CREATE', 
			'select service_code, ad_type_seq, sum(view_cnt) as cnt
			from (
				select service_code, ad_type_seq, count(1) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code != ''SB''  group by 1,2	
				union all
				select service_code, ad_type_seq, sum(to_number(message,''999999999'')) view_cnt from message.tb_ad_view_log_'||TO_CHAR(TO_DATE(str_start_date, str_date_format), 'yymmdd')||' where view_date > TO_TIMESTAMP('''||str_start_date||''', '''||str_date_format||''') and view_date <= TO_TIMESTAMP('''||str_end_date||''', '''||str_date_format||''') and service_code = ''SB'' and to_number(message,''999999999'') < 100 and to_number(message,''999999999'') > 0 group by 1,2
				) a
			group by 1,2	'
					) 
			AS    (service_code varchar, ad_type_seq  bigint, cnt bigint)
			) A"
PL/pgSQL function "fn_create_realtime_stat" line 50 at SQL statement
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
	at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
	at com.work.main.BatchRealtime.runBatch(BatchRealtime.java:76)
	at com.work.main.BatchRealtime.main(BatchRealtime.java:45)
[INFO ] 14:08:47 [com.work.main.BatchRealtime] - 201612150700
[INFO ] 14:08:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:08:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150700',true)]]--
[INFO ] 14:09:02 [com.work.main.BatchRealtime] - 201612150705
[INFO ] 14:09:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:09:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150705',true)]]--
[INFO ] 14:09:16 [com.work.main.BatchRealtime] - 201612150710
[INFO ] 14:09:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:09:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150710',true)]]--
[INFO ] 14:09:30 [com.work.main.BatchRealtime] - 201612150715
[INFO ] 14:09:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:09:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150715',true)]]--
[INFO ] 14:09:44 [com.work.main.BatchRealtime] - 201612150720
[INFO ] 14:09:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:09:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150720',true)]]--
[INFO ] 14:09:57 [com.work.main.BatchRealtime] - 201612150725
[INFO ] 14:09:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:09:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150725',true)]]--
[INFO ] 14:10:11 [com.work.main.BatchRealtime] - 201612150730
[INFO ] 14:10:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:10:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150730',true)]]--
[INFO ] 14:10:25 [com.work.main.BatchRealtime] - 201612150735
[INFO ] 14:10:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:10:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150735',true)]]--
[INFO ] 14:10:39 [com.work.main.BatchRealtime] - 201612150740
[INFO ] 14:10:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:10:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150740',true)]]--
[INFO ] 14:10:53 [com.work.main.BatchRealtime] - 201612150745
[INFO ] 14:10:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:10:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150745',true)]]--
[INFO ] 14:11:07 [com.work.main.BatchRealtime] - 201612150750
[INFO ] 14:11:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:11:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150750',true)]]--
[INFO ] 14:11:21 [com.work.main.BatchRealtime] - 201612150755
[INFO ] 14:11:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:11:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150755',true)]]--
[INFO ] 14:11:35 [com.work.main.BatchRealtime] - 201612150800
[INFO ] 14:11:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:11:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150800',true)]]--
[INFO ] 14:11:49 [com.work.main.BatchRealtime] - 201612150805
[INFO ] 14:11:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:11:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150805',true)]]--
[INFO ] 14:12:03 [com.work.main.BatchRealtime] - 201612150810
[INFO ] 14:12:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:12:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150810',true)]]--
[INFO ] 14:12:17 [com.work.main.BatchRealtime] - 201612150815
[INFO ] 14:12:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:12:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150815',true)]]--
[INFO ] 14:12:31 [com.work.main.BatchRealtime] - 201612150820
[INFO ] 14:12:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:12:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150820',true)]]--
[INFO ] 14:12:44 [com.work.main.BatchRealtime] - 201612150825
[INFO ] 14:12:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:12:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150825',true)]]--
[INFO ] 14:12:58 [com.work.main.BatchRealtime] - 201612150830
[INFO ] 14:12:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:12:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150830',true)]]--
[INFO ] 14:13:12 [com.work.main.BatchRealtime] - 201612150835
[INFO ] 14:13:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:13:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150835',true)]]--
[INFO ] 14:13:26 [com.work.main.BatchRealtime] - 201612150840
[INFO ] 14:13:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:13:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150840',true)]]--
[INFO ] 14:13:40 [com.work.main.BatchRealtime] - 201612150845
[INFO ] 14:13:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:13:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150845',true)]]--
[INFO ] 14:13:53 [com.work.main.BatchRealtime] - 201612150850
[INFO ] 14:13:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:13:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150850',true)]]--
[INFO ] 14:14:07 [com.work.main.BatchRealtime] - 201612150855
[INFO ] 14:14:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:14:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150855',true)]]--
[INFO ] 14:14:21 [com.work.main.BatchRealtime] - 201612150900
[INFO ] 14:14:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:14:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150900',true)]]--
[INFO ] 14:14:35 [com.work.main.BatchRealtime] - 201612150905
[INFO ] 14:14:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:14:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150905',true)]]--
[INFO ] 14:14:49 [com.work.main.BatchRealtime] - 201612150910
[INFO ] 14:14:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:14:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150910',true)]]--
[INFO ] 14:15:03 [com.work.main.BatchRealtime] - 201612150915
[INFO ] 14:15:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:15:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150915',true)]]--
[INFO ] 14:15:16 [com.work.main.BatchRealtime] - 201612150920
[INFO ] 14:15:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:15:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150920',true)]]--
[INFO ] 14:15:31 [com.work.main.BatchRealtime] - 201612150925
[INFO ] 14:15:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:15:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150925',true)]]--
[INFO ] 14:15:44 [com.work.main.BatchRealtime] - 201612150930
[INFO ] 14:15:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:15:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150930',true)]]--
[INFO ] 14:15:58 [com.work.main.BatchRealtime] - 201612150935
[INFO ] 14:15:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:15:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150935',true)]]--
[INFO ] 14:16:12 [com.work.main.BatchRealtime] - 201612150940
[INFO ] 14:16:12 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:16:12 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150940',true)]]--
[INFO ] 14:16:25 [com.work.main.BatchRealtime] - 201612150945
[INFO ] 14:16:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:16:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150945',true)]]--
[INFO ] 14:16:39 [com.work.main.BatchRealtime] - 201612150950
[INFO ] 14:16:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:16:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150950',true)]]--
[INFO ] 14:16:53 [com.work.main.BatchRealtime] - 201612150955
[INFO ] 14:16:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:16:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612150955',true)]]--
[INFO ] 14:17:07 [com.work.main.BatchRealtime] - 201612151000
[INFO ] 14:17:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:17:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151000',true)]]--
[INFO ] 14:17:21 [com.work.main.BatchRealtime] - 201612151005
[INFO ] 14:17:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:17:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151005',true)]]--
[INFO ] 14:17:34 [com.work.main.BatchRealtime] - 201612151010
[INFO ] 14:17:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:17:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151010',true)]]--
[INFO ] 14:17:48 [com.work.main.BatchRealtime] - 201612151015
[INFO ] 14:17:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:17:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151015',true)]]--
[INFO ] 14:18:02 [com.work.main.BatchRealtime] - 201612151020
[INFO ] 14:18:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:18:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151020',true)]]--
[INFO ] 14:18:15 [com.work.main.BatchRealtime] - 201612151025
[INFO ] 14:18:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:18:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151025',true)]]--
[INFO ] 14:18:29 [com.work.main.BatchRealtime] - 201612151030
[INFO ] 14:18:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:18:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151030',true)]]--
[INFO ] 14:18:42 [com.work.main.BatchRealtime] - 201612151035
[INFO ] 14:18:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:18:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151035',true)]]--
[INFO ] 14:18:55 [com.work.main.BatchRealtime] - 201612151040
[INFO ] 14:18:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:18:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151040',true)]]--
[INFO ] 14:19:09 [com.work.main.BatchRealtime] - 201612151045
[INFO ] 14:19:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:19:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151045',true)]]--
[INFO ] 14:19:22 [com.work.main.BatchRealtime] - 201612151050
[INFO ] 14:19:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:19:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151050',true)]]--
[INFO ] 14:19:35 [com.work.main.BatchRealtime] - 201612151055
[INFO ] 14:19:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:19:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151055',true)]]--
[INFO ] 14:19:49 [com.work.main.BatchRealtime] - 201612151100
[INFO ] 14:19:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:19:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151100',true)]]--
[INFO ] 14:20:02 [com.work.main.BatchRealtime] - 201612151105
[INFO ] 14:20:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:20:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151105',true)]]--
[INFO ] 14:20:16 [com.work.main.BatchRealtime] - 201612151110
[INFO ] 14:20:16 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:20:16 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151110',true)]]--
[INFO ] 14:20:29 [com.work.main.BatchRealtime] - 201612151115
[INFO ] 14:20:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:20:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151115',true)]]--
[INFO ] 14:20:42 [com.work.main.BatchRealtime] - 201612151120
[INFO ] 14:20:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:20:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151120',true)]]--
[INFO ] 14:20:55 [com.work.main.BatchRealtime] - 201612151125
[INFO ] 14:20:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:20:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151125',true)]]--
[INFO ] 14:21:09 [com.work.main.BatchRealtime] - 201612151130
[INFO ] 14:21:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:21:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151130',true)]]--
[INFO ] 14:21:22 [com.work.main.BatchRealtime] - 201612151135
[INFO ] 14:21:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:21:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151135',true)]]--
[INFO ] 14:21:35 [com.work.main.BatchRealtime] - 201612151140
[INFO ] 14:21:35 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:21:35 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151140',true)]]--
[INFO ] 14:21:48 [com.work.main.BatchRealtime] - 201612151145
[INFO ] 14:21:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:21:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151145',true)]]--
[INFO ] 14:22:01 [com.work.main.BatchRealtime] - 201612151150
[INFO ] 14:22:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:22:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151150',true)]]--
[INFO ] 14:22:14 [com.work.main.BatchRealtime] - 201612151155
[INFO ] 14:22:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:22:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151155',true)]]--
[INFO ] 14:22:27 [com.work.main.BatchRealtime] - 201612151200
[INFO ] 14:22:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:22:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151200',true)]]--
[INFO ] 14:22:40 [com.work.main.BatchRealtime] - 201612151205
[INFO ] 14:22:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:22:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151205',true)]]--
[INFO ] 14:22:54 [com.work.main.BatchRealtime] - 201612151210
[INFO ] 14:22:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:22:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151210',true)]]--
[INFO ] 14:23:07 [com.work.main.BatchRealtime] - 201612151215
[INFO ] 14:23:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:23:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151215',true)]]--
[INFO ] 14:23:19 [com.work.main.BatchRealtime] - 201612151220
[INFO ] 14:23:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:23:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151220',true)]]--
[INFO ] 14:23:32 [com.work.main.BatchRealtime] - 201612151225
[INFO ] 14:23:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:23:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151225',true)]]--
[INFO ] 14:23:45 [com.work.main.BatchRealtime] - 201612151230
[INFO ] 14:23:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:23:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151230',true)]]--
[INFO ] 14:23:58 [com.work.main.BatchRealtime] - 201612151235
[INFO ] 14:23:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:23:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151235',true)]]--
[INFO ] 14:24:11 [com.work.main.BatchRealtime] - 201612151240
[INFO ] 14:24:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:24:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151240',true)]]--
[INFO ] 14:24:24 [com.work.main.BatchRealtime] - 201612151245
[INFO ] 14:24:24 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:24:24 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151245',true)]]--
[INFO ] 14:24:36 [com.work.main.BatchRealtime] - 201612151250
[INFO ] 14:24:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:24:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151250',true)]]--
[INFO ] 14:24:49 [com.work.main.BatchRealtime] - 201612151255
[INFO ] 14:24:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:24:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151255',true)]]--
[INFO ] 14:25:02 [com.work.main.BatchRealtime] - 201612151300
[INFO ] 14:25:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:25:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151300',true)]]--
[INFO ] 14:25:15 [com.work.main.BatchRealtime] - 201612151305
[INFO ] 14:25:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:25:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151305',true)]]--
[INFO ] 14:25:27 [com.work.main.BatchRealtime] - 201612151310
[INFO ] 14:25:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:25:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151310',true)]]--
[INFO ] 14:25:40 [com.work.main.BatchRealtime] - 201612151315
[INFO ] 14:25:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:25:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151315',true)]]--
[INFO ] 14:25:52 [com.work.main.BatchRealtime] - 201612151320
[INFO ] 14:25:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:25:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151320',true)]]--
[INFO ] 14:26:05 [com.work.main.BatchRealtime] - 201612151325
[INFO ] 14:26:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:26:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151325',true)]]--
[INFO ] 14:26:17 [com.work.main.BatchRealtime] - 201612151330
[INFO ] 14:26:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:26:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151330',true)]]--
[INFO ] 14:26:30 [com.work.main.BatchRealtime] - 201612151335
[INFO ] 14:26:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:26:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151335',true)]]--
[INFO ] 14:26:42 [com.work.main.BatchRealtime] - 201612151340
[INFO ] 14:26:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:26:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151340',true)]]--
[INFO ] 14:26:54 [com.work.main.BatchRealtime] - 201612151345
[INFO ] 14:26:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:26:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151345',true)]]--
[INFO ] 14:27:07 [com.work.main.BatchRealtime] - 201612151350
[INFO ] 14:27:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:27:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151350',true)]]--
[INFO ] 14:27:19 [com.work.main.BatchRealtime] - 201612151355
[INFO ] 14:27:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:27:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151355',true)]]--
[INFO ] 14:27:31 [com.work.main.BatchRealtime] - 201612151400
[INFO ] 14:27:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:27:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151400',true)]]--
[INFO ] 14:27:44 [com.work.main.BatchRealtime] - 201612151405
[INFO ] 14:27:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:27:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151405',true)]]--
[INFO ] 14:27:56 [com.work.main.BatchRealtime] - 201612151410
[INFO ] 14:27:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:27:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151410',true)]]--
[INFO ] 14:28:08 [com.work.main.BatchRealtime] - 201612151415
[INFO ] 14:28:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:28:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151415',true)]]--
[INFO ] 14:28:20 [com.work.main.BatchRealtime] - 201612151420
[INFO ] 14:28:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:28:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151420',true)]]--
[INFO ] 14:28:32 [com.work.main.BatchRealtime] - 201612151425
[INFO ] 14:28:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:28:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151425',true)]]--
[INFO ] 14:28:45 [com.work.main.BatchRealtime] - 201612151430
[INFO ] 14:28:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:28:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151430',true)]]--
[INFO ] 14:28:57 [com.work.main.BatchRealtime] - 201612151435
[INFO ] 14:28:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:28:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151435',true)]]--
[INFO ] 14:29:09 [com.work.main.BatchRealtime] - 201612151440
[INFO ] 14:29:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:29:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151440',true)]]--
[INFO ] 14:29:21 [com.work.main.BatchRealtime] - 201612151445
[INFO ] 14:29:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:29:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151445',true)]]--
[INFO ] 14:29:33 [com.work.main.BatchRealtime] - 201612151450
[INFO ] 14:29:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:29:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151450',true)]]--
[INFO ] 14:29:45 [com.work.main.BatchRealtime] - 201612151455
[INFO ] 14:29:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:29:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151455',true)]]--
[INFO ] 14:29:58 [com.work.main.BatchRealtime] - 201612151500
[INFO ] 14:29:58 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:29:58 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151500',true)]]--
[INFO ] 14:30:10 [com.work.main.BatchRealtime] - 201612151505
[INFO ] 14:30:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:30:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151505',true)]]--
[INFO ] 14:30:22 [com.work.main.BatchRealtime] - 201612151510
[INFO ] 14:30:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:30:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151510',true)]]--
[INFO ] 14:30:33 [com.work.main.BatchRealtime] - 201612151515
[INFO ] 14:30:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:30:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151515',true)]]--
[INFO ] 14:30:45 [com.work.main.BatchRealtime] - 201612151520
[INFO ] 14:30:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:30:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151520',true)]]--
[INFO ] 14:30:57 [com.work.main.BatchRealtime] - 201612151525
[INFO ] 14:30:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:30:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151525',true)]]--
[INFO ] 14:31:09 [com.work.main.BatchRealtime] - 201612151530
[INFO ] 14:31:09 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:31:09 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151530',true)]]--
[INFO ] 14:31:21 [com.work.main.BatchRealtime] - 201612151535
[INFO ] 14:31:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:31:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151535',true)]]--
[INFO ] 14:31:32 [com.work.main.BatchRealtime] - 201612151540
[INFO ] 14:31:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:31:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151540',true)]]--
[INFO ] 14:31:44 [com.work.main.BatchRealtime] - 201612151545
[INFO ] 14:31:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:31:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151545',true)]]--
[INFO ] 14:31:56 [com.work.main.BatchRealtime] - 201612151550
[INFO ] 14:31:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:31:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151550',true)]]--
[INFO ] 14:32:07 [com.work.main.BatchRealtime] - 201612151555
[INFO ] 14:32:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:32:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151555',true)]]--
[INFO ] 14:32:19 [com.work.main.BatchRealtime] - 201612151600
[INFO ] 14:32:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:32:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151600',true)]]--
[INFO ] 14:32:31 [com.work.main.BatchRealtime] - 201612151605
[INFO ] 14:32:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:32:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151605',true)]]--
[INFO ] 14:32:42 [com.work.main.BatchRealtime] - 201612151610
[INFO ] 14:32:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:32:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151610',true)]]--
[INFO ] 14:32:54 [com.work.main.BatchRealtime] - 201612151615
[INFO ] 14:32:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:32:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151615',true)]]--
[INFO ] 14:33:05 [com.work.main.BatchRealtime] - 201612151620
[INFO ] 14:33:05 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:33:05 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151620',true)]]--
[INFO ] 14:33:17 [com.work.main.BatchRealtime] - 201612151625
[INFO ] 14:33:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:33:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151625',true)]]--
[INFO ] 14:33:28 [com.work.main.BatchRealtime] - 201612151630
[INFO ] 14:33:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:33:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151630',true)]]--
[INFO ] 14:33:40 [com.work.main.BatchRealtime] - 201612151635
[INFO ] 14:33:40 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:33:40 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151635',true)]]--
[INFO ] 14:33:51 [com.work.main.BatchRealtime] - 201612151640
[INFO ] 14:33:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:33:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151640',true)]]--
[INFO ] 14:34:02 [com.work.main.BatchRealtime] - 201612151645
[INFO ] 14:34:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:34:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151645',true)]]--
[INFO ] 14:34:14 [com.work.main.BatchRealtime] - 201612151650
[INFO ] 14:34:14 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:34:14 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151650',true)]]--
[INFO ] 14:34:25 [com.work.main.BatchRealtime] - 201612151655
[INFO ] 14:34:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:34:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151655',true)]]--
[INFO ] 14:34:37 [com.work.main.BatchRealtime] - 201612151700
[INFO ] 14:34:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:34:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151700',true)]]--
[INFO ] 14:34:48 [com.work.main.BatchRealtime] - 201612151705
[INFO ] 14:34:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:34:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151705',true)]]--
[INFO ] 14:35:00 [com.work.main.BatchRealtime] - 201612151710
[INFO ] 14:35:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151710',true)]]--
[INFO ] 14:35:11 [com.work.main.BatchRealtime] - 201612151715
[INFO ] 14:35:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151715',true)]]--
[INFO ] 14:35:22 [com.work.main.BatchRealtime] - 201612151720
[INFO ] 14:35:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151720',true)]]--
[INFO ] 14:35:34 [com.work.main.BatchRealtime] - 201612151725
[INFO ] 14:35:34 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:34 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151725',true)]]--
[INFO ] 14:35:45 [com.work.main.BatchRealtime] - 201612151730
[INFO ] 14:35:45 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:45 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151730',true)]]--
[INFO ] 14:35:56 [com.work.main.BatchRealtime] - 201612151735
[INFO ] 14:35:56 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:35:56 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151735',true)]]--
[INFO ] 14:36:07 [com.work.main.BatchRealtime] - 201612151740
[INFO ] 14:36:07 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:36:07 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151740',true)]]--
[INFO ] 14:36:19 [com.work.main.BatchRealtime] - 201612151745
[INFO ] 14:36:19 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:36:19 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151745',true)]]--
[INFO ] 14:36:30 [com.work.main.BatchRealtime] - 201612151750
[INFO ] 14:36:30 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:36:30 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151750',true)]]--
[INFO ] 14:36:41 [com.work.main.BatchRealtime] - 201612151755
[INFO ] 14:36:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:36:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151755',true)]]--
[INFO ] 14:36:53 [com.work.main.BatchRealtime] - 201612151800
[INFO ] 14:36:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:36:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151800',true)]]--
[INFO ] 14:37:04 [com.work.main.BatchRealtime] - 201612151805
[INFO ] 14:37:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151805',true)]]--
[INFO ] 14:37:15 [com.work.main.BatchRealtime] - 201612151810
[INFO ] 14:37:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151810',true)]]--
[INFO ] 14:37:26 [com.work.main.BatchRealtime] - 201612151815
[INFO ] 14:37:26 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:26 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151815',true)]]--
[INFO ] 14:37:37 [com.work.main.BatchRealtime] - 201612151820
[INFO ] 14:37:37 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:37 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151820',true)]]--
[INFO ] 14:37:48 [com.work.main.BatchRealtime] - 201612151825
[INFO ] 14:37:48 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:48 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151825',true)]]--
[INFO ] 14:37:59 [com.work.main.BatchRealtime] - 201612151830
[INFO ] 14:37:59 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:37:59 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151830',true)]]--
[INFO ] 14:38:10 [com.work.main.BatchRealtime] - 201612151835
[INFO ] 14:38:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:38:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151835',true)]]--
[INFO ] 14:38:21 [com.work.main.BatchRealtime] - 201612151840
[INFO ] 14:38:21 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:38:21 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151840',true)]]--
[INFO ] 14:38:32 [com.work.main.BatchRealtime] - 201612151845
[INFO ] 14:38:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:38:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151845',true)]]--
[INFO ] 14:38:43 [com.work.main.BatchRealtime] - 201612151850
[INFO ] 14:38:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:38:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151850',true)]]--
[INFO ] 14:38:54 [com.work.main.BatchRealtime] - 201612151855
[INFO ] 14:38:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:38:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151855',true)]]--
[INFO ] 14:39:05 [com.work.main.BatchRealtime] - 201612151900
[INFO ] 14:39:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:39:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151900',true)]]--
[INFO ] 14:39:17 [com.work.main.BatchRealtime] - 201612151905
[INFO ] 14:39:17 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:39:17 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151905',true)]]--
[INFO ] 14:39:27 [com.work.main.BatchRealtime] - 201612151910
[INFO ] 14:39:27 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:39:27 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151910',true)]]--
[INFO ] 14:39:38 [com.work.main.BatchRealtime] - 201612151915
[INFO ] 14:39:38 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:39:38 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151915',true)]]--
[INFO ] 14:39:49 [com.work.main.BatchRealtime] - 201612151920
[INFO ] 14:39:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:39:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151920',true)]]--
[INFO ] 14:40:00 [com.work.main.BatchRealtime] - 201612151925
[INFO ] 14:40:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151925',true)]]--
[INFO ] 14:40:11 [com.work.main.BatchRealtime] - 201612151930
[INFO ] 14:40:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151930',true)]]--
[INFO ] 14:40:22 [com.work.main.BatchRealtime] - 201612151935
[INFO ] 14:40:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151935',true)]]--
[INFO ] 14:40:33 [com.work.main.BatchRealtime] - 201612151940
[INFO ] 14:40:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151940',true)]]--
[INFO ] 14:40:43 [com.work.main.BatchRealtime] - 201612151945
[INFO ] 14:40:44 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:44 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151945',true)]]--
[INFO ] 14:40:55 [com.work.main.BatchRealtime] - 201612151950
[INFO ] 14:40:55 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:40:55 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151950',true)]]--
[INFO ] 14:41:06 [com.work.main.BatchRealtime] - 201612151955
[INFO ] 14:41:06 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:41:06 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612151955',true)]]--
[INFO ] 14:41:17 [com.work.main.BatchRealtime] - 201612152000
[INFO ] 14:41:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:41:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152000',true)]]--
[INFO ] 14:41:28 [com.work.main.BatchRealtime] - 201612152005
[INFO ] 14:41:28 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:41:28 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152005',true)]]--
[INFO ] 14:41:39 [com.work.main.BatchRealtime] - 201612152010
[INFO ] 14:41:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:41:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152010',true)]]--
[INFO ] 14:41:50 [com.work.main.BatchRealtime] - 201612152015
[INFO ] 14:41:50 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:41:50 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152015',true)]]--
[INFO ] 14:42:00 [com.work.main.BatchRealtime] - 201612152020
[INFO ] 14:42:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152020',true)]]--
[INFO ] 14:42:11 [com.work.main.BatchRealtime] - 201612152025
[INFO ] 14:42:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152025',true)]]--
[INFO ] 14:42:22 [com.work.main.BatchRealtime] - 201612152030
[INFO ] 14:42:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152030',true)]]--
[INFO ] 14:42:33 [com.work.main.BatchRealtime] - 201612152035
[INFO ] 14:42:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152035',true)]]--
[INFO ] 14:42:43 [com.work.main.BatchRealtime] - 201612152040
[INFO ] 14:42:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152040',true)]]--
[INFO ] 14:42:54 [com.work.main.BatchRealtime] - 201612152045
[INFO ] 14:42:54 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:42:54 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152045',true)]]--
[INFO ] 14:43:04 [com.work.main.BatchRealtime] - 201612152050
[INFO ] 14:43:04 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:04 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152050',true)]]--
[INFO ] 14:43:15 [com.work.main.BatchRealtime] - 201612152055
[INFO ] 14:43:15 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:15 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152055',true)]]--
[INFO ] 14:43:25 [com.work.main.BatchRealtime] - 201612152100
[INFO ] 14:43:25 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:25 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152100',true)]]--
[INFO ] 14:43:36 [com.work.main.BatchRealtime] - 201612152105
[INFO ] 14:43:36 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:36 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152105',true)]]--
[INFO ] 14:43:47 [com.work.main.BatchRealtime] - 201612152110
[INFO ] 14:43:47 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:47 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152110',true)]]--
[INFO ] 14:43:57 [com.work.main.BatchRealtime] - 201612152115
[INFO ] 14:43:57 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:43:57 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152115',true)]]--
[INFO ] 14:44:08 [com.work.main.BatchRealtime] - 201612152120
[INFO ] 14:44:08 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:44:08 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152120',true)]]--
[INFO ] 14:44:18 [com.work.main.BatchRealtime] - 201612152125
[INFO ] 14:44:18 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:44:18 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152125',true)]]--
[INFO ] 14:44:28 [com.work.main.BatchRealtime] - 201612152130
[INFO ] 14:44:29 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:44:29 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152130',true)]]--
[INFO ] 14:44:39 [com.work.main.BatchRealtime] - 201612152135
[INFO ] 14:44:39 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:44:39 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152135',true)]]--
[INFO ] 14:44:49 [com.work.main.BatchRealtime] - 201612152140
[INFO ] 14:44:49 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:44:49 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152140',true)]]--
[INFO ] 14:45:00 [com.work.main.BatchRealtime] - 201612152145
[INFO ] 14:45:00 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:00 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152145',true)]]--
[INFO ] 14:45:10 [com.work.main.BatchRealtime] - 201612152150
[INFO ] 14:45:10 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:10 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152150',true)]]--
[INFO ] 14:45:20 [com.work.main.BatchRealtime] - 201612152155
[INFO ] 14:45:20 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:20 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152155',true)]]--
[INFO ] 14:45:31 [com.work.main.BatchRealtime] - 201612152200
[INFO ] 14:45:31 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:31 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152200',true)]]--
[INFO ] 14:45:41 [com.work.main.BatchRealtime] - 201612152205
[INFO ] 14:45:41 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:41 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152205',true)]]--
[INFO ] 14:45:51 [com.work.main.BatchRealtime] - 201612152210
[INFO ] 14:45:51 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:45:51 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152210',true)]]--
[INFO ] 14:46:01 [com.work.main.BatchRealtime] - 201612152215
[INFO ] 14:46:01 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:01 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152215',true)]]--
[INFO ] 14:46:11 [com.work.main.BatchRealtime] - 201612152220
[INFO ] 14:46:11 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:11 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152220',true)]]--
[INFO ] 14:46:22 [com.work.main.BatchRealtime] - 201612152225
[INFO ] 14:46:22 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:22 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152225',true)]]--
[INFO ] 14:46:32 [com.work.main.BatchRealtime] - 201612152230
[INFO ] 14:46:32 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:32 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152230',true)]]--
[INFO ] 14:46:42 [com.work.main.BatchRealtime] - 201612152235
[INFO ] 14:46:42 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:42 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152235',true)]]--
[INFO ] 14:46:52 [com.work.main.BatchRealtime] - 201612152240
[INFO ] 14:46:52 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:46:52 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152240',true)]]--
[INFO ] 14:47:02 [com.work.main.BatchRealtime] - 201612152245
[INFO ] 14:47:02 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:02 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152245',true)]]--
[INFO ] 14:47:13 [com.work.main.BatchRealtime] - 201612152250
[INFO ] 14:47:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152250',true)]]--
[INFO ] 14:47:23 [com.work.main.BatchRealtime] - 201612152255
[INFO ] 14:47:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152255',true)]]--
[INFO ] 14:47:33 [com.work.main.BatchRealtime] - 201612152300
[INFO ] 14:47:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152300',true)]]--
[INFO ] 14:47:43 [com.work.main.BatchRealtime] - 201612152305
[INFO ] 14:47:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152305',true)]]--
[INFO ] 14:47:53 [com.work.main.BatchRealtime] - 201612152310
[INFO ] 14:47:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:47:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152310',true)]]--
[INFO ] 14:48:03 [com.work.main.BatchRealtime] - 201612152315
[INFO ] 14:48:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152315',true)]]--
[INFO ] 14:48:13 [com.work.main.BatchRealtime] - 201612152320
[INFO ] 14:48:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152320',true)]]--
[INFO ] 14:48:23 [com.work.main.BatchRealtime] - 201612152325
[INFO ] 14:48:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152325',true)]]--
[INFO ] 14:48:33 [com.work.main.BatchRealtime] - 201612152330
[INFO ] 14:48:33 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:33 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152330',true)]]--
[INFO ] 14:48:43 [com.work.main.BatchRealtime] - 201612152335
[INFO ] 14:48:43 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:43 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152335',true)]]--
[INFO ] 14:48:53 [com.work.main.BatchRealtime] - 201612152340
[INFO ] 14:48:53 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:48:53 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152340',true)]]--
[INFO ] 14:49:03 [com.work.main.BatchRealtime] - 201612152345
[INFO ] 14:49:03 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:49:03 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152345',true)]]--
[INFO ] 14:49:13 [com.work.main.BatchRealtime] - 201612152350
[INFO ] 14:49:13 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:49:13 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152350',true)]]--
[INFO ] 14:49:23 [com.work.main.BatchRealtime] - 201612152355
[INFO ] 14:49:23 [com.work.util.DBUtil] - openDB SUCCEED...
[INFO ] 14:49:23 [com.work.main.BatchRealtime] - --[[ select grapestats.fn_create_realtime_stat('201612152355',true)]]--
